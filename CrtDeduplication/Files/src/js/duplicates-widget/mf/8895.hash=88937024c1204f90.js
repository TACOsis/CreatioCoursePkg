(self.webpackChunkapp_studio_enterprise_duplicates_widget=self.webpackChunkapp_studio_enterprise_duplicates_widget||[]).push([[8895],{8895:(p,D,d)=>{d.r(D),d.d(D,{EntityStageDataTableSliderConverter:()=>c,EntityStageProgressBarColorMapperService:()=>i,EntityStageSchemaFilterService:()=>a});var u=d(73308),g=d(5960),F=d(38495),w=d(96590),E=d(59131);class i{constructor(){this._newPaletteColorsMap=[{oldColor:"#000000",newColor:"#181818"},{oldColor:"#999999",newColor:"#757575"},{oldColor:"#DFDFDF",newColor:"#D6D6D6"},{oldColor:"#EF7E63",newColor:"#E00022"},{oldColor:"#C73920",newColor:"#B41406"},{oldColor:"#D2310D",newColor:"#B41406"},{oldColor:"#E06F56",newColor:"#E00022"},{oldColor:"#EBA793",newColor:"#E67860"},{oldColor:"#E99886",newColor:"#E67860"},{oldColor:"#7F2910",newColor:"#840D01"},{oldColor:"#B61303",newColor:"#840D01"},{oldColor:"#85C280",newColor:"#54AA4E"},{oldColor:"#D1E9BD",newColor:"#54AA4E"},{oldColor:"#54AA4D",newColor:"#0C8701"},{oldColor:"#2C6018",newColor:"#073F05"},{oldColor:"#035500",newColor:"#073F05"},{oldColor:"#64B8DF",newColor:"#4D84E2"},{oldColor:"#D4EBF6",newColor:"#80A7EB"},{oldColor:"#286581",newColor:"#0026BC"},{oldColor:"#6483C3",newColor:"#9641A9"},{oldColor:"#B87CCF",newColor:"#9641A9"},{oldColor:"#46639F",newColor:"#7848EE"},{oldColor:"#D1DCF0",newColor:"#B97CD1"},{oldColor:"#D6BEE3",newColor:"#B97CD1"},{oldColor:"#2B467E",newColor:"#4F43C2"},{oldColor:"#5BC8C4",newColor:"#02C2A8"},{oldColor:"#95DBD1",newColor:"#02C2A8"},{oldColor:"#4CA6A3",newColor:"#08857E"},{oldColor:"#00BFA5",newColor:"#08857E"},{oldColor:"#BFE8E7",newColor:"#95DBD8"},{oldColor:"#D3F1ED",newColor:"#95DBD8"},{oldColor:"#327B78",newColor:"#0E5F53"},{oldColor:"#009688",newColor:"#0E5F53"},{oldColor:"#F8D162",newColor:"#FFAC07"},{oldColor:"#D3AE46",newColor:"#FF8800"},{oldColor:"#FBE8B2",newColor:"#F9D68D"},{oldColor:"#A8882E",newColor:"#F86700"},{oldColor:"#FF6534",newColor:"#F86700"},{oldColor:"#FBAD43",newColor:"#FF602E"},{oldColor:"#FF795A",newColor:"#FF602E"},{oldColor:"#CC8930",newColor:"#FF4013"},{oldColor:"#FDD6A1",newColor:"#FFA089"},{oldColor:"#A16A1F",newColor:"#D31E0D"},{oldColor:"#FF1C06",newColor:"#D31E0D"},{oldColor:"#8E8EB7",newColor:"#566D83"},{oldColor:"#5E5684",newColor:"#0D2E4E"},{oldColor:"#E1DEED",newColor:"#8697A7"},{oldColor:"#3C365B",newColor:"#031225"},{oldColor:"#0B8500",newColor:"#066800"},{oldColor:"#309726",newColor:"#066800"},{oldColor:"#589928",newColor:"#066800"},{oldColor:"#8ECB60",newColor:"#0C8701"},{oldColor:"#8A8A8A",newColor:"#757575"},{oldColor:"#2669DC",newColor:"#004FD6"},{oldColor:"#3A8BB1",newColor:"#004FD6"},{oldColor:"#0058EF",newColor:"#004FD6"},{oldColor:"#314D69",newColor:"#0D2E4E"}]}_combineColors(l,r){const o=l.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*(\d*\.?\d+)?\)/),e=r.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*(\d*\.?\d+)?\)/),t=Math.round((parseInt(o[1])+parseInt(e[1]))/2),s=Math.round((parseInt(o[2])+parseInt(e[2]))/2),n=Math.round((parseInt(o[3])+parseInt(e[3]))/2),C=((parseFloat(o[4]||"1")+parseFloat(e[4]||"1"))/2).toFixed(2);return`rgba(${t},${s},${n},${C})`}getStageColor(l){const r=this._newPaletteColorsMap.find(o=>o.oldColor===l.toUpperCase())?.newColor;return r||l}getStageLightHover(l){if(l)return this._combineColors((0,w.hexToRGBA)(l,1),(0,w.hexToRGBA)("#FFFFFF",.6))}getStageDarkHover(l){if(l)return(0,w.hexToDarkerRGB)(l,.25)}static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275prov=E.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"})}}class a{getEntityStageSchemaByFilteredColumnValue(l,r){return l.find(o=>{if(!o.isActive||!o.isActiveVersion)return null;if(!o.filters)return o;const e=JSON.parse(o.filters),t=Object.values(e.items)[0];if(t.comparisonType===F.ComparisonType.Equal)return(t.rightExpressions||[]).map(C=>C?.parameter?.value?.value).filter(C=>!!C).includes(r)?o:null;if(t.comparisonType===F.ComparisonType.Is_null&&!r)return o})}static{this.\u0275fac=function(r){return new(r||a)}}static{this.\u0275prov=E.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac,providedIn:"root"})}}let c=class{convert(l,r,o){var e=this;return(0,u.A)(function*(){if(!o)return null;const t=yield e._getTargetDCMSchemaData(o.schemas,o.filterColumnAttributePath,r),s=o.schemasData.find(n=>n.name===t?.name);return e._getSliderCellModel(l,s)})()}_getTargetDCMSchemaData(l,r,o){return(0,u.A)(function*(){const e=new a,t=yield o[r];return e.getEntityStageSchemaByFilteredColumnValue(l,t?.value)})()}_getSliderCellModel(l,r){if(!r||!l)return{color:"",value:0};const o=r.stages.filter(n=>!n.parentStageUId);let e=o.find(n=>n.stageRecordId===l.value),t=o.indexOf(e);if(t===-1){const n=r.stages.find(C=>C.stageRecordId===l.value);n&&(t=o.findIndex(C=>C.uId===n.parentStageUId),e=n)}const s=(t+1)*100/o.length;return{color:e?.color,value:s}}};c=(0,g.__decorate)([(0,F.CrtConverter)({type:"crt.ToEntityStageDataTableSliderConverterAsync"})],c)}}]);
