(self.webpackChunkapp_studio_enterprise_analytics_dashboard=self.webpackChunkapp_studio_enterprise_analytics_dashboard||[]).push([[5308],{25308:(Wi,us,R)=>{R.r(us),R.d(us,{AbstractCalculatedAttributeSourcesChangesProvider:()=>ba,AbstractCalculatedAttributeTriggerProvider:()=>zs,AbstractExpressionInterpreter:()=>et,AbstractModelLifecycleHookNotificationService:()=>fa,AbstractValidatorTypeResolver:()=>Je,AddCommunicationOptionsRequest:()=>La,AddFolderDataRequest:()=>Bt,AddRecordsInStaticFoldersRequest:()=>ka,AddTagsInRecordRequest:()=>Ba,AddTagsInRecordsRequest:()=>Ua,AggregationType:()=>na,AngularBaseValidator:()=>N,AttributesTopologicalSorting:()=>Ae,BASE_VIEW_MODEL_ATTRIBUTE_CREATOR_FACTORY:()=>ia,BASE_VIEW_MODEL_ATTRIBUTE_CREATOR_FACTORY_PROVIDER:()=>Ys,BUSINESS_RULES_ACTIVATED_SYSTEM_ATTRIBUTE_NAME:()=>ut,BaseAddFolderDataRequest:()=>ur,BaseCrtControl:()=>Se,BaseDataSchemaToDataSourceAttributeConverter:()=>vt,BaseDataSource:()=>Rt,BaseFolderTreeRequest:()=>k,BaseImageListItemClickRequest:()=>Mr,BaseModelLifecycleRequest:()=>H,BaseRecordsInStaticFoldersRequest:()=>Oa,BaseRelatedInMainRecordsRequest:()=>Fa,BaseSearchFilterRequest:()=>$a,BaseTagsInRecordsRequest:()=>ja,BaseViewModel:()=>U,BaseViewModelAttributeGenerator:()=>Ce,BaseViewModelCollection:()=>q,BaseViewModelGenerator:()=>W,BaseViewModelProcessValidationResultService:()=>de,CALCULATED_ATTRIBUTE_SOURCES_CHANGES_PROVIDER_FACTORY:()=>Aa,CALCULATED_ATTRIBUTE_SOURCES_CHANGES_PROVIDER_FACTORY_PROVIDER:()=>Hs,CALCULATED_ATTRIBUTE_TRIGGER_PROVIDER_FACTORY:()=>Ca,CALCULATED_ATTRIBUTE_TRIGGER_PROVIDER_FACTORY_PROVIDER:()=>Js,CRT_DESIGN_TIME_METADATA_POSTPROCESSOR:()=>Xs,CRT_DESIGN_TIME_METADATA_PREPROCESSOR:()=>m.CRT_DESIGN_TIME_METADATA_PREPROCESSOR,CRT_METADATA_LOOKUP_PREPROCESSOR:()=>Hi,CRT_METADATA_NAVIGATION_PREPROCESSOR:()=>$i,CRT_METADATA_PREPROCESSOR:()=>m.CRT_METADATA_PREPROCESSOR,CalculatedAttributeAttrTriggerProvider:()=>oe,CalculatedAttributeRequestTriggerProvider:()=>le,CalculatedAttributeSourcesAttributeChangesProvider:()=>J,CalculatedAttributeSourcesRequestChangesProvider:()=>ne,CalculatedAttributesModule:()=>ke,CalculatedViewModelAttributeCreator:()=>ue,CancelCollectionPrimaryDataChangesRequest:()=>Ha,CancelCollectionPrimaryDataHandler:()=>Pt,CancelPrimaryDataChangesHandler:()=>Et,CancelPrimaryDataChangesRequest:()=>za,CancelRecordChangesRequest:()=>Wa,CancelRecordsChangesRequest:()=>Ga,ChangeViewModelAttributeValueHandler:()=>Ma,ChangeViewModelAttributeValueRequest:()=>Sa,ClearContextedHandlersCacheHandler:()=>wa,ClosePageRequest:()=>Ja,ComboboxLoadDataRequest:()=>Za,ContextHandlerChainModelLifecycleHookNotificationService:()=>qe,ContinueInOtherPageRequest:()=>Ka,ConvertToStaticFolderRequest:()=>Sr,CopilotActionDataSource:()=>Ls,CopilotActionRequest:()=>Ya,CopilotIntentDataSource:()=>Fs,CopilotIntentDataSourceModelConvertor:()=>Ie,CopilotIntentParameterDataSource:()=>Os,CopilotIntentParameterDataSourceModelConvertor:()=>we,CopyDataHandler:()=>Lt,CopyDataRequest:()=>Na,CopyFolderDataRequest:()=>cr,CreateCollectionItemsRequest:()=>Qa,CreateRecordRequest:()=>Xa,CrtBaseControlProperty:()=>ct,CrtCanDiscardUnsavedData:()=>Di,CrtControlProperty:()=>hs,CrtControlPropertyFactory:()=>Kt,CrtControlStateAdapter:()=>G,CrtProperty:()=>Zt,CrtRequiredProperty:()=>Yt,DATA_SCHEMA_TO_DATA_SOURCE_ATTRIBUTE_CONVERTER_FACTORY:()=>ha,DATA_SCHEMA_TO_DATA_SOURCE_ATTRIBUTE_CONVERTER_FACTORY_PROVIDER:()=>xs,DATA_SOURCE_PREFIX:()=>_s,DATA_VALUE_TYPE_PROPERTY_NAME:()=>ps,DISABLE_SHOW_SUCCESS_MESSAGE_AFTER_LOAD_DATA_REQUEST:()=>cs,DYNAMIC_DATA_SOURCE_PREFIX:()=>ys,DataSchema:()=>B,DataSchemaAttribute:()=>Re,DataSchemaRepositoryService:()=>j,DataSchemaToDataSourceAggregationAttributeConverter:()=>ee,DataSchemaToDataSourceDefaultAttributeConverter:()=>te,DataSchemaToDataSourceFunctionAttributeConverter:()=>ae,DataSourceError:()=>ca,DataSourceFactoryService:()=>O,DataSourceInfo:()=>L,DataSourceInitError:()=>Ct,DataSourceTypeResolver:()=>se,DefaultViewModelAttributeCreator:()=>ce,DeleteClientUnitSchemaRequest:()=>er,DeleteDataHandler:()=>qt,DeleteDataRequest:()=>Ta,DeleteFileRequest:()=>tr,DeleteFolderDataRequest:()=>dr,DeleteOldTagRecordRequest:()=>ar,DeleteRecordRequest:()=>st,DeleteRecordsRequest:()=>rr,DeleteTagInRecordRequest:()=>sr,DesignTimeValidatorTypeResolver:()=>at,DetailChangedRequest:()=>ir,ENTITY_DATA_SOURCE_TYPE_REGISTRY:()=>ri,ENTITY_SCHEMA_COLUMN_APPENDER_FACTORY:()=>ma,ENTITY_SCHEMA_COLUMN_APPENDER_FACTORY_PROVIDER:()=>qs,EXPRESSION_INTERPRETER_FACTORY:()=>js,EmailLinkClickRequest:()=>nr,EmptyWhiteSpaceLczValidator:()=>Qt,EmptyWhiteSpaceValidator:()=>Ze,EntityDataSchemaBuilder:()=>ua,EntityDataSource:()=>Te,EntitySchemaQueryBuilder:()=>X,ExportChartDataGridToExcelRequest:()=>or,ExportDataGridToExcelRequest:()=>lr,FileGroupEnum:()=>Xt,FolderTreeActiveFolderChangedRequest:()=>hr,FolderTreeExpandedItemsRequest:()=>yr,FolderTreeMoveRequest:()=>pr,FolderTreeRenameRequest:()=>gr,FolderTreeUpdateFiltersRequest:()=>_r,FolderTreeVisibleRequest:()=>mr,FormControlBasedCrtControl:()=>si,GetDataSourceLoadFiltersHandler:()=>Ot,GetDataSourceLoadFiltersRequest:()=>xa,HAS_UNSAVED_DATA_AND_DETAILS_ATTRIBUTE_NAME:()=>ai,HAS_UNSAVED_DATA_SYSTEM_ATTRIBUTE_NAME:()=>ze,HandleAfterModelDeleteRequest:()=>Rr,HandleAfterModelInsertRequest:()=>Dr,HandleAfterModelLoadRequest:()=>vr,HandleAfterModelUpdateRequest:()=>Pr,HandleBeforeModelDeleteRequest:()=>Er,HandleBeforeModelInsertRequest:()=>Vr,HandleBeforeModelLoadRequest:()=>Tr,HandleBeforeModelUpdateRequest:()=>Nr,HandleKeyboardHotkeysRequest:()=>br,HandleModelEventRequest:()=>Ar,HandleViewModelDestroyRequest:()=>jt,HandleViewModelInitRequest:()=>Ut,HandleViewModelPauseRequest:()=>$t,HandleViewModelResumeRequest:()=>Ht,HandlerChainModelLifecycleHookNotificationService:()=>ie,INJECTION_CONTEXT:()=>ds,INTENT_MODES:()=>Ms,INTENT_MODES_REFERENCE_MAP:()=>bs,INTENT_MODE_REFERENCE_NAME:()=>Ss,INTENT_STATUSES_REFERENCE_MAP:()=>Cs,INTENT_STATUS_REFERENCE_NAME:()=>As,INTENT_TYPES_REFERENCE:()=>ra,IS_CHANGED_SYSTEM_ATTRIBUTE_NAME:()=>ye,ImportDataRequest:()=>Cr,InitReferenceDataSchemaAttributeDataSourceError:()=>Ns,LoadDataHandler:()=>It,LoadDataRequest:()=>kt,LoadDefaultValuesHandler:()=>wt,LoadDefaultValuesRequest:()=>Ea,LoadLookupListHandler:()=>Nt,LoadLookupListRequest:()=>Pa,LookupDataLoadService:()=>Ne,LookupViewModelAttributeCreator:()=>Be,MODEL_LIVE_EDITING_NOTIFICATION_APP_INITIALIZER_PROVIDER:()=>ki,MaxLengthValidator:()=>pt,MaxValidator:()=>dt,MetadataModifierService:()=>ot,MetadataPostprocessorService:()=>it,MetadataPreprocessorsRunner:()=>ei,MetadataPreprocessorsRunnerFactory:()=>nt,MinLengthValidator:()=>ft,MinValidator:()=>gt,MockViewModel:()=>Bi,Model:()=>Le,ModelDataService:()=>K,ModelDataServiceMock:()=>me,ModelEventNotificationService:()=>re,ModelEventType:()=>V,ModelGenerator:()=>Fe,ModelLiveEditingNotificationService:()=>$e,ModelModule:()=>Wt,ModelParametersBuilder:()=>Oe,ModelRelationType:()=>C,ModelSaveOrderSorterService:()=>he,ModelUtils:()=>v,MoveNewRecordTo:()=>oa,MoveSelectedItemDefaultValue:()=>ji,MoveSelectedItemDefaultValueType:()=>wr,MoveSelectedItemsRequest:()=>Ir,NotificationRequest:()=>xr,ObjectNameValidator:()=>di,OpenChangeLogRequest:()=>ns,OpenDuplicatesPageRequest:()=>qr,OpenOldTagMiniPageRequest:()=>Lr,OpenPageRequest:()=>Fr,OpenPositionedPageRequest:()=>Or,PRIMARY_MODEL_MODE_SYSTEM_ATTRIBUTE_NAME:()=>lt,PageParametersDataSource:()=>ks,PhoneLinkClickRequest:()=>kr,PrintablesRequest:()=>Br,REQUEST_HANDLER_REGISTER_SERVICE_APP_INITIALIZER_PROVIDER:()=>Li,RegExpValidator:()=>Qe,RemoveCollectionItemsRequest:()=>jr,RemoveRecordsInStaticFoldersRequest:()=>Ur,RemoveTagsInRecordsRequest:()=>$r,RequestHandlersRegisterService:()=>Ue,RequiredValidator:()=>_t,RunBusinessProcessRequest:()=>Hr,RunProcessType:()=>Ye,SCHEMA_CHANGED_INVALIDATE_CACHE_CHANNEL_NAME:()=>fs,SCOPE_NAME:()=>Ge,SaveCollectionPrimaryDataHandler:()=>Vt,SaveCollectionPrimaryDataRequest:()=>zr,SaveDataHandler:()=>xt,SaveDataRequest:()=>Va,SavePrimaryDataHandler:()=>Tt,SavePrimaryDataRequest:()=>Wr,SaveRecordRequest:()=>zt,SaveRecordWithErrorRequest:()=>Gr,SaveRecordsRequest:()=>Jr,SchemaNameAllowedSymbolsValidator:()=>St,SchemaNamePrefixValidator:()=>yt,SchemaParametersStore:()=>xe,SchemaValidatorFactory:()=>Zs,SchemaValidatorRegistryService:()=>je,SchemaValidatorTypeResolver:()=>tt,Scopes:()=>la,SearchFilterColumnsGroupsRequest:()=>Zr,SearchFilterRequest:()=>Kr,SelectFileRequest:()=>Yr,SelectLookupPageRequest:()=>Qr,SetRecordRightsRequest:()=>Xr,SetTopRecordRequest:()=>es,ShowRelationshipsRequest:()=>ts,SortDataHandler:()=>Ft,SortDataRequest:()=>Ia,ToggleFolderFavoriteRequest:()=>fr,UNSAVED_DETAILS_DATA_ATTRIBUTE_NAME:()=>ti,UniqueColumnValueValidator:()=>Mt,UpdateRecordRequest:()=>as,UploadFileRequest:()=>rs,UploadImageRequest:()=>ss,VIEW_EVENT_ZONE_NAME:()=>Jt,VIEW_MODEL_STATE_ATTRIBUTE_NAME:()=>We,ValidatorHelper:()=>I,ValidatorTypeResolver:()=>Z,ViewModelAsyncTaskType:()=>F,ViewModelDataDelayer:()=>ms,ViewModelDiffPatchService:()=>rt,ViewModelEventType:()=>P,ViewModelFactory:()=>pe,ViewModelGenerator:()=>ge,ViewModelRepositoryService:()=>z,ViewModelRepositoryServiceMock:()=>be,ViewModelStates:()=>bt,ViewModelUtils:()=>Ke,WebServiceDataSource:()=>Bs,WorkplaceNavigationPanelCloseRequest:()=>is,addDefaultActionForRootModels:()=>ui,castPageConfigsToLookups:()=>ii,get:()=>gs,getControlErrorMessages:()=>oi,getEntitySchemaAttribute:()=>li,getGeneralDataValueType:()=>Mi,getIntentTypeLookupValues:()=>Rs,getNormalizedCalculatedAttributeConfig:()=>Gs,getRelationType:()=>sa,getRootModels:()=>Ds,getRootViewModel:()=>Me,internalViewModelInjector:()=>Y,isCalculatedAttributeAttrTrigger:()=>Ra,isCalculatedAttributeConfig:()=>m.isCalculatedAttributeConfig,isCalculatedAttributeRequestTrigger:()=>Da,isDataReloading:()=>ni,isModelAttributeConfig:()=>m.isModelAttributeConfig,isModelDependsOnParentModel:()=>mt,isParameterizedRunProcessType:()=>ci,isRootModel:()=>Q,modelTestInjector:()=>Fi,nameValidatorRegexp:()=>Es,normalizeDataValueType:()=>Dt,resetControlState:()=>ht,updateTreeValidity:()=>ea,waitTillDeterminedStatus:()=>ta});var y=R(73308),p=R(59131),x=R(56711),n=R(38495),_e=R(79772),E=R(20442),m=R(21018),b=R(28399),c=R(62278),o=R(36486),A=R(96590);const ti="Unsaved7xDetailsData",ai="HasUnsavedDataAnd7xDetails",ri=["crt.CopilotActionDataSource","crt.CopilotIntentDataSource","crt.CopilotIntentParameterDataSource",m.EntityDataSourceTypeName],Y=Symbol("InternalViewModelInjector"),ze="HasUnsavedData",ye="IsChanged",lt="PrimaryModelMode",ut="BusinessRulesActivated",We="State",cs="DisableShowSuccessMessageAfterLoadDataRequest",Ge=new p.InjectionToken("SCOPE_NAME"),Jt=new p.InjectionToken("VIEW_EVENT_ZONE_NAME"),ds=new p.InjectionToken("INJECTION_CONTEXT");var P;(function(u){u.ChangeAttributeValue="change-attribute-value",u.ModelDataLoaded="model-data-loaded-event",u.BeforeModelLoad="before-model-load",u.LoadDefaultValues="load-default-values",u.StartLoadModelAttributes="start-load-model-attributes",u.FinishLoadModelAttributes="finish-load-model-attributes",u.ViewEvent="view-event"})(P||(P={}));class q extends Array{constructor(...e){return super(),this._itemsChanged=new c.Subject,this._itemAttributeChanged=new c.Subject,this._destroyed$=new c.Subject,this._changed=new c.Subject,this._trackChanges=!0,this._createdItems=[],this._deletedItems=[],this._isDestroyed=!1,typeof e[0]=="number"?new Array(e[0]):([this._viewModelGenerator,this._viewModelConfig={},this._model,this._host,this._hostAttributeName]=e,this._measurePerformanceService=this._host?.[Y]?.get(m.MeasurePerformanceService,null,{optional:!0}),this._featureValues=this._host?.[Y]?.get(m.FEATURE_VALUES,{},{optional:!0})??{},this._ngZone=this._host?.[Y]?.get(p.NgZone,null,{optional:!0}),Object.setPrototypeOf(this,Object.create(q.prototype)),this._subscribeItemsModelModesChanges(),this._subscribeItemsAttributesChanges(),new Proxy(this,{set:(t,a,r,s)=>{const i=t[a];return t[a]=r,this._trackChanges&&(a==="length"&&r!==i?this._onItemsChanged():isNaN(parseInt(a))||this._onItemsChanged()),!0}}))}get changed(){return this._changed.asObservable().pipe((0,A.runInZone)(this._ngZone),(0,o.takeUntil)(this._destroyed$))}get itemAttributeChanged(){return this._itemAttributeChanged.asObservable().pipe((0,o.takeUntil)(this._destroyed$))}get isChanged(){return this.getChangedItems().length>0}get formApiModel(){return this._formApiModel||this._updateFormApiModelValues({emitEvent:!1}),this._formApiModel}_isItemPrimaryAttributeEqual(e,t){return(0,y.A)(function*(){if(!e)return!1;const a=yield e[e.primaryAttributeName];return t.includes(a)})()}_insertItem(e,t){typeof t!="number"&&(t=this.length),t=Math.max(t,0),t=Math.min(t,this.length),this.splice(t,0,e)}_generateItem(e){const t=()=>{const a=this._model?.createCollectionItemModel(m.ModelMode.Create),r=this._host?.[Y],s=this._viewModelGenerator.generate({viewModelConfig:this._viewModelConfig,modelConfig:a?{primaryDataSourceName:a.name}:void 0,models:a?[a]:void 0,parentViewModel:this._host,businessRulesActive:e.businessRulesActive??!1},r?p.Injector.create({providers:[{provide:Ge,useValue:null}],parent:r}):null).pipe((0,o.tap)(i=>{a?.name&&(i.dataSchemas[a.name]=this._host.dataSchemas[a.name])}),(0,o.switchMap)(i=>a?.name?i.create(a.name,e.initialModelValues).pipe((0,o.map)(()=>i)):(0,c.of)(i)),(0,o.tap)(i=>{Object.entries(e.initialAttributeValues??{}).forEach(([l,d])=>i[l]=d),i._markAsPristine(e.initialAttributeValues??{}),this._model?.childrenChange()}));return(0,c.lastValueFrom)(s)};return this._measurePerformanceService?this._measurePerformanceService.measureCallback("ViewModelCollection.generateItem",()=>t()):t()}_mergeItems(e,t){const a=()=>{const r=(e[0]||t[0])?.primaryAttributeName;for(const s of t){const i=e.findIndex(l=>{const d=l.attributes?.[r],h=s.attributes?.[r];return d&&d===h});i===-1?e.push(s):e.splice(i,1,s)}return e};return this._measurePerformanceService?this._measurePerformanceService.measure("ViewModelCollection.mergeItems",()=>a()):a()}_triggerChangesAfter(e){this._trackChanges=!1;const t=e.call(this);return this._trackChanges=!0,this._isDestroyed||this._onItemsChanged(),t}_onItemsChanged(){const e=this.map(t=>({item:t,itemModelMode:t?.getPrimaryModelMode?.()}));this._updateCollectionState(e,!0)}_subscribeItemsModelModesChanges(){this._itemsChanged.pipe((0,o.switchMap)(()=>this._getItemsModelModesChanges()),(0,o.tap)(e=>this._updateCollectionState([e],!1)),(0,o.takeUntil)(this._destroyed$)).subscribe()}_subscribeItemsAttributesChanges(){this._itemsChanged.pipe((0,o.switchMap)(()=>this._getItemsAttributesChanges()),(0,o.filter)(e=>!e.payload.silent),(0,o.tap)(()=>this._itemAttributeChanged.next()),(0,o.takeUntil)(this._destroyed$)).subscribe()}_getItemsAttributesChanges(){const e=this.map(t=>t?.events$?.pipe((0,o.filter)(a=>a.type===P.ChangeAttributeValue))).filter(Boolean);return e.length?(0,c.merge)(...e):c.EMPTY}_getItemsModelModesChanges(){const e=[...this,...this._deletedItems].map(t=>t?._getPrimaryModelModeChanges?.()?.pipe((0,o.map)(a=>({item:t,itemModelMode:a})))).filter(Boolean);return e.length?(0,c.merge)(...e):c.EMPTY}_updateCollectionState(e,t){this._trackChanges=!1;const a=e.map(r=>this._onItemModelModeChanged(r)).some(r=>!!r);this._trackChanges=!0,!(!t&&!a)&&(this._updateFormApiModelValues(),this._updateFormApiModelPristineState(),this._changed.next(),this._itemsChanged.next())}_onItemModelModeChanged(e){const{item:t,itemModelMode:a}=e;if(!t||a==null)return!1;switch(a){case m.ModelMode.Create:return this._onCreateItem(t);case m.ModelMode.Update:return this._onUpdateItem(t);case m.ModelMode.Delete:return this._onDeleteItem(t);default:return!1}}_onCreateItem(e){const t=this._deletedItems.indexOf(e);return t!==-1?(this._deletedItems.splice(t,1),!0):(this._createdItems.indexOf(e)===-1&&this._createdItems.push(e),!1)}_onUpdateItem(e){const t=this._createdItems.indexOf(e);if(t!==-1)return this._createdItems.splice(t,1),!1;const a=this._deletedItems.indexOf(e);if(a!==-1){const r=this._deletedItems.splice(a,1);super.push(...r)}return!0}_onDeleteItem(e){const t=this._createdItems.indexOf(e),a=this._deletedItems.indexOf(e);return t!==-1?this._createdItems.splice(t,1):a===-1&&this._deletedItems.push(e),super.splice(this.indexOf(e),1),!0}_updateFormApiModelValues(e){if(this._featureValues.DisableBaseViewModelCollectionOptimization){this._formApiModel??=new x.FormArray([]),this._formApiModel.clear({emitEvent:!1}),this.filter(a=>a?.formApiModel).forEach(a=>{this._formApiModel.push(a.formApiModel,{emitEvent:!1})}),e?.emitEvent!==!1&&this._formApiModel.updateValueAndValidity();return}if(!this._formApiModel||!this._formApiModel.length){const a=new x.FormArray(this.filter(r=>r?.formApiModel)?.map(r=>r.formApiModel));this._formApiModel||(this._formApiModel=a),this._formApiModel.length||this._host?.formApiModel?.setControl(this._hostAttributeName,a)}else this._formApiModel.clear({emitEvent:!1}),this.filter(a=>a?.formApiModel).forEach(a=>{this._formApiModel.push(a.formApiModel,{emitEvent:!1})}),e?.emitEvent!==!1&&this._formApiModel.updateValueAndValidity()}_updateFormApiModelPristineState(){const e=this.formApiModel.pristine,t=this.some(a=>a?.formApiModel?.dirty);if(t&&e){this.formApiModel.markAsDirty();return}!t&&!e&&this.formApiModel.markAsPristine()}_reload(e){const t=()=>{for(const s of[...this._deletedItems,...this])this.removeChildModel(s,{triggerNotification:!1});this._model?.childrenChange();const a=[],r=s=>a.push(s.destroy());return this._createdItems.forEach(r),this._createdItems.splice(0,this._createdItems.length),this._deletedItems.forEach(r),this._deletedItems.splice(0,this._deletedItems.length),this.forEach(r),this.splice(0,this.length,...e),(0,c.forkJoin)(a).pipe((0,o.defaultIfEmpty)(void 0),(0,o.map)(()=>{}))};return this._measurePerformanceService?this._measurePerformanceService.measure("ViewModelCollection.reload",()=>t()):t()}removeChildModel(e,t){const a=t?.triggerNotification??!0,r=this._model?.name,s=e.getModelByName(r);this._model?.removeChild(s),a&&this._model?.childrenChange()}copyWithin(e,t,a){return this._triggerChangesAfter(()=>super.copyWithin(e,t,a))}fill(e,t,a){return this._triggerChangesAfter(()=>super.fill(e,t,a))}push(...e){return this._triggerChangesAfter(()=>super.push(...e))}reverse(){return this._triggerChangesAfter(()=>super.reverse())}shift(){return this._triggerChangesAfter(()=>super.shift())}sort(e){return this._triggerChangesAfter(()=>super.sort(e))}splice(e,t,...a){return this._triggerChangesAfter(()=>super.splice(e,t,...a))}unshift(...e){return this._triggerChangesAfter(()=>super.unshift(...e))}getChangedItems(){const e=[...this._deletedItems];return this.filter(a=>{if(a.attributes.IsChanged)return!0;const r=a.getPrimaryModelMode();return r&&r!==m.ModelMode.Update}).concat(e)}createItem(e){var t=this;const a=function(){var r=(0,y.A)(function*(){const s=yield t._generateItem(e||{});return t._insertItem(s,e?.index),s});return function(){return r.apply(this,arguments)}}();return this._measurePerformanceService?this._measurePerformanceService.measureCallback("ViewModelCollection.createItem",()=>a()):a()}getPrimaryAttributeValues(){return Promise.all(this.map(e=>e?.[e?.primaryAttributeName]))}findByPrimaryAttribute(e){var t=this;return(0,y.A)(function*(){for(const a of t)if(yield t._isItemPrimaryAttributeEqual(a,[e]))return a})()}filterByPrimaryAttributes(e){var t=this;return(0,y.A)(function*(){const a=[];for(const r of t)(yield t._isItemPrimaryAttributeEqual(r,e))&&a.push(r);return a})()}merge(e){const t=()=>{this._triggerChangesAfter(()=>{const a=this._mergeItems([...this],e);super.splice(0,this.length,...a),this._createdItems.splice(0,this._createdItems.length),e instanceof q&&this._mergeItems(this._deletedItems,e._deletedItems)})};return this._measurePerformanceService?this._measurePerformanceService.measure("ViewModelCollection.merge",()=>t()):t()}reload(e){return(0,c.lastValueFrom)(this._reload(e))}remove(e){const[t,a]=typeof e=="number"?[e,this[e]]:[this.indexOf(e),e];if(t>=0&&t<this.length)return this.splice(t,1),(0,c.lastValueFrom)(a.destroy())}clear(){return this.reload([])}moveTo(e,t){if(t>=this.length)throw new n.ArgumentOutOfRangeException("Target index cannot be greater than collection length");const a=this.indexOf(e);a===t||t<0||this._triggerChangesAfter(()=>{super.splice(t,0,super.splice(a,1)[0])})}destroy(){this._isDestroyed=!0,this._host=null;const e=this._reload([]);return this._formApiModel.clear({emitEvent:!1}),this._itemAttributeChanged.complete(),this._itemsChanged.complete(),this._destroyed$.next(),this._destroyed$.complete(),(0,c.lastValueFrom)(e)}}class Zt{constructor(e,t,a=!1){this.name=e,this._value=t,this._locked=a,this._isValueInitialized=!1,this._pendingValue=void 0,this._onChanged=new p.EventEmitter,this._hasInitialValue=!1,t!=null&&(this._isValueInitialized=!0,this._hasInitialValue=!0,this._initialValue=t)}get onChanged(){return this._onChanged}get value(){return this.getValue()}set value(e){this.setValue(e)}get initialValue(){return this._initialValue}set initialValue(e){this.setInitialValue(e)}get hasInitialValue(){return this._hasInitialValue}get isLocked(){return this._locked}emitValueChanged(e){this.onChanged.emit(e)}areValuesEqual(e,t){return(0,b.isEqual)(e,t)}getValue(){return this._value}setValue(e,t=!1){if(this._locked||(this._isValueInitialized=!0,this._pendingValue=e,this.areValuesEqual(this._value,e)))return;const a=(0,b.cloneDeep)(this._value);this._value=(0,b.cloneDeep)(e),!t&&this.emitValueChanged({name:this.name,value:e,oldValue:a})}resetValue(){this.hasInitialValue&&this.setValue(this.initialValue)}setInitialValue(e){this._hasInitialValue=!0,this._initialValue=e,this._isValueInitialized||this.setValue(e,!0)}setPending(e){const t=typeof this._pendingValue>"u"?this.value:this._pendingValue;this.value=e,this._pendingValue=t}resetPending(){this.value=this._pendingValue,this._pendingValue=void 0}}class ct extends Zt{constructor(e,t,a,r,s=!1){super(e,t,s),this._validatorTypeResolver=a,this._injectionContext=r,this._onValidatorChanged=new p.EventEmitter}get onValidatorChanged(){return this._onValidatorChanged}_createValidatorInfo(){return{name:this.validatorTypeName,instance:this._validatorTypeResolver.getValidator(this.validatorTypeName,{injectionContext:this._injectionContext}),disabled:!0}}emitValueChanged(e){super.emitValueChanged(e),this.hasValidator&&this.updateValidator(e)&&this._onValidatorChanged.emit()}get hasValidator(){return!1}updateValidator(e){return!1}setValidatorInfo(e,t=!1){this.validatorInfo=e}initializeValidator(e,t=!1){if(!this.hasValidator||this._validatorTypeResolver==null)return[...e];let a=e.find(s=>s.name===this.validatorTypeName),r=!1;return a==null&&(a=this._createValidatorInfo(),r=!0),this.setValidatorInfo(a,t),r?[...e,a]:[...e]}}var g=R(5960);class Kt{static{this._properties=new Map}static _get(e){if(!e)return ct;if(this._properties.has(e))return this._properties.get(e);throw new Error(`CrtControlProperty with type ${e} doesn't registered`)}static register(e,t){this._properties.set(e,t)}static create(e){const t=this._get(e.typeName);return new t(e.name,e.value,e.validatorTypeResolver,e.injectionContext,e.locked===!0)}}function hs(u){return function(e){(0,n.checkTypeNameFormat)(u.name,"PropertyName"),Kt.register(u.name,e)}}let Yt=class extends ct{constructor(){super(...arguments),this.validatorTypeName="crt.Required"}get hasValidator(){return!0}updateValidator(e){return this.validatorInfo&&(this.validatorInfo.disabled=!e.value),!0}setValidatorInfo(e,t=!1){super.setValidatorInfo(e,t),this.initialValue=!e.disabled,this.setValue(!e.disabled,t)}};Yt=(0,g.__decorate)([hs({name:"crt.Required"})],Yt);class ms{}class Je{constructor(e){this.injector=e}}let N=class extends n.BaseValidator{constructor(e){super(),this.injector=e}defaultValidationError(e){const t=this.injector?.get(_e.TranslateService),a=e??{},r=t?.instant(this.i18nMessageKey,a);return{message:e?.message||r||""}}};N=(0,g.__decorate)([(0,n.CrtValidator)(),(0,g.__metadata)("design:paramtypes",[p.Injector])],N);const ps="DataValueType";class Se extends Zt{get propertiesConfig(){return[{name:"visible",defaultValue:!0},{name:"displayColor"},{name:"required",typeName:"crt.Required",defaultValue:!1}]}get formControl(){return this._formControl||(this._formControl=new x.FormControl(this.value),this._subscribeOnFormControl(this._formControl)),this._formControl}set formControl(e){this._formControl=e,this._subscribeOnFormControl(this._formControl)}get properties(){return this._properties}get onPropertyChanged(){return this._onPropertyChanged}get visible(){return this.getPropertyByName("visible").getValue()}set visible(e){const t=this.getPropertyByName("visible");t.value=e}get required(){return this.getPropertyByName("required").getValue()}set required(e){const t=this.getPropertyByName("required");t.value=e}get displayColor(){return this.getPropertyByName("displayColor").getValue()}set displayColor(e){const t=this.getPropertyByName("displayColor");t.value=e}get isDirty(){return this.formControl.dirty}constructor(e=null,t=null,a=!1,r="",s=[],i,l,d,h){super(r,e),this.validationState=t,this.disabled=a,this._subscription=new c.Subscription,this._onPropertyChanged=new p.EventEmitter,this._crtControlStateAdapter=i,this._validatorTypeResolver=l,this._injectionContext=h,this._initProperties(s),this._subscribeOnPropertiesEvents(),this._initializeValidators(d??[],!0)}static create(e){return new Se(e.value,null,!1,e.name,e.propertiesConfig??[],e.crtControlStateAdapter,e.validatorTypeResolver,e.validatorInfo,e.injectionContext)}_subscribeOnFormControl(e){this._formControlSubscription?.unsubscribe(),this._formControlSubscription=e.valueChanges.pipe((0,o.startWith)(e.value),(0,o.distinctUntilChanged)((t,a)=>this.areValuesEqual(t,a))).subscribe(t=>{this.setValue(t)})}_initProperties(e){const t=[...this.propertiesConfig,...e];this._properties=new Map,t.forEach(a=>{const r=Kt.create({typeName:a.typeName,name:a.name,value:a.defaultValue,locked:a.locked===!0,validatorTypeResolver:this._validatorTypeResolver,injectionContext:this._injectionContext});this._properties.set(a.name,r)})}_subscribeOnPropertyEvents(e){this._subscription.add(e.onChanged.subscribe(({name:t,value:a,oldValue:r})=>{this.onPropertyChanged.emit({name:t,value:a,oldValue:r})})),this._subscription.add(e.onValidatorChanged.subscribe(()=>{this._refreshValidators()}))}_subscribeOnPropertiesEvents(){this.properties.forEach(e=>{this._subscribeOnPropertyEvents(e)})}_initializeValidators(e,t=!1){this._validatorInfo=e,this._properties.forEach(a=>{this._validatorInfo=a.initializeValidator(this._validatorInfo,t)}),this._refreshValidators()}_getEnabledValidatorFns(e=!1){return this._validatorInfo.filter(t=>!t.disabled&&t.instance.isAsync===e).map(t=>this._crtControlStateAdapter.transform(t))??[]}_refreshValidators(){const e=this._getEnabledValidatorFns();this.formControl.setValidators(e);const t=this._getEnabledValidatorFns(!0);this.formControl.setAsyncValidators(t),this.formControl.updateValueAndValidity()}_updateValidator(e,t=!1){const a=this._validatorInfo.find(r=>r.name===e);if(!a)throw new Error(`Validator ${e} does not exist on ${this.name} attribute.`);a.disabled!==t&&(a.disabled=t,this._refreshValidators())}setValue(e,t){const a=this.formControl;this.areValuesEqual(e,a.value)||(a.dirty||a.markAsDirty(),a.setValue(e,{onlySelf:!!t})),super.setValue(e,t)}findPropertyByName(e){return this.properties.has(e)?this.properties.get(e):null}enableValidator(e){this._updateValidator(e,!1)}disableValidator(e){this._updateValidator(e,!0)}change(e){this.setValue(e)}getPropertyByName(e,t=!1){let a=this.findPropertyByName(e);return!a&&t&&(a=new ct(e,null,this._validatorTypeResolver,this._injectionContext),this._properties.set(e,a),this._subscribeOnPropertyEvents(a)),a}hasPropertyValue(e){return!!this.getPropertyByName(e)}getPropertyValue(e){const t=this.getPropertyByName(e);return t?t.getValue():null}setPropertyValue(e,t,a=!1){this.getPropertyByName(e,!0).setValue(t,a)}setPropertyInitialValue(e,t){this.getPropertyByName(e,!0).setInitialValue(t)}getPropertyInitialValue(e){return this.getPropertyByName(e)?.initialValue}getValue(){return this._formControl?this._formControl.value:super.getValue()}destroy(){this._formControlSubscription?.unsubscribe(),this._subscription.unsubscribe()}getInvariabilityPropertyName(){const e=this.getPropertyValue(n.ViewElementProperty.Readonly),t=this.getPropertyValue(n.ViewElementProperty.Disabled);return e??t}toggle(e){const t=this.getInvariabilityPropertyName(),a=this.getPropertyByName(t);a&&(e?a.resetPending():a.setPending(!0))}}class L{get attributesMap(){return this._attributesMap}get mappedViewModelAttributes(){return this._mappedViewModelAttributes}get isCollection(){return this._isCollection}get collectionViewModelAttributeName(){return this._collectionViewModelAttributeName}constructor(e){this._attributesMap=new Map,this._mappedViewModelAttributes=new Set,this.attributes=[],this.includePrimaryAttributes=!0,this.name=e}static _getDataSourceInfo(e,t){if(!e.has(t)){const a=new L(t);return e.set(t,a),a}return e.get(t)}static _extractViewModelAttributeMapInfo(e){const t=e.split(".");return{dataSourceName:t.shift(),dataSourceAttributePath:t.join(".")}}static _getByDefaultAttribute(e,t,a,r=""){const s=t.modelConfig;if(!s||!s.path)return;const i=this._extractViewModelAttributeMapInfo(s.path);if(!i.dataSourceAttributePath){this._getByViewModelCollectionAttribute(e,t,a);return}if(r&&r!==i.dataSourceName)throw new Error(`Attribute '${e}' mapped on a few DataSources`);const l=this._getDataSourceInfo(a,i.dataSourceName),d=s.aggregationConfig?.aggregationFunction?(0,m.removeSpecialSymbols)(i.dataSourceAttributePath):i.dataSourceAttributePath;l.attributes.push({path:d,type:s.type,functionConfig:s.functionConfig,aggregationConfig:s.aggregationConfig}),l._mappedViewModelAttributes.add(e),l._attributesMap.set(e,i.dataSourceAttributePath)}static _getByInlineViewModelAttribute(e,t,a,r=""){const s=t.viewModelConfig||{};Object.entries(s.attributes||{}).forEach(([i,l])=>{const d=`${e}.${i}`;this._processViewModelAttribute(d,l,a,r)})}static _getByViewModelCollectionAttribute(e,t,a){const r=t.modelConfig;if(!r||!r.path)return;const i=this._extractViewModelAttributeMapInfo(r.path).dataSourceName,l=this._getDataSourceInfo(a,i);l._isCollection=!0,l._collectionViewModelAttributeName=e,l._pagingConfig=r.pagingConfig,l._sortingConfig=r.sortingConfig,l._filteringConfig=r.filterAttributes,l.includePrimaryAttributes=r.includePrimaryAttributes===void 0?!0:r.includePrimaryAttributes;const d=t?.viewModelConfig;Object.entries(d?.attributes||{}).forEach(([h,f])=>{this._processViewModelAttribute(`${e}.${h}`,f,a,i)})}static _processViewModelAttribute(e,t,a,r=""){"viewModelConfig"in t||"viewModelName"in t?t.isCollection?this._getByViewModelCollectionAttribute(e,t,a):this._getByInlineViewModelAttribute(e,t,a,r):"from"in t||this._getByDefaultAttribute(e,t,a,r)}static getFromViewModelConfig(e,t=[]){const a=new Map;return Object.entries(e?.attributes||{}).forEach(([r,s])=>{this._processViewModelAttribute(r,s,a)}),t.filter(r=>!a.has(r.name)).forEach(({name:r})=>{const s=new L(r);a.set(r,s)}),a}static getLookupListDataSourceInfo(e,t){const a=new L("");return a._isCollection=!0,a._collectionViewModelAttributeName=e,Object.entries(t).forEach(([r,s])=>{a.attributes.push({path:s}),a._mappedViewModelAttributes.add(r),a._attributesMap.set(r,s)}),a}_getRowModelDto(e){const t=e.length>0?e[0]:{},a={};return Object.entries(t).forEach(([r,s])=>{this.getMappedAttributeNames(r).forEach(l=>{const d=l.split(".");this.isCollection&&d.length>1&&d.shift(),(0,b.set)(a,d.join("."),s)})}),a}_getCollectionModelDto(e){const t=this._collectionViewModelAttributeName,a=e.map(r=>this._getRowModelDto([r]));return{[t]:a}}getMappedAttributes(){return Array.from(this._mappedViewModelAttributes.values())}getMappedAttributeNames(e){return Array.from(this._attributesMap.entries()).filter(([,t])=>t===e).map(([t])=>t)}getDataSourceAttributePath(e){return this._attributesMap.has(e)?this._attributesMap.get(e):""}getIsMapOnCollection(e){return this._isCollection&&this._collectionViewModelAttributeName===e}getPagingConfig(){return this._pagingConfig}getSortingConfig(){return this._sortingConfig}getFilteringConfig(){return this._filteringConfig||[]}getModelDto(e){return this._isCollection?this._getCollectionModelDto(e):this._getRowModelDto(e)}addNewAttribute(e,t,a){const r=new Map;r.set(this.name,this),L._getByDefaultAttribute(e,t,r,a)}getIsDataSourceAttributePathExists(e){return this.attributes.find(t=>t.path===e)!==void 0}}let Ze=class extends N{constructor(){super(...arguments),this.i18nMessageKey="Validators.Required.Message",this.async=!1}validateLczValue(e){return e?!!e.find(t=>t.value&&t.value.trim()):!1}validate(e,t){const a=e.value;return(typeof a=="string"?!!(e&&e.value?.trim()):this.validateLczValue(a))?null:{required:this.defaultValidationError(t)}}};Ze=(0,g.__decorate)([(0,n.CrtValidator)({type:"crt.EmptyOrWhiteSpace"})],Ze);let Qt=class extends Ze{constructor(e,t){super(e),this.injector=e,this._userInfo=t}validateLczValue(e){return e?!!e.find(t=>t.cultureName===this._userInfo.cultureInfo.sysCultureName&&t.value&&t.value.trim()):!1}};Qt=(0,g.__decorate)([(0,n.CrtValidator)({type:"crt.EmptyOrWhiteLczSpace"}),(0,g.__metadata)("design:paramtypes",[p.Injector,m.UserInfo])],Qt);var Xt;(function(u){u.Attachments="efbf3a0d-d780-465a-8e4b-8c0765197cfb"})(Xt||(Xt={}));class si extends Se{constructor(e){super(e.value,e.errors,e.disabled),this.formControl=e}}let dt=class extends N{constructor(){super(...arguments),this.i18nMessageKey="Validators.Max.Message",this.async=!1}validate(e,t){const r=x.Validators.max(t.max)(e);return r?{max:this.defaultValidationError({...t,...r.max})}:null}};dt=(0,g.__decorate)([(0,n.CrtValidator)({type:"crt.Max"})],dt);function ii(u,e="value"){return u.map(t=>({displayValue:t.caption,value:t[e],uId:t.uId}))}function ni(u){const e=u?.config;if(!e)return!1;const t=e;if(!!(t.dataSourceConfig&&t.attributeName))return!0;const r=e;return r.loadType===n.DataSourceLoadType.Load||r.loadType===n.DataSourceLoadType.Reload}function ea(u){Object.values(u.controls||{}).forEach(e=>{e instanceof x.FormGroup||e instanceof x.FormArray?ea(e):e.updateValueAndValidity({onlySelf:!0})})}function ht(u){u?.markAsPristine(),u?.markAsUntouched(),u?.updateValueAndValidity()}function oi(u){return Object.values(u?.errors||{}).map(e=>e?.message).filter(Boolean)}function ta(u){return u.statusChanges.pipe((0,o.startWith)(u.status),(0,o.first)(()=>u.status.toLowerCase()!=="pending"),(0,o.map)(()=>{}))}function li(u,e){const t=u.getBoundDataSchema(e),a=u.getBoundDataSourceName(e),r=t?.attributes.find(s=>u.getViewModelAttributePath(a,s.name)===e);return Promise.resolve({...r,referenceSchemaName:r?.referenceSchemaName??t?.name})}function gs(u,e){return aa.apply(this,arguments)}function aa(){return aa=(0,y.A)(function*(u,e){const t=typeof e=="string"?e.split("."):e;let a=t.shift(),r=u;for(;a;)r=yield r[a],a=t.shift();return r}),aa.apply(this,arguments)}const fs="invalidate-data-schema-cache",_s="DS",ys="DYN",Ss="CopilotIntentMode",Ms={Chat:"Chat",Api:"API"},bs=new Map([["Chat","326bba59-302a-4a5e-857c-2576e1a38ab0"],["API","5f2dc095-4543-4972-b6bc-6599bf6bc3fd"]]),As="CopilotIntentStatus",Cs=new Map([["InDevelopment","4670b068-ad03-4364-9350-6cc61efd1b7f"],["Active","1d73b111-07a9-49e2-aa15-c9415cce7470"],["Deactivated","2c547e71-7a05-42e1-8b65-2bf63f200156"]]),ra={System:{value:"35f3b644-4fa3-4d1e-8e62-5c3fdc4d3e52",displayValue:"System",primaryColorValue:"#22AC14"},Skill:{value:"6d940b75-21c8-4a90-89ab-9867e6e4a045",displayValue:"Skill",primaryColorValue:"#7848EE"},Agent:{value:"a8fbe253-be1b-4ec4-bc58-65b8047013da",displayValue:"Agent",primaryColorValue:"#E67E22"}};function Rs(){return(0,c.of)(Object.values(ra))}function Me(u){for(;u?.parent;)u=u.parent;return u}function Q(u){return u?.getDataSource()?.scope===n.DataSourceScope.Page}function Ds(u){const e=[];return u?._modelsMap.forEach((t,a)=>{Q(t)&&e.push(a)}),e}class Ke{static{this._dataCache=new WeakMap}static _getDataSourceColumns(e){const t={};let a=!1;for(const[r,s]of Object.entries(e.dataSourceConfig.config.attributes)){const i=s.path;t[(0,m.removeSpecialSymbols)(r)]=i,i==="Id"&&(a=!0)}return!a&&e.includePrimaryAttributes!==!1&&(t.Id="Id"),t}static _createAttributesConfigMap(e,t,a,r,s){const i={},l=this.getAttributeDataSourceOldName(e,r);for(const[d]of Object.entries(t)){const h=s.config?.useOriginalAttributesName?`${d}`:`${l}_${d}`,f=s.config.attributes[d],_={path:`${a}.${d}`,type:f?.type,functionConfig:f?.functionConfig,aggregationConfig:f?.aggregationConfig};i[h]={modelConfig:_}}return i}static _createAttributePagingConfig(e){return e.pagingConfig||{rowCount:30}}static _createAttributeSortingConfig(e){return e.sortingConfig||{attributeName:e.attributeName+"Sorting"}}static _createAttributeFiltersConfig(e){return e.filtersConfig?.map(t=>{const a={...t};return delete a.value,a})||[]}static _getDataSourceNameForDynamicModel(e,t){return e.getBoundDataSourceNameByAttributePath(t)||this._getAttributeDataSourceDefaultName(t)}static _getDynamicDataSourceNamePrefix(){return`${ys}_`}static _isDynamicDataSourceName(e){return e.startsWith(this._getDynamicDataSourceNamePrefix())}static _getAttributeDataSourceDefaultName(e){return`${e}${_s}`}static _getLoadData(e,t,a,r){let s;return this._dataCache.has(e)?s=this._dataCache.get(e):(s=t.load(a,[]).pipe((0,o.share)(),(0,o.tap)(()=>this._dataCache.delete(e))),this._dataCache.set(e,s)),(0,c.lastValueFrom)(s.pipe((0,c.map)(()=>r())),{defaultValue:null})}static createAttributeConfig(e,t,a){const r=a.attributeName,s=a.dataSourceConfig,i=this._getDataSourceColumns(a),l=this._createAttributesConfigMap(e,i,t,r,s),d=this._createAttributePagingConfig(a),h=this._createAttributeSortingConfig(a),f=this._createAttributeFiltersConfig(a);return{isCollection:!0,modelConfig:{path:t,pagingConfig:d,sortingConfig:h,filterAttributes:f},viewModelConfig:{attributes:l}}}static getAttributeDataSourceOldName(e,t){let a=this._getDataSourceNameForDynamicModel(e,t);return(!a||this._isDynamicDataSourceName(a))&&(a=this._getAttributeDataSourceDefaultName(t)),a}static createDynamicDataSourceNameFromAttributeName(e,t){const a=this._getDynamicDataSourceNamePrefix(),r=this._getDataSourceNameForDynamicModel(e,t);return this._isDynamicDataSourceName(r)?r:`${a}${r}`}static defineAsyncAttribute(e,t,a,r,s){const i=a.modelConfig?.path?.split(".")[0],l=e.getModelByName(i),d="isLookup"in a&&a.isLookup,h="isCollection"in a&&a.isCollection;Object.defineProperty(e,t,{get:()=>l&&h&&!d&&!l?.isLoaded?this._getLoadData(l,e,i,r):Promise.resolve(r()),set:s,configurable:!0})}}class I{static _trimValueIfNeeded(e,t){return t?.trimValue&&!I.isEmptyInputValue(e)&&(0,m.isString)(e)?e.trim():e}static isEmptyInputValue(e){return e==null||(typeof e=="string"||Array.isArray(e))&&e.length===0}static hasValidLength(e){return e!=null&&typeof e.length=="number"}static getControlValueAndTrimIfNeeded(e,t){return I._trimValueIfNeeded(e.value,t)}}class v{static _setImageLookupTypeUrl(e,t){const a=e[t],r=a?.value;r&&(a.url=(0,m.getImageFullUrlById)(r))}static _setBlobTypeUrl(e,t,a){const r=t[a];if(r){const s=t.Id;t[a]={value:r,url:(0,m.getImageFullUrlById)(s,e,a)}}}static _addImageUrl(e,t,a){t.forEach(r=>{switch(r.dataValueType){case n.DataValueType.IMAGELOOKUP:{this._setImageLookupTypeUrl(a,r.name);break}case n.DataValueType.Image:{this._setBlobTypeUrl(e,a,r.name);break}default:break}})}static serializeRecordPrimaryAttributesValues(e){return e.map(t=>`${t.name}:${t.value}`).join(";")}static getModelPrimaryAttributeValues(e,t){const a=e.getPrimaryAttributesNames();return t.map(r=>a.map(s=>({name:s,value:r[s]})))}static getOwnColumnsValues(e,t){const a=t??{};if(e.attributes.length){const r=e.attributes.filter(s=>s.attributeType===n.DataSchemaAttributeType.OwnAttribute).map(s=>s.name).filter(s=>!(0,b.isUndefined)(a[s])).map(s=>[s,a[s]]);return Object.fromEntries(r)}else return a}static getPrimaryAttributeValuesFromParameters(e,t){const a=t.filter(r=>r.type===n.ModelParameterType.PrimaryColumnValue);return a.length?a.map(r=>({[e.primaryAttributeName]:r.value})):[]}static getPrimaryAttributeValuesFromData(e,t){const a=e.getPrimaryAttributesNames();return a.length?a.filter(r=>t[r]).map(r=>({[r]:t[r]})):[]}static getPrimaryAttributeValues(e,t,a){const r=this.getPrimaryAttributeValuesFromData(e,t);return r.length?r:this.getPrimaryAttributeValuesFromParameters(e,a)}static getDataSourceLoadOptions(e){const t={loadType:e?.loadType||n.DataSourceLoadType.Load};return e?.pagingConfig&&(t.pagingConfig=e.pagingConfig),e?.sortingConfig&&(t.sortingConfig=e.sortingConfig),e?.isDistinct&&(t.isDistinct=e.isDistinct),t}static getImageAttributes(e,t){const a=[];return(t||[]).forEach(r=>{const s=e.findAttributeByName(r);s?.isImage&&a.push(s)}),a}static processImageData(e,t,a){const r=v.getImageAttributes(e,a);return r.length>0&&t.forEach(s=>this._addImageUrl(e.name,r,s)),t}static removeNotRequestedData(e,t){return Object.keys(t).forEach(a=>{e.includes(a)||delete t[a]}),t}static getLoadRequestSignature(e,t,a,r){return JSON.stringify(e)+JSON.stringify(t)+JSON.stringify(a)+JSON.stringify(r)}}var C;(function(u){u.None="None",u.OneToMany="OneToMany",u.ManyToOne="ManyToOne",u.ManyToMany="ManyToMany",u.CircularDependency="CircularDependency"})(C||(C={}));function mt(u,e){return!!u?.some(t=>t.relationPath.split(".").shift()===e)}function vs(u){return u.dataValueType===n.DataValueType.Guid}function Ps(u,e){return vs(e)&&u.primaryAttributeName===e.name}function sa(u,e,t,a){const r=t.findAttributeByName(a),s=u.findAttributeByName(e);return(s.isLookup||vs(s))&&Ps(t,r)?C.OneToMany:Ps(u,s)&&r.isLookup?C.ManyToOne:C.ManyToMany}function ui(u,e,t,a,r){return u=[...u||[]],e.forEach(s=>{const l=s.getDataSource()?.dataSourceName,h=a?.[l]?.type!==m.DataSourceLoadingType.OnInit,f=r?.allowMultipleDataSources&&mt(r?.modelsDependenciesConfig?.[l],t);Q(s)&&h&&!f&&(u.find(S=>(S.name||t)===l)||u.push({name:l,action:n.ModelInPageAction.Add}))}),u}var Ye;(function(u){u.ForTheSelectedPage="ForTheSelectedPage",u.RegardlessOfThePage="RegardlessOfThePage",u.ForTheSelectedRecords="ForTheSelectedRecords"})(Ye||(Ye={}));function ci(u){return u===Ye.ForTheSelectedPage||u===Ye.ForTheSelectedRecords}let pt=class extends N{constructor(){super(...arguments),this.i18nMessageKey="Validators.MaxLength.Message",this.async=!1}_maxLengthValidator(e,t){return I.hasValidLength(e)&&e.length>t.maxLength?{maxlength:this.defaultValidationError({...t,requiredLength:t.maxLength,actualLength:e.length})}:null}validate(e,t){const a=I.getControlValueAndTrimIfNeeded(e,t);return this._maxLengthValidator(a,t)}};pt=(0,g.__decorate)([(0,n.CrtValidator)({type:"crt.MaxLength"})],pt);let gt=class extends N{constructor(){super(...arguments),this.i18nMessageKey="Validators.Min.Message",this.async=!1}validate(e,t){const r=x.Validators.min(t.min)(e);return r?{min:this.defaultValidationError({...t,...r.min})}:null}};gt=(0,g.__decorate)([(0,n.CrtValidator)({type:"crt.Min"})],gt);let ft=class extends N{constructor(){super(...arguments),this.i18nMessageKey="Validators.MinLength.Message",this.async=!1}_minLengthValidator(e,t){return I.isEmptyInputValue(e)||!I.hasValidLength(e)?null:e.length<t.minLength?{minlength:this.defaultValidationError({...t,requiredLength:t.minLength,actualLength:e.length})}:null}validate(e,t){const a=I.getControlValueAndTrimIfNeeded(e,t);return this._minLengthValidator(a,t)}};ft=(0,g.__decorate)([(0,n.CrtValidator)({type:"crt.MinLength"})],ft);let Qe=class extends N{constructor(){super(...arguments),this.i18nMessageKey="Validators.RegExp.Message",this.async=!1}validate(e,t){typeof t.regex=="string"&&(t.regex=new RegExp(t.regex));const a=t.regex.test(e.value);return this.i18nMessageKey=t.message||this.i18nMessageKey,a?null:{[t.errorCode]:this.defaultValidationError({...t})}}};Qe=(0,g.__decorate)([(0,n.CrtValidator)({type:"crt.RegExp"})],Qe);let _t=class extends N{constructor(){super(...arguments),this.i18nMessageKey="Validators.Required.Message",this.async=!1}_requiredValidator(e,t){return I.isEmptyInputValue(e)?{required:this.defaultValidationError(t)}:null}validate(e,t){const a=I.getControlValueAndTrimIfNeeded(e,t);return this._requiredValidator(a,t)}};_t=(0,g.__decorate)([(0,n.CrtValidator)({type:"crt.Required"})],_t);let yt=class extends N{constructor(e){super(e),this.injector=e,this._messageKey="Validators.SchemaNamePrefix.",this.async=!0,this._sysSettingsService=e.get(n.SysSettingsService)}_getSchemaNamePrefix(){var e=this;return(0,y.A)(function*(){return(yield e._sysSettingsService.getByCode("SchemaNamePrefix")).value})()}validate(e,t){var a=this;return(0,y.A)(function*(){if((0,b.isObject)(e.value))return null;const r=I.getControlValueAndTrimIfNeeded(e,{trimValue:!0}),s=yield a._getSchemaNamePrefix();if(s){const i=!r?.startsWith(s);if(i||r===s)return a.i18nMessageKey=i?a._messageKey+"NoSchemaNamePrefixMessage":a._messageKey+"OnlySchemaNamePrefixMessage",{namePrefixError:a.defaultValidationError({...t,schemaNamePrefix:s})}}return null})()}};yt=(0,g.__decorate)([(0,n.CrtValidator)({type:"crt.SchemaNamePrefix"}),(0,g.__metadata)("design:paramtypes",[p.Injector])],yt);let St=class extends Qe{constructor(){super(...arguments),this._params={regex:/^[a-zA-Z]+[a-zA-Z0-9-_]*$/,errorCode:"allowedSymbolsErrorCode"},this.i18nMessageKey="Validators.SchemaNameAllowedSymbols.Message",this.async=!1}validate(e){return super.validate(e,this._params)}};St=(0,g.__decorate)([(0,n.CrtValidator)({type:"crt.SchemaNameAllowedSymbols"})],St);let Mt=class extends N{constructor(){super(...arguments),this.i18nMessageKey="Validators.UniqueCodeColumnValue.Message",this.async=!1,this._windowCodeList="_copilotCodeList"}validate(e,t){const a=e.value;if(!a)return null;const r=window[this._windowCodeList];return r&&r.filter(i=>i===a).length>1?{uniqueColumnValue:this.defaultValidationError({...t,controlValue:a})}:null}};Mt=(0,g.__decorate)([(0,n.CrtValidator)({type:"crt.UniqueCodeColumnValue"})],Mt);const Es=/^[A-Za-z]+[A-Za-z0-9_]*$/;class di extends n.BaseValidator{constructor(e){super(),this.translateService=e,this.async=!1}validate(e){const t=I.getControlValueAndTrimIfNeeded(e);return t&&!Es.test(t)?{invalidValueSyntax:{message:this.translateService.instant("SchemaDesigners.EntitySchemaDesigner.ColumnEditor.Validations.PatternNameCaption")}}:null}}const Vs="calculated";class z{resolveModelConfig(e){return null}static{this.\u0275fac=function(t){return new(t||z)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:z,factory:z.\u0275fac,providedIn:"root"})}}class be{constructor(){this.account={attributes:{Name:{},Ships:{isCollection:!0,viewModelConfig:"ship"},Employee:{viewModelConfig:"employee"}}},this.ship={attributes:{Id:{}}},this.employee={attributes:{Name:{},Age:{}}}}resolveModelConfig(e){return(0,c.of)(this[e]).pipe((0,o.delay)(50))}static{this.\u0275fac=function(t){return new(t||be)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:be,factory:be.\u0275fac,providedIn:"root"})}}class W{constructor(e){this.injector=e,this.initDependencies()}initDependencies(){this.repository=this.injector.get(z),this.ngZone=this.injector.get(p.NgZone)}static{this.\u0275fac=function(t){return new(t||W)(p.\u0275\u0275inject(p.Injector))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:W,factory:W.\u0275fac})}}class G{transform(e){return function(t){const{instance:a,params:r}=e,s={value:t.value};return a.validate(s,r)}}static{this.\u0275fac=function(t){return new(t||G)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:G,factory:G.\u0275fac,providedIn:"root"})}}const hi=R(85088);class Ae{sort(e,t){const a=[];let r=[];Object.entries(e||{}).forEach(([i,l])=>{if((0,m.isCalculatedAttributeConfig)(l)){let d=l.from;d=Array.isArray(d)?d:[d];const h=d.map(f=>[i,f]);r=r.concat(h)}else a.push(i)});const s=hi(r).reverse();return[...a,...s].filter(Boolean).filter((i,l,d)=>d.indexOf(i)===l).map(i=>{const l=s.includes(i)?e[i]??t[i]:e[i];return[i,l]})}static{this.\u0275fac=function(t){return new(t||Ae)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Ae,factory:Ae.\u0275fac,providedIn:"root"})}}const ia=new p.InjectionToken("View model attribute creator factory");class Ce{constructor(e,t,a,r,s,i,l){this._crtControlStateAdapter=e,this._validatorTypeResolver=t,this._viewModelGenerator=a,this._attributeCreator=r,this._viewModelRepository=s,this._attributesTopologicalSorting=i,this._injector=l,this._featureValues=this._injector.get(m.FEATURE_VALUES,null,{optional:!0}),this._measurePerformanceService=this._injector.get(m.MeasurePerformanceService)}_generateAttributes(e,t,a){const r=this._attributesTopologicalSorting.sort(t,e._attributeConfigs);return Promise.all(r.map(([s,i])=>e._systemAttributes.includes(s)?(console.warn(`Overriding of system attributes is denied. Attribute name:"${s}"`),Promise.resolve()):(a.disableDefaultConfig||(i??={}),e._attributeConfigs[s]=i,i?"viewModelConfig"in i||"viewModelName"in i?i.isCollection?this._generateNestedModelCollectionAttribute(e,s,i,a):this._generateNestedModelAttribute(e,s,i,a):(0,m.isCalculatedAttributeConfig)(i)?this._generateCalculatedAttribute(e,s,i,a):this._generateModelAttribute(e,s,i,a):this._removeViewModelAttribute(e,s))))}_generateNestedModelCollectionAttribute(e,t,a,r){var s=this;return this._measurePerformanceService.measureCallback(`BaseViewModelAttributeGenerator.nestedCollectionAttribute.${t}`,(0,y.A)(function*(){const i=e.getBoundDataSourceNameByAttributePath(t),l=e.getModelByName(i),d="viewModelConfig"in a?a.viewModelConfig:yield(0,c.lastValueFrom)(s._viewModelRepository.resolveModelConfig(a.viewModelName)),h=new q(s._viewModelGenerator,d,l,e,t);s._registerOrSetFormControl(e.formApiModel,t,h.formApiModel);const f=e.attributes[t];e.attributes[t]=h,s._defineNestedModelAttribute(e,t,a,r),s._subscribeOnCollectionChanged(e,t,h,r),f!==void 0&&r.onChangeAttributeValue(t,h,f)}))}_defineNestedModelAttribute(e,t,a,r){const s=l=>{const d=e.attributes[t];e.attributes[t]=l,d instanceof q&&l instanceof q&&this._subscribeOnCollectionChanged(e,t,l,r),r.onChangeAttributeValue(t,l,d)},i=()=>e.attributes[t];Ke.defineAsyncAttribute(e,t,a,i,s)}_generateNestedModelAttribute(e,t,a,r){return this._measurePerformanceService.measureCallback(`BaseViewModelAttributeGenerator.nestedModelAttribute.${t}`,()=>{const s="viewModelConfig"in a?a.viewModelConfig:a.viewModelName,i=e?.[Y];return(0,c.lastValueFrom)(this._viewModelGenerator.generate({viewModelConfig:s,parentViewModel:e},i?p.Injector.create({providers:[{provide:Ge,useValue:null}],parent:i}):null).pipe((0,c.map)(l=>{this._registerOrSetFormControl(e.formApiModel,t,l.formApiModel);const d=e.attributes[t];e.attributes[t]=l,this._defineNestedModelAttribute(e,t,a,r),d!==void 0&&r.onChangeAttributeValue(t,l,d)})))})}_subscribeOnCollectionChanged(e,t,a,r){if(e._collectionSubscription.has(t)){const i=e._collectionSubscription.get(t);i.unsubscribe(),e._subscriptions.remove(i)}const s=new c.Subscription;s.add(a.changed.subscribe(()=>{r.onChangeAttributeValue(t,a,null)})),s.add(a.itemAttributeChanged.subscribe(()=>{r.onChangeAttributeValue(t,a,null)})),e._collectionSubscription.set(t,s),e._subscriptions.add(s)}_generateCalculatedAttribute(e,t,a,r){this._measurePerformanceService.measure(`BaseViewModelAttributeGenerator.generateCalculatedAttribute.${t}`,()=>{this._attributeCreator.create(Vs)?.defineAttribute({viewModel:e,attribute:t,attributeConfig:a,generateOptions:r})})}_addDataValueTypePropertyConfig(e,t){t.dataValueTypeName&&e.push({name:ps,defaultValue:n.DataValueType[t.dataValueTypeName]})}_disableSystemAttributes(e,t,a){if(this._featureValues?.DisableBlockingSystemColumns===!0)return;if(e.getBoundDataSchemaAttributeByAttributePath(t)?.isSystem){let s=a.find(i=>i.name==="readonly");s||(s={name:"readonly"},a.push(s)),s.locked=!0,s.defaultValue=!0}}_getCrtControlPropertiesConfig(e,t,a){const r=Object.entries(a.properties??[]).map(([s,i])=>({name:s,defaultValue:i.defaultValue,locked:i.locked===!0}));return this._addDataValueTypePropertyConfig(r,a),this._disableSystemAttributes(e,t,r),r}_generateModelAttribute(e,t,a,r){this._measurePerformanceService.measure(`BaseViewModelAttributeGenerator.generateModelAttribute.${t}`,()=>{const s=e.attributes[t],i=a?.value,l=this._getCrtControlPropertiesConfig(e,t,a),d=Se.create({name:t,value:i,crtControlStateAdapter:this._crtControlStateAdapter,validatorTypeResolver:this._validatorTypeResolver,validatorInfo:e._validators[t],propertiesConfig:l,injectionContext:e._injectionContext??Me(e)?._injectionContext});e._subscriptions.add(d.onChanged.subscribe(_=>{e.attributes[t]=_.value,r.onChangeAttributeValue(_.name,_.value,_.oldValue)})),e._subscriptions.add(d.onPropertyChanged.subscribe(({name:_,value:S,oldValue:M})=>{r.onChangeAttributeValue(`${t}:${_}`,S,M)})),e._crtControls.set(t,d),this._registerOrSetFormControl(e.formApiModel,t,d.formControl),e.attributes[t]=i??null;const h=e._getDataSourceAttributeDataValueType(t);this._attributeCreator.create(h).defineAttribute({viewModel:e,attribute:t,attributeConfig:a,control:d}),s!==void 0&&r.onChangeAttributeValue(t,i,s)})}_registerOrSetFormControl(e,t,a){this._measurePerformanceService.measure(`BaseViewModelAttributeGenerator.registerOrSetFormControl.${t}`,()=>{if(this._featureValues?.DisableAttributeOnlyRegisteringControl){e.setControl(t,a);return}e.contains(t)?e.setControl(t,a):e.registerControl(t,a)})}_removeViewModelAttribute(e,t){return delete e._attributeConfigs[t],delete e.attributes[t],delete e[t],Promise.resolve()}generate(e,t,a){var r=this;return this._measurePerformanceService.measureCallback("BaseViewModelAttributeGenerator.generateAttributes",(0,y.A)(function*(){yield r._generateAttributes(e,t,a),!r._featureValues?.DisableAttributeOnlyRegisteringControl&&e.formApiModel.updateValueAndValidity()}))}static{this.\u0275fac=function(t){return new(t||Ce)(p.\u0275\u0275inject(G),p.\u0275\u0275inject(Je),p.\u0275\u0275inject(W),p.\u0275\u0275inject(ia),p.\u0275\u0275inject(z),p.\u0275\u0275inject(Ae),p.\u0275\u0275inject(p.Injector))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Ce,factory:Ce.\u0275fac,providedIn:"root"})}}class Xe{_defineResourceAttribute(e,t,a,r,s){return new c.Observable(i=>{const l=e._getDataSourceAttributeCaption(r,s);if(this._defineResourceProperty(t,a,l),r.includes(".")){const d=r.split(".")[1];this._defineResourceProperty(t,d,l)}i.next(),i.complete()})}_defineResourceProperty(e,t,a){e[t]||Object.defineProperty(e,t,{get:()=>Promise.resolve(a??""),configurable:!0})}_getResourceNameByPath(e){const t=e.split(".");return t.length>1?t.join("_"):e}generate(e,t){return Object.entries(t||{}).map(([a,r])=>{const s=e[m.SchemaResourcesSuffix][m.TypeResources.string],i=this._getResourceNameByPath(a);return this._defineResourceAttribute(e,s,i,a,r)})}static{this.\u0275fac=function(t){return new(t||Xe)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Xe,factory:Xe.\u0275fac,providedIn:"root"})}}var na;(function(u){u[u.None=0]="None",u[u.Count=1]="Count",u[u.Sum=2]="Sum",u[u.Avg=3]="Avg",u[u.Min=4]="Min",u[u.Max=5]="Max",u[u.TopOne=6]="TopOne"})(na||(na={}));var V;(function(u){u.Create="create",u.Update="update",u.Delete="delete"})(V||(V={}));var oa;(function(u){u.Begin="begin",u.End="end"})(oa||(oa={}));var la;(function(u){u.AllSections="BaseGridSectionTemplate",u.AllCards="BasePageTemplate",u.AllMiniCards="BaseMiniPageTemplate",u.AllLookupSelectionWindows="BaseLookupPageTemplate"})(la||(la={}));var bt;(function(u){u.Paused="Paused",u.Active="Active"})(bt||(bt={}));var F;(function(u){u.DebouncingBusinessRules="DebouncingBusinessRules",u.RunningBusinessRules="RunningBusinessRules",u.ProcessingAttributeChangeRequest="ProcessingAttributeChangeRequest",u.AttributeLoading="AttributeLoading"})(F||(F={}));class B{get attributes(){return this._parent?[...this._parent.attributes,...this._attributes]:[...this._attributes]}get parent(){return this._parent}constructor(e){if(e!=null){this.name=e.name,this.type=e.type,e.caption&&(this.caption=typeof e.caption=="string"?e.caption:{...e.caption}),this.primaryAttributeName=e.primaryAttributeName,this.primaryDisplayAttributeName=e.primaryDisplayAttributeName,this.primaryColorAttributeName=e.primaryColorAttributeName,this.hierarchyAttributeName=e.hierarchyAttributeName,this.createdByAttributeName=e.createdByAttributeName,this.createdOnAttributeName=e.createdOnAttributeName,this.modifiedByAttributeName=e.modifiedByAttributeName,this.modifiedOnAttributeName=e.modifiedOnAttributeName,e.dataSourceConfig&&(this.dataSourceConfig={...e.dataSourceConfig,config:{...e.dataSourceConfig.config}}),this._parent=e.parent;const t=e.attributes??[];this._attributes=[],t.forEach(a=>{if(this._parent){this._parent.findAttributeByName(a.name)||this._attributes.push(a.clone());return}this._attributes.push(a.clone())})}else this._attributes=[]}clearAttributes(){this._attributes=[]}addAttribute(e){if(this._parent){this._parent.findAttributeByName(e.name)||this._attributes.push(e);return}this._attributes.push(e)}findAttributeByName(e){return this.attributes.find(t=>t.name===e)??null}getPrimaryAttributesNames(){return[this.primaryAttributeName]}getPrimaryLoadAttributes(){const e=[];return this.primaryAttributeName&&e.push(this.primaryAttributeName),this.primaryDisplayAttributeName&&e.push(this.primaryDisplayAttributeName),e}clone(){return new B(this)}createChild(){const e=new B;return e.name=this.name,e.type=this.type,this.caption&&(e.caption=typeof this.caption=="string"?this.caption:{...this.caption}),e.primaryAttributeName=this.primaryAttributeName,e.primaryDisplayAttributeName=this.primaryDisplayAttributeName,e.primaryColorAttributeName=this.primaryColorAttributeName,e.hierarchyAttributeName=this.hierarchyAttributeName,e.createdByAttributeName=this.createdByAttributeName,e.createdOnAttributeName=this.createdOnAttributeName,e.modifiedByAttributeName=this.modifiedByAttributeName,e.modifiedOnAttributeName=this.modifiedOnAttributeName,this.dataSourceConfig&&(e.dataSourceConfig={...this.dataSourceConfig,config:{...this.dataSourceConfig.config}}),e._attributes=[],e._parent=this,e}}class Re{get isDate(){return this.dataValueType===n.DataValueType.Date||this.dataValueType===n.DataValueType.DateTime||this.dataValueType===n.DataValueType.Time}get isImage(){return this.dataValueType===n.DataValueType.IMAGELOOKUP||this.dataValueType===n.DataValueType.Image}get isLookup(){return this.dataValueType===n.DataValueType.Lookup}set isSystem(e){this._isSystem=e}get isSystem(){return this._isSystem}get isAggregate(){return this.attributeType===n.DataSchemaAttributeType.AggregationAttribute?!0:this.attributeType===n.DataSchemaAttributeType.FunctionAttribute&&this.functionConfig?.type==="aggregation"}constructor(e){if(this._isSystem=!1,e!=null){this.name=e.name,this.caption=e.caption,this.path=e.path,this.dataValueType=e.dataValueType,e.validators&&(this.validators={...e.validators||{}});const t=e.defaultValue;t&&(t instanceof c.Observable?this.defaultValue=t.pipe((0,o.map)(a=>this._getConvertDefaultValue(a))):this.defaultValue=(0,c.of)(this._getConvertDefaultValue(t))),this.defaultValueSchema=e.defaultValueSchema,this.isValueCloneable=e.isValueCloneable,this.attributeType=e.attributeType,this.referenceSchemaName=e.referenceSchemaName,this.functionConfig=e.functionConfig,this.aggregationConfig=e.aggregationConfig,this.isMasked=e.isMasked,this.isFormatValidated=e.isFormatValidated,this.isSensitiveData=e.isSensitiveData,this.usageType=e.usageType,this.isRequired=e.isRequired,this.lookupMode=e.lookupMode,this.isSystem=!!e.isSystem}}_getConvertDefaultValue(e){if(this.isDate)if(e instanceof Date){const t=new Date;return t.setTime(e.getTime()),t}else return e;else return typeof e=="object"?{...e}:e}clone(){return new Re(this)}addDefaultValidators(){const e=this.validators??{};this.isRequired&&(e["crt.Required"]={type:"crt.Required"}),!this.validators&&Object.keys(e).length>0&&(this.validators=e)}}class At{addColumnCaption(e,t){const{name:a,caption:r}=t;if(!r)return;const s=e.findColumn(a);s&&s.withCaption(r)}addColumn(e,t){!e||!t||(this.addColumnInternal(e,t),this.addColumnCaption(e,t))}}class De extends At{addColumnInternal(e,t){const{name:a,path:r,aggregationConfig:s}=t;e.addAggregationSubQueryColumn(r,(0,n.toAggregationType)(s?.aggregationFunction),s,a)}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(De)))(a||De)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:De,factory:De.\u0275fac,providedIn:"root"})}}class ve extends At{addColumnInternal(e,t){e.addSchemaColumn(t.path,t.name)}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(ve)))(a||ve)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:ve,factory:ve.\u0275fac,providedIn:"root"})}}class Pe extends At{addColumnInternal(e,t){const{name:a,path:r}=t||{},s=t?.functionConfig;e.addAggregationFunctionColumn(r,(0,n.toAggregationType)(s?.aggregation),a,(0,n.toAggregationEvalType)(s?.aggregationEval))}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(Pe)))(a||Pe)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Pe,factory:Pe.\u0275fac,providedIn:"root"})}}class Ee extends At{addColumnInternal(e,t){const{name:a,path:r}=t||{},s=t?.functionConfig;e.addDatePartFunctionColumn(r,(0,n.toDatePartType)(s?.datePart),a)}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(Ee)))(a||Ee)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Ee,factory:Ee.\u0275fac,providedIn:"root"})}}class ua{constructor(e=null,t){e==null?this._dataSchema=new B:this._dataSchema=t?.useClone?e.clone():e.createChild()}_createDataSchemaAttributeByConfig(e){const t=new Re;return t.name=e.name,t.caption=e.caption,t.path=e.path,t.dataValueType=e.dataValueType,t.validators={...e.validators||{}},t.defaultValue=(0,c.of)(typeof e.defaultValue=="object"?{...e.defaultValue}:e.defaultValue),t.defaultValueSchema=e.defaultValueSchema,t.isValueCloneable=e.isValueCloneable,t.attributeType=e.attributeType,t.referenceSchemaName=e.referenceSchemaName,t.functionConfig=e.functionConfig,t.aggregationConfig=e.aggregationConfig,t.usageType=e.usageType,t.isMasked=e.isMasked,t.isFormatValidated=e.isFormatValidated,t.isSensitiveData=e.isSensitiveData,t.isRequired=e.isRequired,t.lookupMode=e.lookupMode,t.isSystem=e.isSystem??!1,t}setEntitySchemaColumnValidators(e,t){return e.isRequired&&this.setAttributeRequiredValidator(t),this.setAttributeTextDataValueTypeValidator(t,e.dataValueType).setAttributeNumberDataValueTypeValidator(t,e.dataValueType).setAttributePhoneDataValueTypeValidator(t,e)}setAttributeValidator(e,t,a){const r=this._dataSchema.attributes.find(i=>i.name===e),s=r.validators||{};return s[t]=a,r.validators=s,this}setAttributeRequiredValidator(e){return this.setAttributeValidator(e,"crt.Required",{type:"crt.Required"})}setAttributeMaxLengthValidator(e,t){return this.setAttributeValidator(e,"crt.MaxLength",{type:"crt.MaxLength",params:{maxLength:t}})}setAttributeTextDataValueTypeValidator(e,t){const a=(0,m.getTextDataValueTypeValidatorParams)(t);return a?this.setAttributeMaxLengthValidator(e,a.maxLength):this}setAttributeMinValueValidator(e,t){return this.setAttributeValidator(e,"crt.Min",{type:"crt.Min",params:{min:t}})}setAttributeMaxValueValidator(e,t){return this.setAttributeValidator(e,"crt.Max",{type:"crt.Max",params:{max:t}})}setAttributeMinMaxValidator(e,t,a){return this.setAttributeMinValueValidator(e,t).setAttributeMaxValueValidator(e,a)}setAttributeNumberDataValueTypeValidator(e,t){const a=(0,m.getNumberDataValueTypeValidatorParams)(t);return a&&this.setAttributeMinMaxValidator(e,a.minValue,a.maxValue),this}setAttributePhoneDataValueTypeValidator(e,t){return[n.DataValueType.PHONE_TEXT].includes(t.dataValueType)&&t.isMasked&&this.setAttributeRegExpValidator(e,{regex:/^((?!_).)*$/,errorCode:"phoneMaskValidator"}),this}setAttributeRegExpValidator(e,t){return this.setAttributeValidator(e,"crt.RegExp",{type:"crt.RegExp",params:t})}setAttributesDefaultValue(e){return this._dataSchema.attributes.forEach(t=>{t.defaultValue=e.pipe((0,o.map)(a=>a[t.name]))}),this}addAttribute(e,t){const{name:a,caption:r,dataValueType:s,isValueCloneable:i,referenceSchemaName:l,isMasked:d,isFormatValidated:h,usageType:f,isRequired:_,isSensitiveData:S}=e,M=new Re;return M.name=t.attributeName||a,M.path=t.attributePath||a,M.caption=r,M.dataValueType=s,M.isValueCloneable=!!i,M.attributeType=t.attributeType||n.DataSchemaAttributeType.OwnAttribute,M.referenceSchemaName=l,M.validators={},M.isMasked=d,M.isFormatValidated=h,M.isSensitiveData=S,M.usageType=f,M.isRequired=_,M.defaultValueSchema=e.defaultValueSchema,M.lookupMode=e.lookupMode,M.isSystem=(0,b.compact)([this._dataSchema.createdByAttributeName,this._dataSchema.createdOnAttributeName,this._dataSchema.modifiedByAttributeName,this._dataSchema.modifiedOnAttributeName,this._dataSchema.primaryAttributeName,"ProcessListeners"]).includes(M.name),this._dataSchema.addAttribute(M),t.attributeType===n.DataSchemaAttributeType.OwnAttribute&&this.setEntitySchemaColumnValidators(e,M.name),t.attributeType===n.DataSchemaAttributeType.AggregationAttribute&&(M.aggregationConfig=t.aggregationConfig),t.attributeType===n.DataSchemaAttributeType.FunctionAttribute&&(M.functionConfig=t.functionConfig),this}addOwnAttribute(e){return this.addAttribute(e,{attributeType:n.DataSchemaAttributeType.OwnAttribute})}setEntitySchema(e){return this._dataSchema.dataSourceConfig={type:"crt.EntityDataSource",config:{entitySchemaName:e.name}},this._dataSchema.name=e.name,this._dataSchema.type=n.DataSchemaType.Entity,this._dataSchema.primaryAttributeName=e.getPrimaryColumn()?.name,this._dataSchema.primaryDisplayAttributeName=e.getPrimaryDisplayColumn()?.name,this._dataSchema.primaryColorAttributeName=e.getPrimaryColorColumn()?.name,this._dataSchema.hierarchyAttributeName=e.getHierarchyColumn()?.name,this._dataSchema.caption=e.caption,this._dataSchema.createdByAttributeName=e.columns.find(t=>t.uId===e.createdByColumnUId)?.name,this._dataSchema.createdOnAttributeName=e.columns.find(t=>t.uId===e.createdOnColumnUId)?.name,this._dataSchema.modifiedByAttributeName=e.columns.find(t=>t.uId===e.modifiedByColumnUId)?.name,this._dataSchema.modifiedOnAttributeName=e.columns.find(t=>t.uId===e.modifiedOnColumnUId)?.name,this._dataSchema.clearAttributes(),e.columns.forEach(t=>{this.addOwnAttribute(t)}),this}setDataSchemaConfig(e){return this._dataSchema.name=e.name,this._dataSchema.type=e.type,this._dataSchema.caption=typeof e.caption=="string"?e.caption:{...e.caption},this._dataSchema.primaryAttributeName=e.primaryAttributeName,this._dataSchema.primaryDisplayAttributeName=e.primaryDisplayAttributeName,this._dataSchema.dataSourceConfig={...e.dataSourceConfig,config:{...e.dataSourceConfig?.config}},(e.attributes||[]).forEach(a=>{const r=this._createDataSchemaAttributeByConfig(a);this._dataSchema.addAttribute(r)}),this}build(){return this._dataSchema.clone()}}var mi=R(63721),pi=R(31589),gi=R(85638),Ts=R(35266);class ca extends Error{get isCritical(){return!0}constructor(e,t){super(t),this.dataSource=e}}class Ct extends ca{constructor(e,t){super(e,t)}}class Ns extends ca{get isCritical(){return!1}constructor(e,t){super(e,t)}}class Rt{constructor(e,t){this.dataSourceName=e,this.injector=t,this._errors=[]}get scope(){return this._scope}get hasErrors(){return this._errors.length!==0}get hasCriticalErrors(){return this._errors.some(e=>e.isCritical)}get affectedAttributes(){return[]}get isForceUpdateUnchangedData(){return!1}getLastError(){return this.hasErrors?this._errors[this._errors.length-1]:null}get isAggregate(){return!1}getEmptySchema(){return new B}init(e,t){return this.initialConfig=e,this._scope=t,(0,c.of)(this)}load(e,t,a){return this.innerLoad(e,t,a)}save(e,t){return this.innerSave(e,t)}insert(e){return this.innerInsert(e)}delete(e){return this.innerDelete(e)}getSchema(){return this.dataSchema?(0,c.of)(this.dataSchema):this.innerGetSchema().pipe((0,o.tap)(e=>{this.dataSchema=e}))}getLookupDataSchema(e){return this.innerGetLookupDataSchema(e)}getDefaultValues(){return this.innerGetDefaultValues()}canEdit(e){return this.innerCanEdit(e)}canDelete(e){return this.innerCanDelete(e)}canCreate(e){return this.innerCanCreate(e)}getOwnLoadParameters(){return null}getAllowCopyingRecords(){return!1}}class fi extends Ct{get entitySchemaName(){return this._entitySchemaName}constructor(e,t){super(e,`Entity schema with name '${t}' not found.`),this._entitySchemaName=t}}class _i extends Ct{constructor(e){super(e,`Entity schema name for data source ${e.dataSourceName} is not provided`)}}class yi{constructor(e){this._dataSchemaRepository=e}_getDataSchema(e){var t=this;return(0,y.A)(function*(){const a=yield(0,c.firstValueFrom)(t._dataSchemaRepository.get(e));if(!a)throw new Error(`Can not find DataSchema with name '${e}'`);return a})()}_getDataSchemaAttribute(e,t){var a=this;return(0,y.A)(function*(){const r=e instanceof B?e:yield a._getDataSchema(e),s=r.findAttributeByName(t);if(!s)throw new Error(`Can not find column '${t}' in Schema '${r.name}'`);return s})()}_getDataSchemaPrimaryAttribute(e){var t=this;return(0,y.A)(function*(){const a=yield t._getDataSchema(e);return t._getDataSchemaAttribute(a,a.primaryAttributeName)})()}_createRelationPathItemFromForwardPathItem(e,t){var a=this;return(0,y.A)(function*(){const r=yield a._getDataSchemaAttribute(e,t);let s=null,i=null;const l=r.dataValueType===n.DataValueType.Lookup;return l&&(s=r.referenceSchemaName,i=(yield a._getDataSchema(s)).primaryAttributeName),{isJoin:l,referenceSchemaName:s,referenceAttributeName:i,ownSchemaAttributeName:t,ownSchemaName:e}})()}_createRelationPathItemFromJoinPathItem(e,t,a,r){var s=this;return(0,y.A)(function*(){const i=a?yield s._getDataSchemaAttribute(t,a):yield s._getDataSchemaPrimaryAttribute(t);return{isJoin:!0,referenceSchemaName:t,referenceAttributeName:i.name,ownSchemaAttributeName:r,ownSchemaName:e}})()}_createRelationPathItem(e,t){const r=/(?<joinType>.*)\[(?<refSchema>.*?):(?<ownColumn>.*?)(?::(?<refColumn>.*))?]/.exec(t);if(r){const s=r.groups;return this._createRelationPathItemFromJoinPathItem(e,s.refSchema,s.refColumn,s.ownColumn)}return this._createRelationPathItemFromForwardPathItem(e,t)}_getReverseRelationPath(e){const t=[...e],a=[];let r;for(;(r=t.pop())!=null;)a.push({isJoin:!0,ownSchemaName:r.referenceSchemaName,ownSchemaAttributeName:r.referenceAttributeName,referenceSchemaName:r.ownSchemaName,referenceAttributeName:r.ownSchemaAttributeName});return a}_buildRelationPath(e,t){var a=this;return(0,y.A)(function*(){const r=t.split("."),s=[];let i=e;for(const l of r){const d=yield a._createRelationPathItem(i,l);i=d.referenceSchemaName,s.push(d)}return s})()}_getRelationPathToSourceSchema(e,t){const a=[...e],r=a.pop(),s=t.split("."),i={isJoin:!0,ownSchemaName:r.isJoin?r.referenceSchemaName:r.ownSchemaName,ownSchemaAttributeName:r.isJoin?r.referenceAttributeName:r.ownSchemaAttributeName,referenceSchemaName:null,referenceAttributeName:s.pop()};return[...a,...r.isJoin?[r]:[],i]}_buildRelationDataFromPath(e){return e.map(t=>({attributeName:t.ownSchemaAttributeName,referenceAttributeName:t.referenceAttributeName,referenceSchemaName:t.referenceSchemaName}))}_getDataSourceParameterRelationData(e){var t=this;return(0,y.A)(function*(){const a=yield t._buildRelationPath(e.dataSchemaName,e.relationPath),r=t._getRelationPathToSourceSchema(a,e.attributePath),s=t._getReverseRelationPath(r);return t._buildRelationDataFromPath(s)})()}_convertEntityDataSourceParameter(e){var t=this;return(0,y.A)(function*(){if(!e.relationsConfigs||e.relationsConfigs.length===0)return e;const a=[];for(const r of e.relationsConfigs){const s=yield t._getDataSourceParameterRelationData(r);a.push({...r,relationData:s})}return{...e,relationsConfigs:a}})()}convert(e,t=!1){return e.length===0?Promise.resolve([]):t?Promise.resolve(e):Promise.all(e.map(a=>this._convertEntityDataSourceParameter(a)))}}var da=R(29957);class Si{_getExpressionColumnPath(e,t){const a="[{referenceSchemaName}:{referenceAttributeName}:{attributeName}]",r=e.relationData.map(h=>da.String.format(a,h)).join("."),s=e.attributePath.split("."),i=s.length>1?"{ownColumnPath}.{relationString}.{columnPath}":"{relationString}.{columnPath}";s.pop();const d={ownColumnPath:s.join("."),relationString:r,columnPath:t};return da.String.format(i,d)}_updateFilterLeftExpression(e,t){switch(e.expressionType){case n.ExpressionType.SchemaColumn:e.columnPath=this._getExpressionColumnPath(t,e.columnPath);break;case n.ExpressionType.SubQuery:e.columnPath=this._getExpressionColumnPath(t,e.columnPath);break;case n.ExpressionType.Function:e.functionType!==n.FunctionType.Macros&&this._updateFilterLeftExpression(e.functionArgument,t);break}}_updateRelatedFilterGroup(e,t){e instanceof n.FilterGroup?this._updateRelatedFilterGroupInstance(e,t):this._updateRelatedFilterGroupObject(e,t)}_updateRelatedFilterGroupObject(e,t){Object.values(e.items).forEach(a=>{this._updateRelatedFilter(a,t)})}_updateRelatedFilterGroupInstance(e,t){e.filters.forEach(a=>this._updateRelatedFilter(a,t))}_updateRelatedFilter(e,t){if(e.filterType!==n.FilterType.FilterGroup){const a=e.leftExpression;a&&this._updateFilterLeftExpression(a,t)}else this._updateRelatedFilterGroup(e,t)}convertToRelatedFilter(e,t=[]){if(!e)return e;let a;if(e instanceof n.BaseFilter)a=e.clone();else{const r=JSON.stringify(e);a=JSON.parse(r)}return[...t].reverse().forEach(r=>{r.relationData&&r.relationData.length!==0&&this._updateRelatedFilter(a,r)}),a}}class j{constructor(e,t){this._entitySchemaRepository=e,this._broadcastChannelFactory=t,this._dataSchemas=new Map,this._subscribeOnChangesInDesigner()}_subscribeOnChangesInDesigner(){this._broadcastChannelFactory.createInstance(fs).messages$.subscribe(({schemaName:e})=>{this._removeCachedSchema(e)})}_createEntityDataSchema(e){const t=new ua;return t.setEntitySchema(e),(0,c.of)(t.build())}_getEntityDataSchema(e){return this._entitySchemaRepository.getSchemaByName(e).pipe((0,o.switchMap)(t=>this._createEntityDataSchema(t)))}_removeCachedSchema(e){this._dataSchemas.has(e)&&(this._dataSchemas.delete(e),this._entitySchemaRepository.clearSchemaCacheByName(e))}get(e){return this._dataSchemas.has(e)?(0,c.of)(this._dataSchemas.get(e)):this._getEntityDataSchema(e).pipe((0,o.tap)(t=>this._dataSchemas.set(e,t)))}getByEntitySchema(e){const t=e.name;return this._dataSchemas.has(t)?(0,c.of)(this._dataSchemas.get(t)):this._createEntityDataSchema(e).pipe((0,o.tap)(a=>this._dataSchemas.set(t,a)))}static{this.\u0275fac=function(t){return new(t||j)(p.\u0275\u0275inject(m.EntitySchemaRepository),p.\u0275\u0275inject(A.BroadcastChannelFactory))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:j,factory:j.\u0275fac,providedIn:"platform"})}}class Ve{_createPrimaryColumnValueFilter(e,t){const s=(t.relationsConfigs||[])[0]?.dataSchemaName??e;return this._dataSchemaRepository.get(s).pipe((0,c.map)(i=>{const l=new n.ColumnExpression({columnPath:i.primaryAttributeName}),d=new n.ParameterExpression({value:t.value});return new n.CompareFilter(n.ComparisonType.Equal,l,d)}))}_createColumnValueFilter(e){const t=e.value.attributePath,a=e.value.attributeValue,r=new n.ColumnExpression({columnPath:t}),s=new n.ParameterExpression({value:a}),i=new n.CompareFilter(n.ComparisonType.Equal,r,s);return(0,c.of)(i)}_createPrimaryDisplayValueFilter(e,t){const s=(t.relationsConfigs||[])[0]?.dataSchemaName??e;return this._dataSchemaRepository.get(s).pipe((0,c.map)(i=>{const l=new n.ColumnExpression({columnPath:i.primaryDisplayAttributeName}),d=new n.ParameterExpression({value:t.value});return new n.CompareFilter(t.comparisonType,l,d)}))}_createCustomFilter(e){let t={};return e.value&&(t=typeof e.value=="string"?JSON.parse(e.value):e.value),(0,c.of)(t)}_createEmptyParameterFiler(e){const t=e.relationsConfigs||[];if(t.length===0)return(0,c.of)({});const a=t[0];return this._dataSchemaRepository.get(a.dataSchemaName).pipe((0,c.map)(r=>r.primaryAttributeName),(0,c.map)(r=>{const s=new n.ColumnExpression({columnPath:r});return new n.ExistsFilter(s,null)}))}_createEsqFilter(e,t){switch(t.type){case n.ModelParameterType.PrimaryColumnValue:return this._createPrimaryColumnValueFilter(e,t);case n.ModelParameterType.ColumnValue:return this._createColumnValueFilter(t);case n.ModelParameterType.PrimaryDisplayValueFilter:return this._createPrimaryDisplayValueFilter(e,t);case n.ModelParameterType.Filter:return this._createCustomFilter(t);case n.ModelParameterType.Empty:return this._createEmptyParameterFiler(t)}}constructor(e){this._dataSchemaRepository=e}applyParameters(e,t){if(e.length===0)return(0,c.of)(t);const a=e.map(r=>this._createEsqFilter(t.rootSchemaName,r).pipe((0,c.map)(s=>new Si().convertToRelatedFilter(s,r.relationsConfigs))));return(0,c.forkJoin)(a).pipe((0,c.tap)(r=>{r.forEach(s=>{(0,b.isEmpty)(s)||t.filters.add(s)})}),(0,c.map)(()=>t))}convertToEntityDataSourceParameters(e,t=!1){const a=new yi(this._dataSchemaRepository);return(0,c.from)(a.convert(e,t))}static{this.\u0275fac=function(t){return new(t||Ve)(p.\u0275\u0275inject(j))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Ve,factory:Ve.\u0275fac,providedIn:"root"})}}const ha=new p.InjectionToken("A factory of data schema to data source attribute converter"),ma=new p.InjectionToken("A factory of entity schema column appender");class X{constructor(e,t,a){this.entitySchemaQueryUtils=e,this._entitySchemaColumnAppenderFactory=t,this._dataSchemaToDataSourceAttributeConverter=a}_addPagingToEsq(e,t){t&&(e.rowsOffset=t.rowsOffset,e.rowCount=t.rowCount)}_addSortingToEsq(e,t){t&&t.columns.forEach((a,r)=>{const s=e.findColumn(a.columnName),i=(0,m.toOrderDirection)(a.direction);s?s.withOrdering(i,r):e.addSchemaColumn(a.columnName).withOrdering(i,r)})}_addIsDistinctToEsq(e,t){t&&(e.isDistinct=!0)}_addColumnToEsq(e,t){t.filter(Boolean).forEach(a=>{this._entitySchemaColumnAppenderFactory.create(a).addColumn(e,a)})}_prepareAttributePairsForLoad(e,t){return t.map(a=>{if(typeof a=="string"){const r=a,s=e.attributes.find(i=>i.name===r);return s?this._dataSchemaToDataSourceAttributeConverter.create(s.attributeType).convert(s):{name:r,path:r}}else return a})}build(e,t,a,r){if(a.some(s=>s.type===n.ModelParameterType.Never))throw new Error('Failed to build entity schema query: parameters contains "Never" model parameter.');return(0,c.forkJoin)([this.entitySchemaQueryUtils.convertToEntityDataSourceParameters(a),(0,c.of)(this._prepareAttributePairsForLoad(e,t))]).pipe((0,c.map)(([s,i])=>({esq:new n.EntitySchemaQuery(e.name),esqParameters:s,dataSourceAttributes:i})),(0,c.tap)(({esq:s,dataSourceAttributes:i})=>this._addColumnToEsq(s,i)),(0,c.tap)(({esq:s})=>this._addSortingToEsq(s,r?.sortingConfig)),(0,c.tap)(({esq:s})=>this._addPagingToEsq(s,r?.pagingConfig)),(0,c.tap)(({esq:s})=>this._addIsDistinctToEsq(s,r?.isDistinct)),(0,c.switchMap)(({esq:s,esqParameters:i})=>this.entitySchemaQueryUtils.applyParameters(i,s)))}static{this.\u0275fac=function(t){return new(t||X)(p.\u0275\u0275inject(Ve),p.\u0275\u0275inject(ma),p.\u0275\u0275inject(ha))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:X,factory:X.\u0275fac,providedIn:"root"})}}const Dt=u=>{switch(u){case n.DataValueType.Guid:return n.DataValueType.Guid;case n.DataValueType.Text:case n.DataValueType.SHORT_TEXT:case n.DataValueType.PHONE_TEXT:case n.DataValueType.WEB_TEXT:case n.DataValueType.EMAIL_TEXT:case n.DataValueType.MEDIUM_TEXT:case n.DataValueType.MAXSIZE_TEXT:case n.DataValueType.LONG_TEXT:case n.DataValueType.HASH_TEXT:case n.DataValueType.SECURE_TEXT:case n.DataValueType.RICH_TEXT:return n.DataValueType.Text;case n.DataValueType.Integer:case n.DataValueType.Enum:return n.DataValueType.Integer;case n.DataValueType.Float:case n.DataValueType.FLOAT1:case n.DataValueType.FLOAT2:case n.DataValueType.FLOAT3:case n.DataValueType.FLOAT4:case n.DataValueType.FLOAT8:case n.DataValueType.Money:return n.DataValueType.Float;case n.DataValueType.DateTime:case n.DataValueType.Date:case n.DataValueType.Time:return n.DataValueType.DateTime;case n.DataValueType.Lookup:case n.DataValueType.IMAGELOOKUP:return n.DataValueType.Lookup;case n.DataValueType.Boolean:return n.DataValueType.Boolean;case n.DataValueType.Blob:return n.DataValueType.Blob;case n.DataValueType.Image:return n.DataValueType.Image;case n.DataValueType.Color:return n.DataValueType.Color;default:throw new Error(`Type ${u} not implemented`)}};function Mi(u,e=null,t=n.DataValueType.Float){if(!u||u.length===0)return e;if(u.length===1)return u[0];let a=u.map(r=>Dt(r)).map(r=>m.DataValueTypeGroup.Number.includes(r)?t:r);return a=[...new Set(a)],a.length===1?a[0]:e}class Te extends Rt{get isForceUpdateUnchangedData(){return!!this.initialConfig?.isForceUpdateUnchangedData}constructor(e,t){super(e,t),this.dataSourceName=e,this.injector=t,this._affectedAttributes=[],this._errorReferenceAttributes=[],this.type=m.EntityDataSourceTypeName,this._featureValues=t.get(m.FEATURE_VALUES),this._queryExecutor=t.get(Ts.QueryExecutor),this._entitySchemaService=t.get(m.EntitySchemaService),this._httpClient=this.injector.get(mi.HttpClient),this._rightsService=this.injector.get(gi.RightsService),this.dataSchemaRepository=this.injector.get(j),this._entitySchemaRepository=this.injector.get(m.EntitySchemaRepository),this._entitySchemaQueryBuilder=this.injector.get(X),this._entitySchemaQueryUtils=this.injector.get(Ve),this._window=this.injector.get(A.WINDOW_TOKEN),this._measurePerformanceService=this.injector.get(m.MeasurePerformanceService);const a=this.injector.get(m.UserInfo);this._entityDefaultValuesUrl=a.isSSP?"/ssp/rest/EntitySchemaService/GetEntityDefaultValues":"/rest/EntitySchemaService/GetEntityDefaultValues"}_buildSelectEsq(e,t,a){return this.getSchema().pipe((0,o.switchMap)(r=>this._entitySchemaQueryBuilder.build(r,e,t,a)),(0,o.map)(r=>(this._featureValues["DataSource-DisableRecordDeactivation"]!==!0&&(r.useRecordDeactivation=this.initialConfig.useRecordDeactivation),r.adminUnitRoleSources=this._getEsqAdminUnitRoleSources(),r)))}_getEsqAdminUnitRoleSources(){let e;const t=this.initialConfig.adminUnitRoleSources;return(0,b.isNumber)(t)?t:((0,b.isArray)(t)&&t.forEach(a=>{const r=pi.eAdminUnitRoleSources[a];(0,b.isNumber)(r)&&(e=e|r)}),e)}_normalizeValue(e,t){switch(t){case n.DataValueType.Lookup:return e||null;case n.DataValueType.Date:case n.DataValueType.Time:case n.DataValueType.DateTime:return e instanceof Date?(0,n.encodeDate)(e):typeof e=="string"&&Date.parse(e)>0?`"${e}"`:e;default:return e}}_buildUpdateEsq(e,t){return this._entitySchemaQueryUtils.convertToEntityDataSourceParameters(e,!0).pipe((0,o.map)(a=>({updateQuery:new n.UpdateQuery(this._entitySchemaName),esqParameters:a})),(0,o.tap)(({updateQuery:a})=>{a.isForceUpdate=!!this.initialConfig.isForceUpdate,Object.keys(t).forEach(r=>{const s=this._findEntitySchemaColumn(r);if(!s)throw new Error(`Column ${r} not found`);const i=t[r];this._isEntityColumnValue(i)&&a.addColumn(s.name,this._normalizeValue(i,s.dataValueType),Dt(s.dataValueType))})}),(0,o.switchMap)(({updateQuery:a,esqParameters:r})=>this._entitySchemaQueryUtils.applyParameters(r,a)),(0,o.catchError)(a=>(0,c.throwError)(()=>a)))}_buildInsertEsq(e){const t=new n.InsertQuery(this._entitySchemaName);return Object.keys(e).forEach(a=>{const r=this._findEntitySchemaColumn(a);if(!r)throw new Error(`Column ${a} not found`);const s=e[a];this._isEntityColumnValue(s)&&t.addColumn(r.name,this._normalizeValue(s,r.dataValueType),Dt(r.dataValueType))}),t}_buildDeleteEsq(e){return this._entitySchemaQueryUtils.convertToEntityDataSourceParameters(e,!0).pipe((0,o.switchMap)(t=>{const a=new n.DeleteQuery(this._entitySchemaName);return this._entitySchemaQueryUtils.applyParameters(t,a)}))}_checkOwnAttributes(e){return this.getSchema().pipe((0,o.switchMap)(t=>{const a=t.attributes.filter(r=>r.attributeType!==n.DataSchemaAttributeType.OwnAttribute).filter(r=>!(0,b.isUndefined)(e[r.name]));return a.length!==0?(0,c.throwError)(()=>new Error(`Not valid attributes for this data source: ${a.map(r=>r.name).join(",")}`)):(0,c.of)(null)}))}_findEntitySchemaColumn(e){return this._entitySchema.columns.find(t=>t.name===e)}_isEntityColumnValue(e){const t=a=>typeof a=="object"&&(a===null||"value"in a);return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="bigint"||e instanceof Date||t(e)}_parseDefaultValues(e,t){const a=new Map(e.attributes.map(r=>[r.name,r.dataValueType]));return t.reduce((r,s)=>{const{defaultValue:i,name:l}=s;if((0,b.isNil)(i.value))return r;if(i.displayValue)return{...r,[l]:i};const d=(0,m.parseJsonValue)(i.value,a.get(l));return{...r,[l]:d}},{})}_getDefaultValues(e){const t=`${this._entityDefaultValuesUrl}?entityName=${e}`;return this._httpClient.get(t).pipe((0,o.catchError)(a=>this._catchErrorResponse(a)),(0,o.map)(a=>a.GetEntityDefaultValuesResult),(0,o.mergeMap)(a=>this.getSchema().pipe((0,o.tap)(r=>{let s=this._window.defaultValueStorage;const i=a?.find(l=>l.name===r.primaryAttributeName)?.defaultValue?.value;if(s=s||{},i){const l=`${e}_${i}`;s[l]=a,this._window.defaultValueStorage=s}}),(0,o.map)(r=>this._parseDefaultValues(r,a)))))}_catchErrorResponse(e){return console.log(e),(0,c.of)({GetEntityDefaultValuesResult:[]})}_requestEntitySchemaColumnsInfo(e){const t=e.map(a=>a.attributePath);return this._entitySchemaService.getEntitySchemaColumnsInformationByPathsArray(this._entitySchema.uId,t).pipe((0,o.map)(a=>e.map(r=>({column:a[r.attributePath],config:r}))))}_getEntitySchemaForwardReferenceColumnsInfo(e){const t={name:this._entitySchemaName,loadLookupColumns:!1,forwardReferencePaths:e.map(a=>a.attributePath)};return this._entitySchemaRepository.getSchemes([t]).pipe((0,o.map)(()=>e.map(a=>{const r=a.attributePath.split("."),s=this._entitySchemaRepository.findEntitySchemaColumnByPath(this._entitySchemaName,r);return{column:new m.EntitySchemaColumn(s),config:a}})))}_createReferenceAttributes(e,t){return t.length===0?(0,c.of)(e):(0,c.of)(this._featureValues["DataSource-DontUseOneRequestForEntitySchemes"]).pipe((0,o.switchMap)(a=>a?this._requestEntitySchemaColumnsInfo(t):this._getEntitySchemaForwardReferenceColumnsInfo(t))).pipe((0,o.tap)(a=>{a.forEach(({column:r,config:s})=>{s.attributeType===n.DataSchemaAttributeType.AggregationAttribute&&s.aggregationConfig?.aggregationFunction===n.AggregationFunction.Count&&(r.dataValueType=n.DataValueType.Integer),e.addAttribute(r,s)})}),(0,o.map)(()=>e))}_createAttributesFromInitialConfig(e,t={}){const a=[];return Object.entries(t).forEach(([r,s])=>{const i=s;i.type===n.DataSchemaAttributeType.ForwardReferenceAttribute&&a.push({attributeName:r,attributeType:n.DataSchemaAttributeType.ForwardReferenceAttribute,attributePath:i.path}),i.type===n.DataSchemaAttributeType.AggregationAttribute&&a.push({attributeName:r,attributeType:n.DataSchemaAttributeType.AggregationAttribute,attributePath:i.path,aggregationConfig:i.aggregationConfig}),i.type===n.DataSchemaAttributeType.FunctionAttribute&&a.push({attributeName:r,attributeType:n.DataSchemaAttributeType.FunctionAttribute,attributePath:i.path,functionConfig:i.functionConfig})}),this._createReferenceAttributes(e,a).pipe((0,o.catchError)(r=>{const s=r.message&&r.toString(),i=new Ns(this,s);return this._errors.push(i),a.forEach(l=>{this._errorReferenceAttributes.push(l)}),(0,c.of)(e)}))}_shouldSkipLoad(e){return e.some(t=>t.type===n.ModelParameterType.Never)}_setValidValuesForLookupAttributes(e,t){return Object.keys(t).forEach(a=>{const r=e.attributes.find(s=>s.name===a);r&&(r.dataValueType===n.DataValueType.Lookup||r.dataValueType===n.DataValueType.IMAGELOOKUP)&&t[a]===""&&(t[a]=null)}),t}_throwErrorResponse(e){const t=typeof e=="string"?e:e?.message;return(0,c.throwError)(()=>({success:!1,rowsAffected:0,errorInfo:t}))}_mapOperationResult(e){return{success:e.success,rowsAffected:e.rowsAffected}}get affectedAttributes(){return[...this._affectedAttributes]}get isAggregate(){return this.dataSchema?this.dataSchema.attributes.some(t=>t.isAggregate):!1}_getIsAffectedAttributeStored(e){return this._affectedAttributes.some(t=>t.path===e.path&&t.schemaName===e.schemaName)}_collectUsedAttributes(e){let t=e._getUsedColumns();t=t.filter(a=>!this._getIsAffectedAttributeStored(a)),this._affectedAttributes.push(...t)}_findErrorReferenceAttribute(e){const t=typeof e=="string"?e:e.name;return this._errorReferenceAttributes.find(a=>a.attributeName===t)}innerLoad(e,t,a){if(this.hasErrors){if(this.hasCriticalErrors)return(0,c.throwError)(()=>this.getLastError());if(e.length!==0&&e.every(s=>this._findErrorReferenceAttribute(s)!=null))return(0,c.throwError)(()=>this.getLastError())}return this._shouldSkipLoad(t)?(0,c.of)([]):this._buildSelectEsq(e,t,a||{}).pipe((0,o.tap)(r=>this._collectUsedAttributes(r)),(0,o.switchMap)(r=>this._queryExecutor.executeSelectQuery(r,{throttled:a?.throttled}).pipe(this._measurePerformanceService.measure$(`EntityDataSource.load.executeSelectQuery.${this.dataSourceName}`),(0,o.catchError)(()=>(0,c.throwError)(()=>{const s=this.injector.get(_e.TranslateService);return new Error(s.instant("BaseViewModel.LoadingModelErrorMessage"))})))),(0,o.map)(r=>r),(0,o.mergeMap)(r=>this.getSchema().pipe((0,o.map)(s=>(s.attributes&&r.forEach(i=>{this._setValidValuesForLookupAttributes(s,i)}),r)))))}innerSave(e,t){return this.hasCriticalErrors?(0,c.throwError)(()=>this.getLastError()):this._checkOwnAttributes(t).pipe((0,o.switchMap)(()=>this._buildUpdateEsq(e,t)),(0,o.switchMap)(a=>this._queryExecutor.executeUpdateQuery(a)),(0,o.map)(a=>this._mapOperationResult(a)),(0,o.catchError)(a=>this._throwErrorResponse(a)))}innerInsert(e){return this.hasCriticalErrors?(0,c.throwError)(()=>this.getLastError()):this._checkOwnAttributes(e).pipe((0,o.map)(()=>this._buildInsertEsq(e)),(0,o.switchMap)(t=>(0,c.forkJoin)({response:this._queryExecutor.executeInsertQuery(t),dataSchema:this.getSchema()})),(0,o.map)(({response:t,dataSchema:a})=>({...this._mapOperationResult(t),primaryAttributes:[{[a.primaryAttributeName]:t.id}]})),(0,o.catchError)(t=>this._throwErrorResponse(t)))}innerDelete(e){return this.hasCriticalErrors?(0,c.throwError)(()=>this.getLastError()):this._buildDeleteEsq(e).pipe((0,o.switchMap)(t=>this._queryExecutor.executeDeleteQuery(t)),(0,o.map)(t=>this._mapOperationResult(t)),(0,o.catchError)(t=>this._throwErrorResponse(t)))}innerGetSchema(){return this.hasCriticalErrors?(0,c.throwError)(()=>this.getLastError()):this.dataSchemaRepository.get(this._entitySchemaName).pipe((0,o.map)(e=>new ua(e)),(0,o.switchMap)(e=>this._createAttributesFromInitialConfig(e,this.initialConfig.attributes)),(0,o.tap)(e=>{const t=this._getDefaultValues(this._entitySchemaName).pipe((0,o.shareReplay)({bufferSize:1,refCount:!0}));e.setAttributesDefaultValue(t)}),(0,o.map)(e=>e.build()))}innerGetLookupDataSchema(e){if(this.hasCriticalErrors)return(0,c.throwError)(()=>this.getLastError());const a=e.split(".")[0],r=this._findEntitySchemaColumn(a);return r?r.dataValueType!==n.DataValueType.Lookup?(0,c.throwError)(()=>new Error(`DataValueType for column '${a}' isn't lookup`)):r.referenceSchemaName?this.dataSchemaRepository.get(r.referenceSchemaName):(0,c.throwError)(()=>new Error(`referenceSchemaName for column '${a}' is absent`)):(0,c.throwError)(()=>new Error(`Can't find column with name '${a}'`))}innerGetDefaultValues(){return this.hasCriticalErrors?(0,c.throwError)(()=>this.getLastError()):this._getDefaultValues(this._entitySchemaName)}innerCanDelete(e){return this.hasCriticalErrors?(0,c.of)({result:!1}):this._rightsService.getCanDelete({schemaName:this.initialConfig.entitySchemaName,primaryColumnValue:e.primaryColumnValue})}innerCanCreate(e){if(this.hasCriticalErrors)return(0,c.of)({result:!1});const t={isNew:!0,schemaName:this.initialConfig.entitySchemaName};return this._rightsService.getCanEdit(t)}innerCanEdit(e){if(this.hasCriticalErrors)return(0,c.of)({result:!1});const t={primaryColumnValue:e.primaryColumnValue,isNew:!1,schemaName:this.initialConfig.entitySchemaName};return this._rightsService.getCanEdit(t)}getEmptySchema(){return this._entitySchemaName?new B({name:this._entitySchemaName}):super.getEmptySchema()}init(e,t){return super.init(e,t).pipe((0,o.mergeMap)(a=>{if(!this.initialConfig.entitySchemaName){const r=new _i(this);return this._errors.push(r),(0,c.throwError)(()=>r)}return(0,c.of)(a)}),(0,o.tap)(()=>this._entitySchemaName=this.initialConfig.entitySchemaName),(0,o.mergeMap)(a=>this._entitySchemaRepository.getSchemaByName(this.initialConfig.entitySchemaName).pipe((0,o.tap)(r=>this._entitySchema=r),(0,o.catchError)(()=>{this._entitySchema=new m.EntitySchema,this._entitySchema.name=this._entitySchemaName,this._entitySchema.columns=[];const r=new fi(this,this._entitySchemaName);return this._errors.push(r),(0,c.throwError)(()=>r)}),(0,o.map)(()=>a))))}getOwnLoadParameters(){return this.initialConfig?.loadParameters}getAllowCopyingRecords(){return this.initialConfig?.allowCopyingRecords}}class vt{convert(e){const{name:t,path:a,caption:r,dataValueType:s}=e||{};return{name:t,path:a||t,caption:r,dataValueType:s}}}class ee extends vt{convert(e){const{aggregationConfig:t}=e||{};return{...super.convert(e),type:"aggregation",aggregationConfig:{filter:t?.filter,aggregationFunction:t?.aggregationFunction,sortByColumn:t?.sortByColumn,sortByDirection:t?.sortByDirection}}}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(ee)))(a||ee)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:ee,factory:ee.\u0275fac,providedIn:"root"})}}class te extends vt{convert(e){return{...super.convert(e),type:"default"}}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(te)))(a||te)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:te,factory:te.\u0275fac,providedIn:"root"})}}class ae extends vt{convert(e){const{functionConfig:t}=e||{};return{...super.convert(e),type:"function",functionConfig:t}}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(ae)))(a||ae)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:ae,factory:ae.\u0275fac,providedIn:"root"})}}const Is="PrimaryValue",ws="DisplayValue";class Ne{constructor(e){this._queryExecutor=e}_getInFilter(e){const t=new n.MacrosFunctionExpression({macrosType:n.QueryMacrosType.PrimaryColumn});return new n.InFilter(n.ComparisonType.Equal,t,e.map(a=>new n.ParameterExpression({value:a})))}_getEsq(e,t){const a=new n.EntitySchemaQuery(e);a.addMacrosFunctionColumn(n.QueryMacrosType.PrimaryColumn,Is),a.addMacrosFunctionColumn(n.QueryMacrosType.PrimaryDisplayColumn,ws);const r=this._getInFilter(t);return a.filters.add(r),a}_getSchemaLookupData(e,t){const a={};for(let r=0;r<t.length;r++){const s=t[r],[i,l]=e[r];a[i]={};for(const d of l){const h=s.find(f=>f[Is]===d);a[i][d]=h?h[ws]:null}}return a}load(e){const t=Object.entries(e),a=t.map(([r,s])=>this._getEsq(r,s));return this._queryExecutor.executeBatchSelectQuery(a).pipe((0,o.map)(r=>this._getSchemaLookupData(t,r)))}static{this.\u0275fac=function(t){return new(t||Ne)(p.\u0275\u0275inject(Ts.QueryExecutor))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Ne,factory:Ne.\u0275fac,providedIn:"root"})}}class Ie{constructor(e){this._intentStatuses=Cs,this._intentModes=bs,this._columnLookupValuesService=e.get(m.ColumnLookupValuesService)}convertToDataSourceModel(e){return(0,c.combineLatest)([this._columnLookupValuesService.getColumnLookupValues(As),this._columnLookupValuesService.getColumnLookupValues(Ss),Rs()]).pipe((0,c.map)(([t,a,r])=>{const s=this._intentStatuses.get(e.Status),i=t.find(f=>f.value===s),l=this._intentModes.get(e.Mode)??this._intentModes.get(Ms.Chat),d=a.find(f=>f.value===l),h=r.find(f=>f.displayValue===e.Type);return{Id:e.UId,Code:e.Code,Description:e.Description,Prompt:e.Prompt,Type:h,Name:e.Title,Status:i,PackageUId:e.PackageUId,Mode:d}}))}convertToModel(e){const t={};return Object.entries(e).forEach(([a,r])=>{a==="Name"&&(a="Title"),a==="Id"&&(a="UId"),a==="Status"&&(r=[...this._intentStatuses].filter(([,s])=>s===e.Status.value).map(([s])=>s).shift()),a==="Mode"&&(r=[...this._intentModes].filter(([,s])=>s===e.Mode.value).map(([s])=>s).shift()),a==="Type"&&(r=Object.values(ra).filter(s=>s.value===e.Type.value).map(s=>s.displayValue).shift()),t[a]=r}),t}static{this.\u0275fac=function(t){return new(t||Ie)(p.\u0275\u0275inject(p.Injector))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Ie,factory:Ie.\u0275fac,providedIn:"root"})}}class we{convertToDataSourceModel(e){return(0,c.of)({Id:e.UId,Intent:e.Intent,Code:e.Code,Name:e.Name,Description:e.Description,SourceCollection:e.SourceCollection,DataValueTypeUId:e.DataValueTypeUId})}convertToModel(e){const t={};return Object.entries(e).forEach(([a,r])=>{a==="Id"&&(a="UId"),t[a]=r}),t}static{this.\u0275fac=function(t){return new(t||we)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:we,factory:we.\u0275fac,providedIn:"root"})}}const xs=A.FactoryProvider.create({token:ha,mappings:[{predicate:n.DataSchemaAttributeType.AggregationAttribute,injectable:ee},{predicate:n.DataSchemaAttributeType.FunctionAttribute,injectable:ae}],default:{injectable:te}}),qs=A.FactoryProvider.create({token:ma,mappings:[{predicate:u=>u.type==="aggregation",injectable:De},{predicate:u=>u.type==="function"&&u.functionConfig?.type==="aggregation",injectable:Pe},{predicate:u=>u.type==="function"&&u.functionConfig?.type==="datePart",injectable:Ee}],default:{injectable:ve}});var pa=R(95868);class Ls extends Te{constructor(e,t){super(e,t),this.dataSourceName=e,this.injector=t,this.type="crt.CopilotActionDataSource",this._intentManager=this.injector.get(pa.CopilotIntentManagerService)}_getActionUId(e){return e.filter(a=>a.type===n.ModelParameterType.PrimaryColumnValue)[0]?.value}innerDelete(e){return(0,c.of)(void 0)}innerInsert(e){const t=e;return(0,c.forkJoin)([this._intentManager.createAction(t),this.getSchema()]).pipe((0,c.map)(([a,r])=>({success:a.success,rowsAffected:1,errorInfo:a.errorInfo?.message,primaryAttributes:a.success?[{[r.primaryAttributeName]:t.Id}]:null})))}innerLoad(e,t,a){const r=this._getActionUId(t);return r?this._intentManager.getActionByUId(r).pipe((0,c.map)(s=>[s])):(0,c.of)([])}innerSave(e,t){const a=this._getActionUId(e),r=t;return r.Id=a,this._intentManager.updateAction(r).pipe((0,c.map)(s=>({success:s.success,rowsAffected:1,errorInfo:s.errorInfo?.message})))}}class Fs extends Te{constructor(e,t){super(e,t),this.dataSourceName=e,this.injector=t,this.type="crt.CopilotIntentDataSource",this._intentManager=this.injector.get(pa.CopilotIntentManagerService),this._copilotIntentDataSourceModelConvertor=this.injector.get(Ie)}innerGetDefaultValues(){return this._copilotIntentDataSourceModelConvertor.convertToDataSourceModel({UId:(0,n.generateGuid)(),Status:"InDevelopment",Mode:"Chat",Type:"Skill"})}innerInsert(e){const t=this._copilotIntentDataSourceModelConvertor.convertToModel({...e});return(0,c.forkJoin)([this._intentManager.createIntent(t),this.getSchema()]).pipe((0,c.map)(([a,r])=>({success:a.success,rowsAffected:a.success?1:0,errorInfo:a.errorInfo?.message,primaryAttributes:[{[r.primaryAttributeName]:a.schemaUid}]})),(0,o.switchMap)(a=>a.success?(0,c.of)(a):(0,c.throwError)(()=>a)))}innerLoad(e,t,a){const r=t.filter(s=>s.type===n.ModelParameterType.PrimaryColumnValue);if(r.length)return this._intentManager.getIntent(r[0].value).pipe((0,o.switchMap)(s=>this._copilotIntentDataSourceModelConvertor.convertToDataSourceModel(s).pipe((0,c.map)(i=>[i]))))}innerSave(e,t){const r=e.filter(i=>i.type===n.ModelParameterType.PrimaryColumnValue)[0].value,s=this._copilotIntentDataSourceModelConvertor.convertToModel({...t});return s.UId=r,this._intentManager.updateIntent(s).pipe((0,c.map)(i=>({success:i.success,rowsAffected:i.success?1:0,errorInfo:i.errorInfo?.message})),(0,o.switchMap)(i=>i.success?(0,c.of)(i):(0,c.throwError)(()=>i)))}}class Os extends Te{constructor(e,t){super(e,t),this.dataSourceName=e,this.injector=t,this.type="crt.CopilotIntentParameterDataSource",this._intentManager=this.injector.get(pa.CopilotIntentManagerService),this._modelConvertor=this.injector.get(we)}_getPrimaryColumnParameter(e){return e.find(t=>t.type===n.ModelParameterType.PrimaryColumnValue&&(0,n.isGuid)(t.value))}_getIsIntentUIdParameter(e){return(e.relationsConfigs??[]).some(t=>t.dataSchemaName==="CopilotIntent"&&t.attributePath==="Intent")}_getSourceCollectionFilterValue(e){const t=e.find(s=>s.type===n.ModelParameterType.Filter);if(!t?.value)return null;const a=n.FilterParser.fromJson(t.value);let r;return a.filters.forEach(s=>{s instanceof n.CompareFilter&&s.leftExpression instanceof n.ColumnExpression&&s.leftExpression.columnPath==="SourceCollection"&&s.rightExpression instanceof n.ParameterExpression&&(r=s.rightExpression.value)}),r}innerGetDefaultValues(){return this._modelConvertor.convertToDataSourceModel({UId:(0,n.generateGuid)()})}innerInsert(e){const t=this._modelConvertor.convertToModel({...e});return this._intentManager.createIntentParameter(t).pipe((0,c.map)(a=>({success:a.success,rowsAffected:a.success?1:0,errorInfo:a.errorInfo?.message,primaryAttributes:[{Id:t.UId}]})),(0,c.switchMap)(a=>a.success?(0,c.of)(a):(0,c.throwError)(()=>a)))}innerLoad(e,t,a){const r=this._getPrimaryColumnParameter(t),s=this._getSourceCollectionFilterValue(t)??"InputParameters";return r?(this._getIsIntentUIdParameter(r)?this._intentManager.getIntentParameters(r.value,s):this._intentManager.getIntentParameter(r.value).pipe((0,c.map)(l=>[l]))).pipe((0,c.mergeMap)(l=>(0,c.from)(l).pipe((0,c.mergeMap)(d=>this._modelConvertor.convertToDataSourceModel(d)),(0,c.toArray)())),(0,c.catchError)(()=>(0,c.of)([]))):(0,c.of)([])}innerSave(e,t){const a=this._getPrimaryColumnParameter(e)?.value,r=this._modelConvertor.convertToModel({...t});return r.UId=a,this._intentManager.updateIntentParameter(r).pipe((0,c.map)(s=>({success:s.success,rowsAffected:s.success?1:0,errorInfo:s.errorInfo?.message})),(0,c.switchMap)(s=>s.success?(0,c.of)(s):(0,c.throwError)(()=>s)))}innerDelete(e){const t=this._getPrimaryColumnParameter(e)?.value;return this._intentManager.deleteIntentParameter(t).pipe((0,c.map)(a=>({success:a.success,rowsAffected:a.success?1:0,errorInfo:a.errorInfo?.message})),(0,c.switchMap)(a=>a.success?(0,c.of)(a):(0,c.throwError)(()=>a)))}}class bi extends Te{innerDelete(e){return(0,c.of)(null)}innerInsert(e){return(0,c.of)(null)}innerLoad(e,t){return(0,c.of)([])}innerSave(e,t){return(0,c.of)(null)}innerGetLookupDataSchema(e){return(0,c.of)(null)}innerGetDefaultValues(){return(0,c.of)(null)}innerCanDelete(e){return(0,c.of)(null)}innerCanEdit(e){return(0,c.of)(null)}innerCanCreate(e){return(0,c.of)(null)}}const ga=window;class re{constructor(){this._event$=new c.Subject}static get instance(){return ga.__modelEventNotificationService||(ga.__modelEventNotificationService=new re),ga.__modelEventNotificationService}get event$(){return this._event$.asObservable()}notify(e){this._event$.next(e)}}class xe{constructor(){this.changedValues$=new c.Subject,this._valuesStore={}}setValues(e){if(e){const t={};Object.entries(e).forEach(([a,r])=>{const s=this._valuesStore[a]!==r;this._valuesStore[a]=(0,b.cloneDeep)(r),s&&(t[a]=this._valuesStore[a])}),(0,b.isEmpty)(t)||this.changedValues$.next(t)}}get values(){return this._valuesStore}static{this.\u0275fac=function(t){return new(t||xe)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:xe,factory:xe.\u0275fac})}}class ks extends Rt{constructor(e,t){super(e,t),this.dataSourceName=e,this._injector=t,this.type=m.PAGE_PARAMETERS_DATA_SOURCE_TYPE_NAME,this._schemaParametersStore=this._injector.get(xe),this._lookupDataLoadService=this._injector.get(Ne),this._featureValues=this._injector.get(m.FEATURE_VALUES),this._featureValues.DisableCommunicationBetweenSchemas||this._subscribeParametersChanged()}_subscribeParametersChanged(){this._schemaParametersStore.changedValues$.subscribe(e=>{re.instance.notify({modelId:(0,n.generateGuid)(),dataSchemaName:this.dataSchema.name,type:V.Update,payload:{primaryAttributesValues:null,changedAttributes:Object.keys(e)}})})}_getCanSuccessfullyExecuteOperationResult(){return(0,c.of)({result:!0})}_fillLookupValues(e,t,a){Object.entries(a).forEach(([r,s])=>{(t[r]||[]).forEach(l=>{e[l]={value:r,displayValue:s}})})}_fillSchemaParameterValueNameMap(e,t,a,r){const s=r;let i=e[t];i||(i={},e[t]=i);let l=i[s];l||(l=[],i[s]=l),l.push(a)}_fillSchemaNamePrimaryValuesMap(e,t,a){const r=a;let s=e[t];s||(s=[],e[t]=s),s.push(r)}_isLookupValue(e){return!!e?.value}_shouldFillSchemaLookupValueMaps(e,t){return e&&t&&t.referenceSchemaName&&!this._isLookupValue(e)}_load(e,t){const a={},r=this._schemaParametersStore.values,s=t.attributes,i={},l={};for(const h of e){const f=r[h],_=s.find(S=>S.name===h);if(this._shouldFillSchemaLookupValueMaps(f,_)){this._fillSchemaNamePrimaryValuesMap(l,_.referenceSchemaName,f),this._fillSchemaParameterValueNameMap(i,_.referenceSchemaName,h,f);continue}a[h]=f??null}return Object.keys(l).length===0?(0,c.of)([a]):this._lookupDataLoadService.load(l).pipe((0,c.map)(h=>{for(const[f,_]of Object.entries(h)){const S=i[f];this._fillLookupValues(a,S,_)}return[a]}))}_getValuesForStore(e){const t={};return Object.entries(e).forEach(([a,r])=>{const s=this.initialConfig.parameters[a];if(!s)return;(0,m.getDataValueTypeByName)(s.dataValueTypeName)===n.DataValueType.Lookup?t[a]=r?.value:t[a]=r}),t}innerLoad(e,t,a){return this.getSchema().pipe((0,c.switchMap)(r=>this._load(e,r)))}innerSave(e,t){const a=this._getValuesForStore(t);return this._schemaParametersStore.setValues(a),(0,c.of)({success:!0,rowsAffected:1})}innerInsert(e){const t=this._getValuesForStore(e);return this._schemaParametersStore.setValues(t),(0,c.of)({success:!0,rowsAffected:1,primaryAttributes:[]})}innerDelete(e){return(0,c.of)({success:!0,rowsAffected:1})}innerGetSchema(){const e=[],t=this.initialConfig.parameters;return t&&Object.entries(t).forEach(([a,r])=>{const s=new Re({name:a,caption:r.caption,dataValueType:(0,m.getDataValueTypeByName)(r.dataValueTypeName),attributeType:n.DataSchemaAttributeType.OwnAttribute,path:a,isRequired:!!r.isRequired,referenceSchemaName:r.referenceSchemaName,isMasked:!1,isFormatValidated:!0});s.addDefaultValidators(),e.push(s)}),(0,c.of)(new B({name:this.initialConfig.schemaName,type:n.DataSchemaType.ClientUnit,attributes:e}))}innerGetLookupDataSchema(e){return(0,c.of)(null)}innerGetDefaultValues(){return(0,c.of)({})}innerCanEdit(e){return this._getCanSuccessfullyExecuteOperationResult()}innerCanDelete(e){return this._getCanSuccessfullyExecuteOperationResult()}innerCanCreate(e){return this._getCanSuccessfullyExecuteOperationResult()}}class Bs extends Rt{constructor(){super(...arguments),this.type="crt.WebServiceDataSource"}innerLoad(e,t,a){throw new Error("Method not implemented.")}innerSave(e,t){throw new Error("Method not implemented.")}innerInsert(e){throw new Error("Method not implemented.")}innerDelete(e){throw new Error("Method not implemented.")}innerGetSchema(){throw new Error("Method not implemented.")}innerGetLookupDataSchema(e){throw new Error("Method not implemented.")}innerGetDefaultValues(){throw new Error("Method not implemented.")}innerCanDelete(e){throw new Error("Method not implemented.")}innerCanEdit(e){throw new Error("Method not implemented.")}innerCanCreate(e){throw new Error("Method not implemented.")}}class se{resolve(e){let t=null;switch(e){case m.EntityDataSourceTypeName:t=Te;break;case m.PAGE_PARAMETERS_DATA_SOURCE_TYPE_NAME:t=ks;break;case"crt.WebServiceDataSource":t=Bs;break;case"crt.CopilotIntentDataSource":t=Fs;break;case"crt.CopilotIntentParameterDataSource":t=Os;break;case"crt.CopilotActionDataSource":t=Ls;break;case"crt.DashboardDataSource":t=bi;break}return(0,c.of)(t)}static{this.\u0275fac=function(t){return new(t||se)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:se,factory:se.\u0275fac})}}class O{constructor(e,t){this.injector=e,this.resolver=t}create(e,t,a){const{type:r,scope:s,config:i}=t;return this.resolver.resolve(r).pipe((0,o.switchMap)(d=>d?new d(e,a||this.injector).init(i,s):(0,c.throwError)(()=>new Error(`Data source type '${r}' not supported.`))),(0,o.catchError)(d=>d instanceof Ct?(0,c.of)(d.dataSource):(0,c.throwError)(()=>d)))}static{this.\u0275fac=function(t){return new(t||O)(p.\u0275\u0275inject(p.Injector),p.\u0275\u0275inject(se))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac})}}class fa{}class ie extends fa{processRequest(e,t){return(0,y.A)(function*(){const{model:a,payload:r}=t??{},s={...e,model:a&&n.Model[n._from](a),payload:r};return yield n.HandlerChainService.instance.process(s)})()}onBeforeLoad(e){return this.processRequest({type:"crt.HandleBeforeModelLoadRequest",previousPayload:e?.previousPayload},e)}onAfterLoad(e){var t=this;return(0,y.A)(function*(){yield t.processRequest({type:"crt.HandleAfterModelLoadRequest",previousPayload:e?.previousPayload},e)})()}onBeforeInsert(e){return this.processRequest({type:"crt.HandleBeforeModelInsertRequest"},e)}onAfterInsert(e){var t=this;return(0,y.A)(function*(){yield t.processRequest({type:"crt.HandleAfterModelInsertRequest"},e)})()}onBeforeUpdate(e){return this.processRequest({type:"crt.HandleBeforeModelUpdateRequest"},e)}onAfterUpdate(e){var t=this;return(0,y.A)(function*(){yield t.processRequest({type:"crt.HandleAfterModelUpdateRequest"},e)})()}onBeforeDelete(e){return this.processRequest({type:"crt.HandleBeforeModelDeleteRequest"},e)}onAfterDelete(e){var t=this;return(0,y.A)(function*(){yield t.processRequest({type:"crt.HandleAfterModelDeleteRequest"},e)})()}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(ie)))(a||ie)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:ie,factory:ie.\u0275fac,providedIn:"root"})}}class qe extends ie{processRequest(e,t){return super.processRequest({...e,$context:this._context?.deref()},t)}setContext(e){this._context=new WeakRef(e)}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(qe)))(a||qe)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:qe,factory:qe.\u0275fac})}}const Ai={[m.ModelMode.Init]:[m.ModelMode.Create,m.ModelMode.Copy,m.ModelMode.Update,m.ModelMode.Delete],[m.ModelMode.Copy]:[m.ModelMode.Delete,m.ModelMode.Update],[m.ModelMode.Create]:[m.ModelMode.Copy,m.ModelMode.Delete,m.ModelMode.Update],[m.ModelMode.Delete]:[m.ModelMode.Copy,m.ModelMode.Create,m.ModelMode.Update,m.ModelMode.Init],[m.ModelMode.Update]:[m.ModelMode.Delete],[m.ModelMode.Unknown]:[]};function _a(u){const e={success:!1,rowsAffected:0,errorInfo:""};return typeof u=="string"?Object.assign(e,{errorInfo:u}):u instanceof Error?Object.assign(e,{errorInfo:u.message}):Object.assign(e,typeof u=="object"?u:{errorInfo:u})}class Le{get _children(){return this._children$.value}static get instance(){return this._instance||(this._instance=new Le(null,null)),this._instance}constructor(e,t){this._injector=e,this.dataSource=t,this._lookupDataSourceName="lookupDataSource",this._id=(0,n.generateGuid)(),this._modeChanges=new c.Subject,this._destroyed$=new c.Subject,this._children$=new c.BehaviorSubject([]),this._childrenDirty$=new c.BehaviorSubject(!1),this._childrenModes$=new c.BehaviorSubject([]),this._isCollectionModel=!1,this._isCollectionItemModel=!1,this._mode=m.ModelMode.Init,this._isInitialized=!1,this._isLoaded=!1,this._dirtyAttributes=new Set,this._newLoadingRequestArrived=new c.Subject,this._attributesMap=[],this._selfDirty$=new c.BehaviorSubject(!1),this._isLoading=!1,this._destroyed=!1,this._dirty$=(0,c.combineLatest)([this._selfDirty$,this._childrenDirty$,this._childrenModes$]).pipe((0,o.map)(([a,r,s])=>a||r||s.includes(m.ModelMode.Copy)||s.includes(m.ModelMode.Create)),(0,o.distinctUntilChanged)()),this._loadedData=new Set,this._injector&&(this._dataSourceFactory=this._injector.get(O),this._lifecycleHookNotificationService=this._injector.get(fa,null,{optional:!0}),this._measurePerformanceService=this._injector.get(m.MeasurePerformanceService,null,{optional:!0}))}static create(e){return(0,c.from)(this.instance._create({type:"crt.EntityDataSource",config:{entitySchemaName:e}},""))}get name(){return this.dataSource?this.dataSource.dataSourceName:""}get mode(){return this._isCollectionModel?m.ModelMode.Unknown:this._mode}get _modeChanges$(){return this._modeChanges.asObservable()}get _isChanged(){return!!this._dirtyAttributes?.size}set _isCollection(e){this._isCollectionModel=e,this._isCollectionModel&&(this._mode=m.ModelMode.Unknown)}get isLoaded(){return this._isLoaded}get event$(){return re.instance.event$.pipe((0,o.filter)(()=>this._isInitialized),(0,o.filter)(()=>!this._isCollectionItemModel),(0,o.filter)(({dataSchemaName:e})=>e===this._dataSchemaName),(0,o.tap)(({type:e,modelId:t,payload:a})=>this._updateLoadedData(e,t,a)),(0,o.filter)(({modelId:e})=>e!==this._id&&!this._isChild(e)),(0,o.map)(e=>({event:e,ownPrimaryAttributesValues:e.payload?.primaryAttributesValues?.filter(t=>{const a=v.serializeRecordPrimaryAttributesValues(t);return this._loadedData.has(a)})})),(0,o.filter)(({event:e,ownPrimaryAttributesValues:t})=>e.type===V.Update||e.type===V.Delete?!t||t.length!==0:!0),(0,o.map)(({event:e,ownPrimaryAttributesValues:t})=>({event:e,primaryAttributesValues:e.type===V.Create?e.payload.primaryAttributesValues:t})),(0,o.map)(({event:e,primaryAttributesValues:t})=>({modelId:e.modelId,dataSchemaName:e.dataSchemaName,type:e.type,payload:{...e.payload,primaryAttributesValues:t}})),(0,o.takeUntil)(this._destroyed$))}get dataSchemaName(){return this._dataSchemaName}get allowSync(){return!this._disableSync}get disableSync(){return this._disableSync}set disableSync(e){this._disableSync=e}get isLoading(){return this._isLoading}get hasErrors(){return this.dataSource?this.dataSource.hasErrors:!0}get hasCriticalErrors(){return this.dataSource?this.dataSource.hasCriticalErrors:!0}get affectedAttributes(){return this.dataSource?this.dataSource.affectedAttributes:[]}get isAggregate(){return this.dataSource?this.dataSource.isAggregate:!1}get isCollectionItemModel(){return this._isCollectionItemModel}get isInitialized(){return this._isInitialized}_isChild(e){return this._children.some(t=>t?._id===e)}_subscribeChildrenModeChanges(){this._children$.pipe((0,o.map)(e=>e.map(t=>(0,c.merge)((0,c.of)(t.mode),t._modeChanges$))),(0,o.switchMap)(e=>e?.length?(0,c.combineLatest)(e):(0,c.of)([])),(0,o.tap)(e=>this._childrenModes$.next(e)),(0,o.takeUntil)(this._destroyed$)).subscribe()}_subscribeChildrenDirtyChanges(){this._children$.pipe((0,o.map)(e=>e.map(t=>t._dirty$)),(0,o.switchMap)(e=>e?.length?(0,c.combineLatest)(e):(0,c.of)([])),(0,o.map)(e=>e.some(t=>t)),(0,o.tap)(e=>this._childrenDirty$.next(e)),(0,o.takeUntil)(this._destroyed$)).subscribe()}_updateLoadedData(e,t,a){this._isCollectionModel&&e===V.Create&&this._isChild(t)&&a.primaryAttributesValues.forEach(r=>{const s=v.serializeRecordPrimaryAttributesValues(r);this._loadedData.add(s)})}_setMode(e){if(this._mode===e)return;if(!Ai[this._mode]?.includes(e))throw Error(`Unable to mark model with '${this._mode}' mode for '${e}'.`);const a=this._mode;this._mode=e,e===m.ModelMode.Delete&&this._selfDirty$.next(a!==m.ModelMode.Create)}_markForNotCollection(e){this._isCollectionModel||this.markFor(e)}_registerPrimaryAttributeValues(e){e.forEach(t=>{this._loadedData.add(v.serializeRecordPrimaryAttributesValues(t))})}_getDependentAttributesNames(e){return this._attributesMap.filter(t=>e.includes(t.name)).filter(t=>t.dependentAttributes.length!==0).map(t=>t.dependentAttributes).flat()}_getDefaultLoadAttributes(){return this.getSchema().pipe((0,o.map)(e=>e.getPrimaryLoadAttributes()))}_checkAttributesInDataSchema(e){return this.getSchema().pipe((0,o.tap)(t=>{const a=e.filter(r=>t.findAttributeByName(r)==null);if(a.length>0)throw new Error(`data has unknown attributes names: ${a.join(", ")}`)}))}_createDataSource(e,t,a=null){const r=a??t.dataSourceConfig;return this._dataSourceFactory.create(e,r)}_notifyEventByParameters(e,t){return this.getSchema().pipe((0,o.map)(a=>v.getPrimaryAttributeValuesFromParameters(a,e)),(0,o.mergeMap)(a=>this._notifyDataChange(a,t)))}_notifyDataChange(e,t){return this.getSchema().pipe((0,o.map)(a=>v.getModelPrimaryAttributeValues(a,e)),(0,o.tap)(a=>{re.instance.notify({modelId:this._id,dataSchemaName:this._dataSchemaName,type:t,payload:{primaryAttributesValues:a}})}),(0,o.map)(()=>null))}_mapSaveResult(e,t,a){return this.getSchema().pipe((0,o.map)(r=>({result:e,actionType:V.Update,data:v.getPrimaryAttributeValues(r,t,a)})))}_mapInsertResult(e){return{data:e.primaryAttributes??[],result:e,actionType:V.Create}}_getLoadAttributes(e){if(e&&e.length!==0){let t=null;if(e.every(r=>(0,b.isString)(r)))return t=this._getDependentAttributesNames(e),(0,c.of)([...e,...t]);{const r=e.map(s=>s.name);return t=this._getDependentAttributesNames(r),this.getSchema().pipe((0,o.map)(s=>(t=t.map(i=>s.findAttributeByName(i)).map(i=>({name:i.name,path:i.path,caption:i.caption,dataValueType:i.dataValueType,aggregationConfig:i.aggregationConfig})),[...e,...t])))}}return this._getDefaultLoadAttributes()}_getChangedAttributesValues(e){return this._persistedState?Object.entries({...this._persistedState,...e}).filter(([t])=>this._dirtyAttributes.has(t)).reduce((t,[a,r])=>Object.assign(t,{[a]:r}),{}):e}_load(e,t,a,r=m.ModelMode.Update){const s={attributes:e,parameters:t,options:a,mode:r},i=(0,b.cloneDeep)(this._lastRequestPayload),l=(0,b.isEqual)((0,b.omit)(s,"options.loadType"),(0,b.omit)(i,"options.loadType"));return this._loadingRequest&&l?this._loadingRequest:(this._lastRequestPayload&&!l&&(this._newLoadingRequestArrived.next(null),this._newLoadingRequestArrived=new c.Subject),this._lastRequestPayload=s,this._loadingRequest=this._getLoadAttributes(e).pipe((0,A.switchMapWithout)(()=>this._onBeforeLoad(s,i)),(0,o.switchMap)(d=>this.dataSource.load(d,t,a)),(0,o.takeUntil)(this._newLoadingRequestArrived),(0,o.tap)(()=>this._markForNotCollection(r)),(0,A.mergeMapWith)(()=>this.getSchema()),(0,o.tap)(([d,h])=>{this._registerPrimaryAttributeValues(v.getModelPrimaryAttributeValues(h,d))}),(0,o.tap)(()=>this._persistedState={}),(0,o.map)(([d,h])=>v.processImageData(h,d,e)),(0,o.tap)(()=>this._isLoaded=!0),(0,A.switchMapWithout)(()=>this._onAfterLoad(s,i)),(0,o.catchError)(d=>(this._isLoaded=!1,(0,c.throwError)(()=>d))),(0,o.tap)(()=>{this._markAsPristine(),this._loadingRequest=null}),(0,o.share)()),this._loadingRequest)}_updateAttributesDependencies(){this._attributesMap.forEach(t=>t.dependentAttributes=[]),this._attributesMap.filter(t=>t.attributeType!==n.DataSchemaAttributeType.OwnAttribute).forEach(t=>{const a=t.path.split(".");if(a.length===1)return;const r=a.shift(),s=this._attributesMap.find(i=>i.path===r);s?.dependentAttributes.push(t.name)})}_buildAttributesMap(e){const t=e.attributes??[];this._attributesMap=t.map(a=>({name:a.name,path:a.path,attributeType:a.attributeType,dependentAttributes:[],isSchemaAttribute:!0})),this._updateAttributesDependencies()}_loadDependentDataForCreate(e){return this.getSchema().pipe((0,o.map)(t=>t.attributes.filter(a=>a.dataValueType===n.DataValueType.Lookup).filter(a=>a.name in e).map(a=>a.name)),(0,o.switchMap)(t=>{if(t.length===0)return(0,c.of)([]);const a=t.map(r=>this.reloadDependentData(r,e[r]));return(0,c.forkJoin)(a)}),(0,o.map)(t=>{let a={};return t.forEach(r=>{a={...a,...r[0]||{}}}),{...a,...e}}))}_getDependentAttributesInfo(e){return this.getSchema().pipe((0,o.map)(t=>e.map(a=>{const r=t.findAttributeByName(a),s=r?.path??a,i=r?.name??a,l=r?.aggregationConfig??null,d=r?.dataValueType??null,h=r?.attributeType??null,f=s.split(".");f.shift();const _=f.length===1?f[0]:i;let S;return h===n.DataSchemaAttributeType.AggregationAttribute?S=n.DataSchemaAttributeType.AggregationAttribute:S=f.length===1?n.DataSchemaAttributeType.OwnAttribute:n.DataSchemaAttributeType.ForwardReferenceAttribute,{alias:_,attributeName:i,config:{path:f.join("."),aggregationConfig:l,dataValueType:d,type:S},type:S}})))}_markAsPristine(){this._selfDirty$.next(!1)}_onBeforeLoad(e,t){return this._lifecycleHookNotificationService?.onBeforeLoad?(0,c.from)(this._lifecycleHookNotificationService.onBeforeLoad({model:this,payload:{attributes:e?.attributes,options:e?.options,parameters:e?.parameters},previousPayload:{attributes:t?.attributes,options:t?.options,parameters:t?.parameters}})).pipe((0,o.map)(a=>{if(a===!1)throw Error('Loading is disallowed by a "OnBeforeLoad" model lifecycle event')})):(0,c.of)(void 0)}_onAfterLoad(e,t){return this._lifecycleHookNotificationService?.onAfterLoad?(0,c.from)(this._lifecycleHookNotificationService.onAfterLoad({model:this,payload:{attributes:e?.attributes,options:e?.options,parameters:e?.parameters},previousPayload:{attributes:t?.attributes,options:t?.options,parameters:t?.parameters}})):(0,c.of)(void 0)}_onBeforeInsert(e){return this._lifecycleHookNotificationService?.onBeforeInsert?this.getSchema().pipe((0,o.map)(t=>v.getModelPrimaryAttributeValues(t,[e])),(0,o.map)(t=>t.pop()),(0,o.switchMap)(t=>this._lifecycleHookNotificationService.onBeforeInsert({model:this,payload:{data:e,primaryAttributesValues:t}})),(0,o.map)(t=>{if(t===!1)throw Error('Inserting is disallowed by a "OnBeforeInsert" model lifecycle event')})):(0,c.of)(void 0)}_innerInsert(e){return this.dataSource.insert(e).pipe((0,o.map)(t=>this._mapInsertResult(t)),(0,o.tap)(()=>this._persistedState={}),(0,o.tap)(()=>this._markAsPristine()),(0,o.tap)(()=>this._markForNotCollection(m.ModelMode.Update)),(0,A.mergeMapWith)(()=>this.getSchema()),(0,o.tap)(([,t])=>{this._registerPrimaryAttributeValues(v.getModelPrimaryAttributeValues(t,[e]))}),(0,o.map)(([t])=>t),(0,A.mergeMapWithout)(({data:t,actionType:a})=>this._notifyDataChange(t,a)),(0,o.map)(({result:t})=>t))}_onAfterInsert(e){return this._lifecycleHookNotificationService?.onAfterInsert?(0,c.from)(this._lifecycleHookNotificationService.onAfterInsert({model:this,payload:{data:e}})):(0,c.of)(void 0)}_onBeforeUpdate(e,t){return this._lifecycleHookNotificationService?.onBeforeUpdate?(0,c.from)(this._lifecycleHookNotificationService.onBeforeUpdate({model:this,payload:{data:e,parameters:t}})).pipe((0,o.map)(a=>{if(a===!1)throw Error('Updating is disallowed by a "OnBeforeUpdate" model lifecycle event')})):(0,c.of)(void 0)}_innerUpdate(e,t){return this.dataSource.save(t,e).pipe((0,o.mergeMap)(a=>this._mapSaveResult(a,e,t)),(0,A.mergeMapWithout)(()=>this._notifyEventByParameters(t,V.Update)),(0,o.map)(({result:a})=>a),(0,o.tap)(()=>this.setLoadedState()))}_onAfterUpdate(e,t){return this._lifecycleHookNotificationService?.onAfterUpdate?(0,c.from)(this._lifecycleHookNotificationService.onAfterUpdate({model:this,payload:{data:e,parameters:t}})):(0,c.of)(void 0)}_onBeforeDelete(e){return this._lifecycleHookNotificationService?.onBeforeDelete?(0,c.from)(this._lifecycleHookNotificationService.onBeforeDelete({model:this,payload:{parameters:e}})).pipe((0,o.map)(t=>{if(t===!1)throw Error('Deleting is disallowed by a "OnBeforeDelete" model lifecycle event')})):(0,c.of)(void 0)}_innerDelete(e){return this.dataSource.delete(e).pipe((0,o.tap)(()=>this._markAsPristine()),(0,o.tap)(()=>this._markForNotCollection(m.ModelMode.Init)),(0,A.mergeMapWithout)(()=>this._notifyEventByParameters(e,V.Delete)))}_onAfterDelete(e){return this._lifecycleHookNotificationService?.onAfterDelete?(0,c.from)(this._lifecycleHookNotificationService.onAfterDelete({model:this,payload:{parameters:e}})):(0,c.of)(void 0)}init(){return this.getSchema().pipe((0,o.tap)(e=>this._dataSchemaName=e.name),(0,o.tap)(e=>this._buildAttributesMap(e)),(0,o.map)(()=>this),(0,o.tap)(()=>this._isInitialized=!this.hasCriticalErrors),(0,o.tap)(()=>{this._subscribeChildrenModeChanges(),this._subscribeChildrenDirtyChanges()}),(0,o.take)(1))}getSchema(){if(!this.dataSource)return(0,c.of)(null);if(this.hasCriticalErrors)return(0,c.of)(this.dataSource.getEmptySchema());const e=this.dataSource.getSchema();return this._measurePerformanceService?e.pipe(this._measurePerformanceService.measure$(`model.getSchema.${this.name}`)):e}getDataSource(){return this.dataSource}load(e){if(this._destroyed)return(0,c.of)([]);this._isLoading=!0;const t=e?.attributes,a=e?.parameters||[],r=v.getDataSourceLoadOptions(e?.options);return this._load(t,a,r).pipe((0,o.tap)(()=>this._isLoading=!1),(0,o.catchError)(s=>(this._isLoading=!1,(0,c.throwError)(()=>s))))}updateDependentAttributes(e){this._attributesMap=this._attributesMap.filter(r=>r.isSchemaAttribute);const t=this._attributesMap.map(r=>r.name),a=e.filter(r=>!t.includes(r.path)).map(r=>({name:r.path,path:r.path,attributeType:r.type??n.DataSchemaAttributeType.ForwardReferenceAttribute,dependentAttributes:[],isSchemaAttribute:!1}));this._attributesMap.push(...a),this._updateAttributesDependencies()}canReloadDependentData(e){return this._getDependentAttributesNames([e]).length!==0}getDependentAttributesNames(e){return this._getDependentAttributesNames([e])}reloadDependentData(e,t){const a=this._getDependentAttributesNames([e]);if(a.length===0)return(0,c.of)([]);if(t==null)return(0,c.of)([Object.fromEntries(a.map(i=>[i,null]))]);const r=[{type:n.ModelParameterType.PrimaryColumnValue,value:t}],s=new Map;return(0,c.forkJoin)([this._getDependentAttributesInfo(a),this.dataSource.getLookupDataSchema(e)]).pipe((0,o.switchMap)(([i,l])=>{const d=i.filter(f=>f.type!==n.DataSchemaAttributeType.OwnAttribute).map(f=>[f.alias,f.config]),h={type:l.dataSourceConfig.type,config:{...l.dataSourceConfig.config,attributes:Object.fromEntries(d)}};return i.forEach(f=>{s.set(f.alias,f.attributeName)}),this._createDataSource(`${this.name}_reloadData`,l,h)}),(0,o.switchMap)(i=>i.load([...s.keys()],r,{throttled:!0})),(0,o.map)(i=>i.map(l=>{const d={};return s.forEach((h,f)=>{d[h]=l[f]}),d})))}create(e={}){return this._isLoading=!0,this.getSchema().pipe((0,o.map)(t=>v.getOwnColumnsValues(t,e)),(0,o.switchMap)(t=>(0,c.forkJoin)([(0,c.of)(t),this.dataSource.getDefaultValues()])),(0,o.tap)(()=>this._markForNotCollection(m.ModelMode.Create)),(0,o.map)(([t,a])=>(this._persistedState={...a,...t},this._persistedState)),(0,o.switchMap)(t=>this._loadDependentDataForCreate(t)),(0,o.tap)(()=>this._isLoading=!1))}copy(e,t={}){return this._isLoading=!0,this.getSchema().pipe((0,o.map)(a=>({schema:a,attributes:a.attributes.filter(r=>r.attributeType===n.DataSchemaAttributeType.OwnAttribute&&r.isValueCloneable).map(r=>r.name),parameters:typeof e=="string"?[{type:n.ModelParameterType.PrimaryColumnValue,value:e}]:a.getPrimaryAttributesNames().filter(r=>e[r]).map(r=>({type:n.ModelParameterType.PrimaryColumnValue,value:{[r]:e[r]}}))})),(0,o.mergeMap)(({schema:a,attributes:r,parameters:s})=>this._load(r,s,{},m.ModelMode.Copy).pipe((0,o.tap)(()=>{this._isLoaded=!1}),(0,o.tap)(i=>{if(i.length>1)throw new Error("More than one record loaded for copy");if(i.length===0)throw new Error("No records loaded for copy")}),(0,o.map)(i=>v.removeNotRequestedData(r,{...i[0]})),(0,o.map)(i=>{a.getPrimaryAttributesNames().forEach(d=>delete i[d]);const l=v.getOwnColumnsValues(a,t);return{...i,...l}}),(0,o.switchMap)(i=>this.dataSource.getDefaultValues().pipe((0,o.map)(l=>({...l,...i})))),(0,o.tap)(i=>{this._persistedState={...i}}),(0,o.switchMap)(i=>this._loadDependentDataForCreate(i)),(0,o.tap)(()=>{this._isLoaded=!0,this._isLoading=!1}),(0,o.catchError)(i=>(this._isLoading=!1,this._markForNotCollection(m.ModelMode.Update),(0,c.throwError)(()=>new Error(i)))))))}insert(e){return this.getSchema().pipe((0,o.map)(a=>({dataSchema:a,data:{...this._persistedState??{},...e}})),(0,o.map)(({data:a,dataSchema:r})=>v.getOwnColumnsValues(r,a))).pipe((0,A.switchMapWithout)(a=>this._onBeforeInsert(a)),(0,A.switchMapWith)(a=>this._innerInsert(a)),(0,A.switchMapWithout)(([a])=>this._onAfterInsert(a)),(0,o.map)(([,a])=>a),(0,o.tap)(()=>{this._isLoaded=!0}),(0,o.catchError)(a=>(0,c.of)(_a(a))))}update(e,t){return this.getSchema().pipe((0,o.map)(r=>v.getOwnColumnsValues(r,e)),(0,o.map)(r=>this._getChangedAttributesValues(r))).pipe((0,A.switchMapWithout)(r=>this._onBeforeUpdate(r,t)),(0,A.switchMapWith)(r=>this._innerUpdate(r,t)),(0,A.switchMapWithout)(([r])=>this._onAfterUpdate(r,t)),(0,o.map)(([,r])=>r),(0,o.catchError)(r=>(0,c.of)(_a(r))))}insertOrUpdate(e,t){return this._mode===m.ModelMode.Update?this.update(e,t):this.insert(e)}delete(e){return this._onBeforeDelete(e).pipe((0,o.switchMap)(()=>this._innerDelete(e)),(0,A.switchMapWithout)(()=>this._onAfterDelete(e)),(0,o.catchError)(t=>(0,c.of)(_a(t))))}setValue(e){const t=Object.keys(e);return this._checkAttributesInDataSchema(t).pipe((0,o.tap)(()=>{t.length>0&&(this._dirtyAttributes=new Set([...this._dirtyAttributes,...t]),this._persistedState={...this._persistedState??{},...e})}),(0,o.map)(()=>null))}_getPersistedState(){return{...this._persistedState??{}}}markFor(e){this.mode!==e&&(this._setMode(e),this._modeChanges.next(e))}resetMode(){this._mode!==m.ModelMode.Init&&(this._mode=m.ModelMode.Init,this._modeChanges.next(this._mode))}loadLookupList(e,t,a={}){if(!this.dataSource)throw Error("DataSource is null");return this.dataSource.getLookupDataSchema(e).pipe((0,o.switchMap)(r=>{const s=r.getPrimaryLoadAttributes();return this._createDataSource(this._lookupDataSourceName,r).pipe((0,o.switchMap)(i=>i.load(s,t,a)),(0,o.map)(i=>({primaryAttributeName:r.primaryAttributeName,primaryDisplayAttributeName:r.primaryDisplayAttributeName,data:i})))}))}canDelete(e){return(0,c.lastValueFrom)(this.dataSource.canDelete(e),{defaultValue:null})}canSave(e){switch(this._mode){case m.ModelMode.Init:return Promise.resolve({result:!1});case m.ModelMode.Create:case m.ModelMode.Copy:return(0,c.lastValueFrom)(this.dataSource.canCreate(e),{defaultValue:null});case m.ModelMode.Update:return(0,c.lastValueFrom)(this.dataSource.canEdit(e),{defaultValue:null});case m.ModelMode.Delete:return this.canDelete(e);default:throw Error(`Unable to verify the possibility of operation executing: the '${this._mode}' is not supported.`)}}attributeChanged(e,t){t||this._selfDirty$.next(!0),this._dirtyAttributes.add(e)}setLoadedState(){this._dirtyAttributes=new Set,this._markAsPristine()}createCollectionItemModel(e){const t=new Le(this._injector,this.dataSource);return t._isCollectionItemModel=!0,t._isLoaded=!0,t._isInitialized=!0,t._persistedState={},t._dataSchemaName=this._dataSchemaName,t._attributesMap=this._attributesMap,e!=null&&(t._setMode(e),t._selfDirty$.next(!1)),this._children.push(t),t}childrenChange(){this._children$.next(this._children)}removeChild(e){const t=e?._id,a=this._children.findIndex(r=>r?._id===t);a!==-1&&this._children.splice(a,1)}_getAsyncResult(e){return(0,c.firstValueFrom)(e)}getLastError(){return this.dataSource?this.dataSource.getLastError():new Error("DataSource is null")}destroy(){this._isInitialized=!1,this._destroyed$.next(),this._destroyed$.complete(),this._selfDirty$.complete(),this._children$.complete(),this._childrenDirty$.complete(),this._childrenModes$.complete(),this._destroyed=!0}getOwnLoadParameters(){return this.dataSource.getOwnLoadParameters()}getAllowCopyingRecords(){return this.dataSource.getAllowCopyingRecords()}}(0,g.__decorate)([(0,n.ImplementUsingHandlerChain)({requestType:"crt.ModelGenerator",methodName:"generateOne"}),(0,g.__metadata)("design:type",Function)],Le.prototype,"_create",void 0);let Fe=class Gt{constructor(e,t,a,r){this.dataSourceFactory=e,this.entitySchemaRepository=t,this._featureValues=a,this._injector=r}_createModel(e=null,t=!1,a){const r=new Le(a||this._injector,e);return r.disableSync=t,r.init()}_validateModelConfig(e){if(e.primaryDataSourceName&&!e.dataSources[e.primaryDataSourceName])throw new Error(`Data source "${e.primaryDataSourceName}" cannot be primary data source. Data source "${e.primaryDataSourceName}" not found in model config.`);if(e.primaryDataSourceName&&e.dataSources[e.primaryDataSourceName]?.scope===n.DataSourceScope.ViewElement)throw new Error(`Data source "${e.primaryDataSourceName}" with scope "viewElement" cannot be primary. Only data sources with scope "page" can be primary`)}_getEntitySchemesRequest(e){return e.map(([,t])=>t).filter(t=>t.type==="crt.EntityDataSource").map(t=>t.config).filter(t=>!!t.entitySchemaName).map(t=>{let a=[];return t.attributes&&(a=Object.entries(t.attributes).filter(([,r])=>r.type===n.DataSchemaAttributeType.ForwardReferenceAttribute).map(([,r])=>r.path)),{name:t.entitySchemaName,loadLookupColumns:!0,forwardReferencePaths:a}})}_generateFromConfig(e,t){let a,r;const s=t?.get(m.MeasurePerformanceService,null,{optional:!0});return s?(a=Object.entries(e?.dataSources||{}).filter(([i,l])=>l.type?!0:(console.warn(`Data source ${i} without type not supported.`),!1)),a.length===0?(0,c.of)([]):(this._validateModelConfig(e),r=a.map(([i,l])=>this.generateOne(l,i,t)),this.preInitializeDataSources(a).pipe(s.measure$("modelGenerator.generateFromConfig"),(0,c.switchMap)(()=>(0,c.forkJoin)(r))))):(a=Object.entries(e?.dataSources||{}).filter(([i,l])=>l.type?!0:(console.warn(`Data source ${i} without type not supported.`),!1)),a.length===0?(0,c.of)([]):(this._validateModelConfig(e),r=a.map(([i,l])=>this.generateOne(l,i,t)),this.preInitializeDataSources(a).pipe((0,c.switchMap)(()=>(0,c.forkJoin)(r)))))}preInitializeDataSources(e){if(this._featureValues["DataSource-DontUseOneRequestForEntitySchemes"])return(0,c.of)(null);const t=this._getEntitySchemesRequest(e);return this.entitySchemaRepository.getSchemes(t).pipe((0,o.catchError)(a=>(0,c.of)([])),(0,o.map)(a=>null))}generate(e,t){return this._generateFromConfig(e,t)}generateOne(e,t,a){const r=a?.get(m.MeasurePerformanceService,null,{optional:!0});return r?this.dataSourceFactory.create(t,e,a).pipe(r.measure$(`modelGenerator.generateOne.${t}`),(0,o.mergeMap)(s=>this._createModel(s,e.disableSync,a))):this.dataSourceFactory.create(t,e,a).pipe((0,o.mergeMap)(s=>this._createModel(s,e.disableSync,a)))}static{this.\u0275fac=function(t){return new(t||Gt)(p.\u0275\u0275inject(O),p.\u0275\u0275inject(m.EntitySchemaRepository),p.\u0275\u0275inject(m.FEATURE_VALUES),p.\u0275\u0275inject(p.Injector))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Gt,factory:Gt.\u0275fac})}};Fe=(0,g.__decorate)([(0,A.CrtHandlerChainAdapter)({requestType:"crt.ModelGenerator"}),(0,g.__metadata)("design:paramtypes",[O,m.EntitySchemaRepository,m.FeatureValues,p.Injector])],Fe);var Ci=R(78240);class Oe{constructor(e,t,a){this._sysSettingsService=e,this._dataSchemaRepository=t,this._featureValues=a,this._searchComparisonTypeSysSettingCode="StringColumnSearchComparisonType"}_getParameterValue(e,t,a){if(typeof t=="string"){if(t.startsWith("@requestPayload")){const r=t.replace("@requestPayload.","");return(0,b.get)(a,r)}if(t.startsWith("$"))return e.attributes[t.substring(1)];if(e.attributes[t])return e.attributes[t]}return t}_applyFilterMacros(e,t){let a=null;switch(typeof t){case"object":a=JSON.stringify((0,Ci.classToPlain)(t));break;case"string":a=t;break;default:return t}const r=/##ViewModelMacro\.\$([^#]+)##/g;let s=!1;return[...a.matchAll(r)].forEach(i=>{const l=i[1],d=(0,b.get)(e.attributes,l);let h=d?.toString();typeof d=="object"&&(s=!0,h=JSON.stringify(d)),a=a.replace(i[0],h)}),typeof t=="object"||s?JSON.parse(a):a}_createPrimaryDisplayColumnValueFilter(e){var t=this;return(0,y.A)(function*(){const a=t._searchComparisonTypeSysSettingCode,s=(yield t._sysSettingsService.getByCode(a))?.value===1?n.ComparisonType.Contain:n.ComparisonType.Start_with;return{type:n.ModelParameterType.PrimaryDisplayValueFilter,value:e,comparisonType:s}})()}_createColumnValueFilter(e,t,a){const r=t;return Promise.resolve({type:n.ModelParameterType.ColumnValue,value:{attributePath:r.attributePath,attributeValue:this._getParameterValue(e,r.attributeValue,a)}})}_getOwnLoadParameters(e,t){return e.getModelByName(t)?.getOwnLoadParameters()}_getDataSourceFilteringParameters(e,t){const r=e._dataSourcesInfos.get(t).getFilteringConfig();return e._checkFilteringAttributes(t,r),r.length===0?Promise.resolve([]):Promise.all(r.map(s=>e[s.name])).then(s=>s.map(i=>({type:n.ModelParameterType.Filter,value:i})))}_getDataSourceOwnFilteringParameters(e,t){return this._getOwnLoadParameters(e,t)?.parameters??[]}_getPrimaryAttributeName(e,t){var a=this;return(0,y.A)(function*(){if(!t)return null;let r=Object.values(e.dataSchemas).find(s=>s.name===t);return r||(r=yield(0,c.lastValueFrom)(a._dataSchemaRepository.get(t))),r?.primaryAttributeName})()}_getParameterRelationsConfigs(e){return e.relationsConfigs||[]}_createRelationParameter(e,t){const a={...e},r=this._getParameterRelationsConfigs(a);return a.relationsConfigs=[{dataSchemaName:t.dataSchemaName,attributePath:t.attributePath,relationPath:t.relationPath},...r],a}_validateAllowedRelations(e,t,a){const s=a?.relationPath?.split(".")?.shift(),i=e.dataSchemas[t],l=i?.findAttributeByName(s);if(i&&l&&i.primaryAttributeName!==s&&l.dataValueType!==n.DataValueType.Lookup&&!this._featureValues.DataSourceAllowRelationsByNonLookupColumn){const d="Filtration of data sources by page data is currently supported by lookup and primaryAttribute fields only",h=new Error(`${d}, please see the console for more details`);throw h.stack=`${d} , data source name: ${t}, relation config: ${JSON.stringify(a)}`,h}}_createRelationParameterWithAttributeValue(e,t,a,r){var s=this;return(0,y.A)(function*(){const i={...a},l=s._getParameterRelationsConfigs(i),d=e.dataSchemas[t],h=r.relationPath.split("."),f=h.shift(),_=d.findAttributeByName(f);if(d.primaryAttributeName!==f&&_.dataValueType!==n.DataValueType.Lookup&&s._featureValues.DataSourceAllowRelationsByNonLookupColumn)return i.type=n.ModelParameterType.ColumnValue,i.value={attributePath:r.attributePath,attributeValue:r.value},i.relationsConfigs=l,i;const S={dataSchemaName:r.dataSchemaName,attributePath:r.attributePath,relationPath:r.relationPath};i.value=r.value,i.type=n.ModelParameterType.PrimaryColumnValue,d.primaryAttributeName!==f&&(S.dataSchemaName=_.referenceSchemaName);const M=d.type!==n.DataSchemaType.Entity?S.dataSchemaName:r.dataSchemaName;return S.relationPath=h.length===0?yield s._getPrimaryAttributeName(e,M):h.join("."),i.relationsConfigs=[S,...l],i})()}_convertToRelationParameters(e,t,a,r){var s=this;return(0,y.A)(function*(){const i=[];s._validateAllowedRelations(e,t,r);for(const l of a){const d=r.useAttributeValue?yield s._createRelationParameterWithAttributeValue(e,t,l,r):s._createRelationParameter(l,r);i.push(d)}return i})()}getLoadParametersByRelation(e,t,a,r){const s=t.relationPath.split("."),i=s.shift(),l=e.dataSchemas[i],d={dataSchemaName:l.name,attributePath:t.attributePath,relationPath:s.join(".")},h=s.shift(),_=e._dataSourcesInfos.get(i).getMappedAttributeNames(h)?.[0]??null,S=e.getModelMode(i),M=r?.[i]?.[d.relationPath];if(e.getModelByName(a)?.getAllowCopyingRecords()&&M)d.value=M,d.useAttributeValue=!0;else{const D=e.getIsDirty(_)||S===m.ModelMode.Create||S===m.ModelMode.Copy||l.type!==n.DataSchemaType.Entity;if(_&&D){d.useAttributeValue=!0;const T=e.attributes[_];d.value=T?.value?T.value:T}}return this._getModelLoadParameters(e,i,null,null,!0,!1).then(D=>this._convertToRelationParameters(e,i,D,d))}_getRelationParameters(e,t,a){const r=e._modelDependencies[t]||[];if(r.length===0)return Promise.resolve([]);const s=r.map(i=>this.getLoadParametersByRelation(e,i,t,a));return Promise.all(s).then(i=>i.flat())}_getPagingConfigRowCount(e,t){return typeof t=="string"?(0,b.isNil)(e.attributes[t])?0:e.attributes[t]:t}_getPagingConfigRowsOffset(e,t,a,r){const s=e._dataSourcesInfos.get(r).collectionViewModelAttributeName,i=e.attributes[s]?.length??0;if(typeof t=="number")throw new Error("Rows offset parameter cannot be set to number");return!t&&a===n.DataSourceLoadType.LoadNext?i:!t&&a===n.DataSourceLoadType.Reload?0:(e.attributes[t]=(0,b.isNil)(e.attributes[t])?0:e.attributes[t],a===n.DataSourceLoadType.Reload?e.attributes[t]:e.attributes[t]+i)}_getModelPagingConfig(e,t,a,r){if(!t){const s=this._getOwnLoadParameters(e,r);return Promise.resolve(s?.options?.pagingConfig??null)}return Promise.resolve({rowCount:this._getPagingConfigRowCount(e,t.rowCount),rowsOffset:this._getPagingConfigRowsOffset(e,t.rowsOffset,a,r)})}_mergeSorting(e,t){return(0,b.unionBy)(e??[],t??[],"columnName")??null}_getModelSortingConfig(e,t,a){const s=this._getOwnLoadParameters(e,a)?.options?.sortingConfig,i=t?.attributeName;return!i||!e.attributes[i]?s?Promise.resolve(s):Promise.resolve(null):Promise.all(e.attributes[i].map(function(){var l=(0,y.A)(function*(d){return{columnName:yield d.columnName,direction:yield d.direction}});return function(d){return l.apply(this,arguments)}}())).then(l=>({columns:this._mergeSorting(l,s?.columns)}))}_updateLastEventLoadParameters(e,t,a,r){a&&a.length!==0?e._lastEventLoadParameters.set(t,a):r!==!0&&e._lastEventLoadParameters.set(t,[{type:n.ModelParameterType.Empty,value:""}])}_getModelLoadParameters(e,t,a,r,s,i,l){const d=this.getModelParameters(e,a,r).then(h=>(i!==!0&&this._updateLastEventLoadParameters(e,t,h,s),s!==!0?h:e._lastEventLoadParameters.get(t)||[{type:n.ModelParameterType.Never,value:""}]));return Promise.all([d,this._getDataSourceFilteringParameters(e,t),this._getDataSourceOwnFilteringParameters(e,t),this._getRelationParameters(e,t,l)]).then(([h,f,_,S])=>[...h,..._,...f,...S])}getModelParameters(e,t,a){if(a?.parameters&&(t=[...t,...a.parameters]),!t||t.length===0)return Promise.resolve([]);const r=t.map(s=>{switch(s.type){case n.ModelParameterType.PrimaryColumnValue:return Promise.resolve({type:s.type,value:this._getParameterValue(e,s.value,a)});case n.ModelParameterType.Filter:return Promise.resolve({type:s.type,value:this._applyFilterMacros(e,s.value)});case n.ModelParameterType.PrimaryDisplayValueFilter:return this._createPrimaryDisplayColumnValueFilter(this._getParameterValue(e,s.value,a));case n.ModelParameterType.ColumnValue:return this._createColumnValueFilter(e,s.value,a)}});return Promise.all(r)}getModelLoadParameters(e,t,a,r=n.DataSourceLoadType.Load,{payload:s,useLastLoadParameters:i,doNotUpdateLastLoadParameters:l,modelLoadConfiguration:d}={}){const h=t.name,f=r??n.DataSourceLoadType.Load,_=f===n.DataSourceLoadType.Load?null:t.getPagingConfig(),S=t.getSortingConfig();return Promise.all([this._getModelLoadParameters(e,h,a,s,i,l,d),this._getModelPagingConfig(e,_,f,h),this._getModelSortingConfig(e,S,h)])}static{this.\u0275fac=function(t){return new(t||Oe)(p.\u0275\u0275inject(n.SysSettingsService),p.\u0275\u0275inject(j),p.\u0275\u0275inject(m.FEATURE_VALUES))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Oe,factory:Oe.\u0275fac,providedIn:"root"})}}const Ri=500;class U{static{this._skippedProperties=["schedule","then"]}constructor(e,t,a,r,s,i,l,d){this.viewModelGenerator=e,this.injector=t,this.viewModelConfig=a,this.resources=r,this._eventScopes=i,this._modelsInitConfig=l,this._defaultPrimaryAttributeName="Id",this._models$=new c.BehaviorSubject([]),this._businessRulesActive=!0,this._dropdownPageSizeSettingsCode="DropdownPageSize",this._dataSourcesInfos=new Map,this._attributesToDataSourceNameMap=new Map,this._dropdownPageSize=null,this._replayEvents$=new c.ReplaySubject,this._loadedDataSources=new Set,this._conflictedModels=[],this.__destroyed=!1,this._disableViewModelWaitingForAsyncTasks=!1,this._disableViewModelLoadUnblockingThread=!1,this._blockFieldsAffectedByBusinessRules=!1,this._asyncTasksExecutingSubject=new c.BehaviorSubject(new Set),this._modelsRequestedToLoad=new Set,this._attributesAffectedByBusinessRules=[],this._businessRulesAreActivated=!1,this._destroySubject=new c.Subject,this._modelSourceRecordId={},this._modelLoaded$=new c.Subject,this._viewModelAttributeChangeEventOptions=new m.ViewModelAttributeChangeEventOptions({preventAttributeChangeRequest:!1,preventStateChange:!0,preventRunBusinessRules:!0}),this._attributeConfigs={},this._eventsSubject$=new c.Subject,this._collectionSubscription=new Map,this._crtControls=new Map,this._subscriptions=new c.Subscription,this._destroy$=this._destroySubject.asObservable(),this._businessRulesActivated$=new c.BehaviorSubject(!1),this.attributes={},this.dataSchemas={},this.events$=(0,c.merge)(this._eventsSubject$,this._replayEvents$),this._systemAttributes=[],this.getAttributeViewModelConfig=f=>this._attributeConfigs[f]?.viewModelConfig?.attributes,this.initDependencies(),this._subscribeModelsChanges(),this.handlerChain=n.HandlerChainService.instance,s?this.formApiModel=s:this.formApiModel=this.formBuilder.group({}),this.parent=d;const h=this._appInfo?.isDebugEnabled?this._createProxy(this):this;return this._viewModelDataDelayerService&&!this.parent&&this._viewModelDataDelayerService.setViewModel(h),h}_createProxy(e){return new Proxy(e,{get(t,a){return!(typeof a=="string")||a in t||U._skippedProperties.includes(a)||console.debug(`Attribute ${a} not found.`),t[a]}})}get IsChanged(){return Promise.resolve(this.attributes[ye])}set IsChanged(e){}get HasUnsavedData(){return Promise.resolve(this.attributes[ze])}set HasUnsavedData(e){}set BusinessRulesActivated(e){}get BusinessRulesActivated(){return Promise.resolve(this._businessRulesAreActivated)}get _isChanged(){return console.warn("Warning: The `_isChanged` property of the view-model is deprecated. It will be removed in future versions. Use `IsChanged` or `HasUnsavedData` attribute instead."),Object.keys(this._attributeConfigs).filter(e=>!(0,b.isEmpty)(this._attributeConfigs[e].modelConfig)).some(e=>this.formApiModel.controls[e]?.dirty)}get _scopes(){return[...this._eventScopes??[]]}get _injectionContext(){return this._context}get[Y](){return this.injector}get primaryAttributeName(){if(!this._primaryModelName)return this._defaultPrimaryAttributeName in this._attributeConfigs?this._defaultPrimaryAttributeName:null;const t=this.dataSchemas[this._primaryModelName].primaryAttributeName,a=this._dataSourcesInfos.get(this._primaryModelName);return this._getMappedAttributeName(a,t)}get PrimaryModelMode(){return this.getPrimaryModelMode()}get State(){return Me(this).attributes[We]}get _destroyed(){return this.__destroyed}get models(){return this._models$.value}_executeWithOptions(e,t){let a;try{return a=this._viewModelAttributeChangeEventOptions.getOptions(),this._viewModelAttributeChangeEventOptions.setOptions(t),e()}finally{this._viewModelAttributeChangeEventOptions.setOptions(a)}}_setSystemAttributeValue(e,t){const a=this.attributes[e];this.attributes[e]=t,this._executeWithOptions(()=>{this._fireChangeAttributeEvent({type:P.ChangeAttributeValue,payload:{attributeName:e,oldValue:a,value:t}})},{preventStateChange:!0,preventRunBusinessRules:!0})}_fireChangeAttributeEvent(e){e.payload.silent??=this._viewModelAttributeChangeEventOptions.getAsSilent(),Object.assign(e.payload,this._viewModelAttributeChangeEventOptions.getOptions()),this._eventsSubject$.next(e)}_getViewModelValidators(e){const t=this.viewModelConfig.attributes[e]??{};return("validators"in t&&t.validators)??{}}_initDataSourceValidators(){return this._measurePerformanceService?.measure(`ViewModel.initDataSourceValidators.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>(this._validators={},this._dataSourcesInfos.forEach(e=>{e.attributesMap.forEach((t,a)=>{const r=this.viewModelConfig.attributes[a]??{};if("modelConfig"in r&&r.modelConfig?.ignoreValidators)return;this._validators[a]=this._validators[a]||[];const s=this._getDataSourceAttributeSchema(e,t);if(s?.validators){for(const[i,l]of Object.entries(s.validators))if(l?.type){const d=this._injectionContext??Me(this)?._injectionContext,h=this.validatorTypeResolver.getValidator(l.type,{validationParameters:l?.params,injectionContext:d}),f=this._getViewModelValidators(a),_=Object.values(f).find(S=>S.type===l.type);this._validators[a].push({name:i,instance:h,disabled:!!_?.disabled,params:l?.params})}}})}),(0,c.of)(null)))}_initSchemaValidators(e){this._measurePerformanceService.measure(`ViewModel.initSchemaValidators.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>{Object.entries(e||{}).forEach(([t])=>{const a=this._getViewModelValidators(t);this._validators[t]=this._validators[t]||[];for(const[r,s]of Object.entries(a))if(s?.type){const i=this._injectionContext??Me(this)?._injectionContext,l=this.validatorTypeResolver.getValidator(s.type,{validationParameters:s.params,injectionContext:i});this._validators[t].push({name:r,instance:l,disabled:s.disabled,params:s?.params})}})})}_waitAsyncValidation(){return(0,c.from)(this.waitAsyncTasksFinish()).pipe((0,o.switchMap)(()=>this.formApiModel.statusChanges.pipe((0,o.startWith)(this.formApiModel.status),(0,o.filter)(e=>e.toLowerCase()!=="pending"),(0,o.first)(),(0,o.map)(()=>null))))}_getDataSourceAttributeCaption(e,t){let a=this.resourceFinderService.findLocalizableValue(t);const r=this._getDataSourceInfoByViewModelAttributePath(e);if(a==null&&r){const s=r.getDataSourceAttributePath(e),i=s?this._getDataSourceAttributeSchema(r,s):"";a=i?i.caption:this._translateService.instant("BaseViewModel.DataSourceAttributeRemoved")}return a}_getResourcesStrings(){const e=this.resources?.strings??{};return{...e,...this._getResourceStringsByAttributes(e)}}_getChangedResourcesStrings(e){const t=Object.entries(e).reduce((r,[s,i])=>{const l=this.resources?.strings[s]||{},d=i&&{...l,...i};return{...r,[s]:d}},{}),a={...this.resources?.strings,...t};return JSON.parse(JSON.stringify(a))}_generateResourceAttribute(){this[m.SchemaResourcesSuffix]={},this[m.SchemaResourcesSuffix][m.TypeResources.string]={};const e=this._getResourcesStrings();return this._attributeResourceGenerator.generate(this,e)}_getBoundAttributeNames(){const e=new Set;return this._dataSourcesInfos.forEach(t=>{for(const a of t.mappedViewModelAttributes)e.add(a)}),Array.from(e.values())}_getDataSourceInfoByViewModelAttributePath(e){const t=this.getBoundDataSourceNameByAttributePath(e);return this._dataSourcesInfos.has(t)?this._dataSourcesInfos.get(t):null}_getResourceStringsByAttributes(e){const t=Object.keys(e);return this._getBoundAttributeNames().filter(r=>!t.includes(r)).reduce((r,s)=>(r[s]={},r),{})}_getDataSourceAttributeSchema(e,t){return this.dataSchemas[e.name]?.attributes?.find(a=>a.name===t)}_generatePrimaryAttributes(){return this._measurePerformanceService.measure(`ViewModel.generatePrimaryAttributes.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>{const e=Array.from(this._dataSourcesInfos.values()).map(t=>{const a=t.name,r=this.dataSchemas[a],i=(t.includePrimaryAttributes?[r?.primaryAttributeName,r?.primaryDisplayAttributeName]:[]).filter(l=>l&&!t.getIsDataSourceAttributePathExists(l)).map(l=>{const d=(0,n.generateGuid)(),h=`${a}_${l}_${d}`,f=r.findAttributeByName(l),_={modelConfig:{path:`${a}.${l}`},dataValueTypeName:n.DataValueType[f.dataValueType]};return this._attributeConfigs[h]=_,t.addNewAttribute(h,_),this._attributeGenerate({[h]:_})});return i.length===0?(0,c.of)(null):(0,c.forkJoin)(i)});return e.length===0?(0,c.of)(null):(0,c.forkJoin)(e).pipe(this._measurePerformanceService.measure$(`ViewModel.generatePrimaryAttributes.forkJoin.${this._injectionContext?.id}.parent.${!!this.parent}`))})}_getDataSourceDto(e){const t={},a=this._dataSourcesInfos.get(e);return a.attributesMap.forEach((r,s)=>{if(!a.getIsMapOnCollection(s)){const i=this.attributes[s],l=this._getDataSourceAttributeSchema(a,r);!i&&l?.dataValueType===n.DataValueType.Lookup?t[r]=null:t[r]=i}}),(0,c.of)(t)}_checkFilteringAttributes(e,t){if(t.some(r=>(0,b.isNil)(r.name)))throw new Error(`Filtering attributes for ${e} are not valid!`)}_attributeGenerate(e,t){return this._attributeGenerator.generate(this,e,{...t,onChangeAttributeValue:(a,r,s)=>{this._fireChangeAttributeEvent({type:P.ChangeAttributeValue,payload:{attributeName:a,value:r,oldValue:s,silent:this._viewModelAttributeChangeEventOptions.getAsSilent()}})}})}_getDataSourceNamesAffectedByFilteringAttribute(e){return[...this._dataSourcesInfos.entries()].filter(([,t])=>t.isCollection).filter(([t])=>{const a=this.getModelByName(t);return this._modelsRequestedToLoad?.has(a?.name)||a?.isLoaded||a?.isLoading}).filter(([t,a])=>{const r=a.getFilteringConfig(),s=r.some(i=>i?.name===e&&i?.loadOnChange);return s&&this._checkFilteringAttributes(t,r),s}).map(([t])=>t)}_createRequestsForReloadingDataSources(e){return e.map(t=>({type:"crt.LoadDataRequest",$context:this,dataSourceName:t,config:{loadType:n.DataSourceLoadType.Reload}}))}_dispatchStartLoadModelAttributes(e){const t=`${F.AttributeLoading}_${this._context?.id}_${Object.keys(e)}`;this._measurePerformancePageLoadService?.addTask(t,{targetTask:!0}),this._replayEvents$.next({type:P.StartLoadModelAttributes,payload:e})}_dispatchFinishLoadModelAttributes(e){const t=`${F.AttributeLoading}_${this._context?.id}_${Object.keys(e)}`;this._measurePerformancePageLoadService?.removeTask(t,{targetTask:!0}),this._replayEvents$.next({type:P.FinishLoadModelAttributes,payload:e})}_processEmptyLoadDataForCollection(e,t){var a=this;return(0,y.A)(function*(){if(!e.isCollection||!e.collectionViewModelAttributeName)return;const r=t.find(d=>d.type===n.ModelParameterType.PrimaryColumnValue);if(!r)return;const s=r.value?.value,i=a.attributes[e.collectionViewModelAttributeName];if(!s||!i)return;const l=yield i.findByPrimaryAttribute(s);l&&i.remove(l)})()}_loadDynamicModel(e){const t=e.attributeName,a=e.dataSourceConfig,r=e.dataSourceName||Ke.createDynamicDataSourceNameFromAttributeName(this,t),s=Ke.createAttributeConfig(this,r,e),i=this._createAndSetDataSourceInfo(r,t,s);return this._defineOrUpdateAttribute(t,s),this._setupSortingAttribute(e.sortingConfig),this._setupFiltersAttributes(e.filtersConfig),this._modelGenerator.generateOne(a,r).pipe((0,o.tap)(l=>this._markModelAsCollection(l,i)),(0,o.tap)(l=>this._upsertModel(r,l)),(0,o.tap)(l=>this._addModelDependencies(l,e.dependencies)),(0,o.switchMap)(l=>(0,c.forkJoin)([(0,c.of)(l),this._addDataSchemaToDataSchemas(l)])),(0,o.switchMap)(([l])=>(0,c.forkJoin)([(0,c.of)(l),(0,c.of)(this._replaceAttributesToDataSourceNameMap(i))])),(0,o.switchMap)(([l])=>(0,c.forkJoin)([(0,c.of)(l),this._reGenerateResourcesAttributes()])),(0,o.switchMap)(([l])=>this._loadModelData({model:l,dataSourceInfo:i,parametersConfig:[],loadType:n.DataSourceLoadType.Reload,useLastLoadParameters:e.useLastLoadParameters}).pipe(this._measurePerformanceService.measure$(`ViewModel.loadDynamicModel.${this._injectionContext?.id}.parent.${!!this.parent}.datasourceName.${e.dataSourceName}`))))}_defineOrUpdateAttribute(e,t){this.attributes[e]?this._attributeConfigs[e]=t:this._attributeGenerate({[e]:t})}_createAndSetDataSourceInfo(e,t,a){const s=L.getFromViewModelConfig({attributes:{[t]:a}}).get(e);return this._dataSourcesInfos.set(e,s),s}_setupSortingAttribute(e){if(!e?.default)return;const t=e.attributeName;this.attributes[t]=e.default}_setupFiltersAttributes(e){e?.forEach(t=>{if(!t.value)return;const a=t.name,r=t.value;this[a]=r.value||r})}_addModelDependencies(e,t){this._modelDependencies[e.name]=t||[]}_addDataSchemaToDataSchemas(e){return e.getSchema().pipe((0,o.tap)(t=>this.dataSchemas[e.name]=t))}_reGenerateResourcesAttributes(){return(0,c.forkJoin)([...this._generateResourceAttribute(),(0,c.of)(null)])}_replaceAttributesToDataSourceNameMap(e){const t=this._getDataSourceAttributesMap(e),a=[...Array.from(this._attributesToDataSourceNameMap.entries()),...t];this._initializeAttributesToDataSourceNameMap(a)}_getMappedAttributeName(e,t){if(!e)return"";const a=e.getMappedAttributeNames(t);return!a||a.length===0?"":a[0]}_getMappedAttributeNames(e,t){return e?e.getMappedAttributeNames(t):[]}_getModelAttributesToLoad(e,t){const a=this._dataSourcesInfos.get(e.name);if(t?.attributes){const r=t.attributes.filter(s=>{const i=this._getMappedAttributeName(a,s);return!this.getIsDirty(i)});return this._getModelDependentAttributes(e,r)}return a.attributes.map(r=>r.path)}_loadStaticModel(e,t,a,r,s,i){const l=this.getModelByName(e),d=this._dataSourcesInfos.get(l.name);return this._loadModelData({model:l,dataSourceInfo:d,parametersConfig:t,loadType:a,payload:r,useLastLoadParameters:s,doNotUpdateLastLoadParameters:i})}_waitDataDelay(e){return this._viewModelDataDelayerService?.shouldBeDelayed()?(0,c.of)(e).pipe((0,o.delayWhen)(()=>this._viewModelDataDelayerService.loadTrigger$)):(0,c.of)(e)}_updateTrackedAttributes(e){const t=this._modelDependencies[e.name];if(!t||!e.isAggregate)return;const a=/^.{0,2}\[\w+:\w+(:\w+)?]/;t.forEach(r=>{const s=r.relationPath.split(".")[0],i=this.getModelByName(s),l=e.affectedAttributes.filter(h=>h.schemaName===i.dataSchemaName).map(h=>h.path.split(".")[0]).filter(h=>!a.test(h)),d=new Set([...r.trackByAttributes??[],...l]);r.trackByAttributes=[...d.values()]})}_getDependOnModelsNames(e){const t=this._modelDependencies[e];if(!t)return[];const a=t.map(r=>r.relationPath.split(".")[0]);return[...new Set(a)]}_waitForModelLoad(e){var t=this;return(0,y.A)(function*(){const a=t.getModelByName(e);!a||a?.isLoaded||a.mode===m.ModelMode.Create||a.mode===m.ModelMode.Copy||(yield(0,c.firstValueFrom)(t._modelLoaded$.pipe((0,o.filter)(r=>r===e),(0,o.take)(1))))})()}_waitForModelsLoad(e){var t=this;return(0,y.A)(function*(){if(e.length===0||t._isDesignTime)return;const a=e.map(r=>t._waitForModelLoad(r));yield Promise.all(a)})()}_getAffectedAttributes(e,t,a){const s=this.dataSchemas[e].primaryAttributeName,i=[...t];return s&&!t.includes(s)&&a?.length>0&&a?.[0][s]&&i.push(s),i}_getModelLoadParameters(e,t,a,r,s,i){return this._modelParametersBuilder.getModelLoadParameters(this,e,t,a,{payload:r,useLastLoadParameters:s,doNotUpdateLastLoadParameters:i}).catch(l=>(console.error(l),this._showNotification({message:l.message}),[[{type:n.ModelParameterType.Never}],{},{}]))}_isRootModelAndDependsOnPrimaryDSByOneToManyRelation(e){if(!this._featureValues.AllowMultipleDataSources)return!1;const t=this._modelDependencies[e],a=Q(this.getModelByName(e));if(t?.length!==1||!this._primaryModelName||!a)return!1;const r=this.dataSchemas[this._primaryModelName],s=t[0],i=s.relationPath.split("."),l=i.shift(),d=i.shift(),h=l!==this._primaryModelName,f=d!==r.primaryAttributeName;return h||f?!1:sa(this.dataSchemas[e],s.attributePath,r,d)===C.OneToMany}_getOneToManyRelationDefaultValues(e){const t=this._modelDependencies[e]?.[0],a=this.dataSchemas[this._primaryModelName],r=Object.keys(this._attributeConfigs).find(s=>this._attributeConfigs[s]?.modelConfig?.path===`${this._primaryModelName}.${a.primaryAttributeName}`);return{[t.attributePath]:this.attributes[r]}}_getDependOnModelLoadConfiguration(e){const t=this._getDependOnModelsNames(e),a={};return t.forEach(r=>{this._modelSourceRecordId[r]&&(a[r]={[this.dataSchemas[r].primaryAttributeName??"Id"]:this._modelSourceRecordId[r]})}),a}_checkAndProcessPageDataSourceData(e,t){if(!this._featureValues.AllowMultipleDataSources||!(this._isRootModelAndDependsOnPrimaryDSByOneToManyRelation(e.name)&&t.length===0))return(0,c.of)(t);e.resetMode();const s=this._getOneToManyRelationDefaultValues(e.name);if(this.PrimaryModelMode===m.ModelMode.Copy){const i=this.dataSchemas[e.name].primaryAttributeName??"Id",l=this._getDependOnModelLoadConfiguration(e.name);return(0,c.from)(this.getDataSourceLoadParameters(e.name,l)).pipe((0,o.switchMap)(({parameters:d,options:h})=>e.load({attributes:[i],parameters:d,options:{loadType:n.DataSourceLoadType.Reload,pagingConfig:h.pagingConfig,sortingConfig:h.sortingConfig}})),(0,o.switchMap)(d=>{e.resetMode();const h=d?.length?d[0][i]:null;return h?this.copy(e.name,h,s):this.create(e.name,s)}),(0,o.map)(()=>t))}return this.create(e.name,s).pipe((0,o.map)(()=>t))}_loadModelData({model:e,dataSourceInfo:t,parametersConfig:a,loadType:r,payload:s,useLastLoadParameters:i,doNotUpdateLastLoadParameters:l}){const d=e.name;this._modelsRequestedToLoad.add(d);const h=this._getModelAttributesToLoad(e,s),f=s?.attributes;if(f&&h.length===0)return(0,c.of)([]);if(this._conflictedModels.includes(d))return(0,c.of)([]);const _=this._getDataSourceMappingAttributes(t,h),S=this._getLoadTypeForDataSource(t,r);if(S===n.DataSourceLoadType.LoadNext&&this._loadedDataSources.has(d))return(0,c.of)([]);this._dispatchStartLoadModelAttributes(_);const M=!this._isSyncForModelAllowed(e)||f===null||e.mode===m.ModelMode.Init,He=this._getDependOnModelsNames(d);return this._checkAndLoadUnloadedDependOnModels(He),(0,c.from)(this._waitForModelsLoad(He)).pipe((0,o.switchMap)(D=>this._getModelLoadParameters(t,a,S,s,i,l)),(0,o.mergeMap)(D=>this._waitDataDelay(D)),(0,o.switchMap)(([D,T,os])=>e.load({attributes:h,parameters:D,options:{loadType:r,pagingConfig:T,sortingConfig:os}}).pipe(this._measurePerformanceService.measure$(`ViewModel.loadStaticModel.model.load.${this._injectionContext?.id}.parent.${!!this.parent}.modelName.${d}`),(0,o.catchError)(w=>this._handleLoadErrorResponse(w,[])),(0,o.tap)(()=>this._updateTrackedAttributes(e)),(0,o.tap)(w=>{w.length<T?.rowCount?this._loadedDataSources.add(d):this._loadedDataSources.delete(d)}),(0,o.tap)(w=>{w.length===0&&this._dispatchFinishLoadModelAttributes(_)}),(0,o.mergeMap)(w=>w.length===0?(0,c.from)(this._processEmptyLoadDataForCollection(t,D)).pipe((0,o.map)(()=>w)):(0,c.of)(w)),(0,o.switchMap)(w=>this._checkAndProcessPageDataSourceData(e,w)))),(0,o.map)(D=>({data:D,viewModelAttributes:t.getModelDto(D)})),(0,o.switchMap)(({data:D,viewModelAttributes:T})=>this.setValue(T,{collectionLoadType:S===n.DataSourceLoadType.Reload?m.CollectionLoadType.Reload:m.CollectionLoadType.Merge,silent:!0}).pipe((0,o.tap)(()=>{!t.isCollection||!T||Object.keys(T).forEach(os=>{this.attributes[os]?.forEach(zi=>{zi.formApiModel.updateValueAndValidity()})})}),(0,o.tap)(()=>this._markAsPristine(T)),(0,o.map)(()=>D))),(0,o.tap)(()=>this._modelLoaded$.next(d)),(0,o.switchMap)(D=>this._runBusinessRulesForModel(e,D)),(0,o.tap)(D=>{if(M)return;const T=this._getAffectedAttributes(d,h,D);this._reloadDependentModels(e,T)}),(0,o.tap)(()=>{e.setLoadedState(),this._dispatchFinishLoadModelAttributes(_)}))}_checkAndLoadUnloadedDependOnModels(e){const t=e.filter(a=>{const r=!this._modelsRequestedToLoad.has(a),s=!Q(this.getModelByName(a));return r&&s});this._requestReloadModels(t)}_createChangeAttributeTriggers(e){return e.map(t=>({type:m.BusinessRuleTriggerType.ChangeAttributeValue,name:t,scopeId:""}))}_runBusinessRulesForModel(e,t,a=!1,r=[]){const s=this._dataSourcesInfos.get(e.name);if(s.isCollection||!this._businessRulesProcessingEnabled||!this._businessRulesActive)return(0,c.of)(t);const i=t[0]??{},l=a?[...s.mappedViewModelAttributes]:Object.keys(i).flatMap(_=>this._getMappedAttributeNames(s,_)).filter(_=>_!=null),d=this._createChangeAttributeTriggers(l),h={type:m.BusinessRuleTriggerType.DataLoaded,name:e.name,scopeId:""},f=this.models.filter(_=>_!==e).filter(_=>_.mode!==m.ModelMode.Init).filter(_=>_.getDataSource().scope===n.DataSourceScope.Page).map(_=>this._getModelBusinessRuleContext(_.name,[]));return(0,c.forkJoin)([this._getModelBusinessRuleContext(s.name,[h,...r]),...f,(0,c.of)(this._getViewModelBusinessRuleContext([...d,...r,h]))]).pipe(this._measurePerformanceService.measure$(`ViewModel.runBusinessRulesForModel.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,o.switchMap)(_=>this._runBusinessRulesForContexts(_)),(0,o.map)(()=>t))}_runInitialBusinessRules(){if(!this._businessRulesProcessingEnabled||!this._businessRulesActive)return(0,c.of)(null);const e={type:m.BusinessRuleTriggerType.ContextReady,name:null,scopeId:""};return this._prepareBusinessRulesContexts([e]).pipe(this._measurePerformanceService.measure$(`ViewModel.runInitialBusinessRules.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,o.mergeMap)(t=>t.length===0?(0,c.of)(null):this._runBusinessRulesForContexts(t)))}_createViewModelAttributesValues(e,t){const a=Object.entries(this.dataSchemas),[,r]=a.find(([i])=>i===e),s={};for(const i of r.attributes){const l=t[i.name],d=this.getViewModelAttributePath(e,i.name);d&&(s[d]=l??null)}return s}_createModelData(e,t){const a=this._dataSourcesInfos.get(e),r=this._getDataSourceMappingAttributes(a);this._dispatchStartLoadModelAttributes(r);const s=this.getModelByName(e),i=s.disableSync,l=this._getModelAttributesToLoad(s,null);return s.disableSync=!0,s.create(t).pipe((0,o.switchMap)(d=>{const h=this._createViewModelAttributesValues(e,d),f=this._isRootModelAndDependsOnPrimaryDSByOneToManyRelation(e)?{silent:!0}:null;return this.setValue(h,f).pipe((0,o.tap)(()=>this._forEachControl(h,_=>{_.markAsPristine(),_.markAsUntouched()})))}),(0,o.tap)(()=>{s.disableSync=i,this._modelLoaded$.next(e)}),(0,o.switchMap)(()=>this._runBusinessRulesForModel(s,[],!0)),(0,o.tap)(()=>{this._isSyncForModelAllowed(s)&&this._reloadDependentModels(s,l)}),(0,o.tap)(()=>{this._dispatchFinishLoadModelAttributes(r),s.setLoadedState()}),(0,o.map)(()=>null))}_copyModelData(e,t,a){const r=this._dataSourcesInfos.get(e),s=this._getDataSourceMappingAttributes(r);this._dispatchStartLoadModelAttributes(s);let i;const l=this.getModelByName(e),d=this._getModelAttributesToLoad(l,null),h=l.disableSync;return l.disableSync=!0,this._modelSourceRecordId[e]=t,l.copy(t,a).pipe((0,o.catchError)(f=>this._handleLoadErrorResponse(f,{})),(0,o.map)(f=>({data:[f],viewModelAttributes:r.getModelDto([f])})),(0,o.switchMap)(({data:f,viewModelAttributes:_})=>this.setValue(_).pipe((0,o.tap)(()=>this._markAsPristine(_)),(0,o.map)(()=>f))),(0,o.tap)(()=>{l.disableSync=h,this._modelLoaded$.next(e)}),(0,o.switchMap)(f=>this._runBusinessRulesForModel(l,f,!0)),(0,o.tap)(()=>{this._isSyncForModelAllowed(l)&&this._reloadDependentModels(l,d)}),(0,o.tap)(()=>{this._dispatchFinishLoadModelAttributes(s),l.setLoadedState()}),(0,o.mergeMap)(()=>(0,c.of)(i)))}_getDataSourceMappingAttributes(e,t=null){const a=t??e.attributes.map(s=>s.path),r=Object.fromEntries(a.map(s=>[this._getMappedAttributeName(e,s),!0]));return e.collectionViewModelAttributeName&&(r[e.collectionViewModelAttributeName]=!0),r}_handleLoadErrorResponse(e,t){return console.error(e),this._showNotification({message:e.message,duration:1e4}),(0,c.of)(t)}_canExecuteBusinessRulesByModelAttributeValue(e,t,a){return t&&e?this._isModelAttributeValueValid(e,t,a):!0}_canExecuteBusinessRulesByViewModelAttributeValue(e,t){const a=this._getDataSourceInfoByViewModelAttributePath(e);if(a){const r=a.getDataSourceAttributePath(e);return this._canExecuteBusinessRulesByModelAttributeValue(a,r,t)}return!0}_getContextAttributeValue(e){return e instanceof Date?(0,n.toLocalISOString)(e):e}_getNormalizedContextAttributeValue(e,t,a){const r=e;return n.DataValueType[t]===n.DataValueType.Lookup||r?.displayValue?r?.value??e:a===!0||!t?e:[n.DataValueType.RICH_TEXT,n.DataValueType.Image].includes(n.DataValueType[t])?null:n.DataValueType[t]===n.DataValueType.MAXSIZE_TEXT&&e?e.slice(0,500):e}_getHasValueContextAttributeValue(e,t){return!!(t&&n.DataValueType[t]===n.DataValueType.Boolean||e!=null&&e!=="")}_getViewModelAttributeInfos(e,t,a){return Object.keys(t).filter(r=>!(t[r]instanceof q)).map(r=>{if(t[r]instanceof U)return this._getViewModelAttributeInfos(e?`${e}.${r}`:r,t[r]?.attributes??{},a);const s=this._attributeConfigs[r]?.dataValueTypeName,i=this._getContextAttributeValue(t[r]),l=this._getNormalizedContextAttributeValue(i,s,a);return{name:e?`${e}.${r}`:r,value:l??null,displayValue:t[r]?.displayValue,dataValueTypeName:s,hasValue:this._getHasValueContextAttributeValue(i,s)}}).flat()}_runBusinessRulesForContexts(e){const t=`${F.RunningBusinessRules}-${(0,n.generateGuid)()}`;return this._onAsyncTaskStarted(t),(0,c.of)(e).pipe(this._measurePerformanceService.measure$(`ViewModel.runBusinessRules.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,o.map)(a=>a?.filter(r=>!(0,b.isNil)(r))??[]),(0,o.mergeMap)(a=>{if(a.length===0)return(0,c.of)(null);const r=a.map(s=>({scopeName:s.scopeName,scopeId:s.scopeId,scopeType:s.scopeType,triggers:s.triggers}));return this._toggleControlsAffectedByBusinessRules(!1,r),this._businessRulesEngine.execute(a).pipe(this._measurePerformanceService.measure$(`ViewModel.runBusinessRules.execute.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,o.tap)(s=>{s.forEach(i=>{const l=r.find(d=>d.scopeId===i.scopeId&&d.scopeName===i.scopeName&&d.scopeType===i.scopeType);i.triggers=l?.triggers??[]})}),(0,o.switchMap)(s=>s?this._businessRulesApplier.applyRules(this,s):(0,c.of)(null)),(0,o.tap)(()=>{this._toggleControlsAffectedByBusinessRules(!0,r)}))}),(0,o.tap)(()=>this._onAsyncTaskFinished(t)))}_createViewModelContext(e,t){return{scopeType:E.ScopeType.ViewModel,scopeName:this._scopeName,scopeId:this._scopeName,scopeState:E.ScopeStateType.Unknown,parentScopeId:null,attributes:t,triggers:e}}_getViewModelBusinessRuleContext(e){const t=this._featureValues["BRules-EnableCompareLargeAttributeValues"],a=this._getViewModelAttributeInfos(null,this.attributes,t);return this._createViewModelContext(e,[...a].map(r=>({attributeName:r.name,value:r.value,displayValue:r.displayValue,dataValueTypeName:r.dataValueTypeName,hasValue:r.hasValue})))}_prepareModelBusinessRuleTrigger(e,t){return t.map(a=>{if(a.type===m.BusinessRuleTriggerType.DataLoaded||a.type===m.BusinessRuleTriggerType.ContextReady)return a;const r=this._getDataSourceInfoByViewModelAttributePath(a.name);return!r||r.name!==e?null:{type:m.BusinessRuleTriggerType.ChangeAttributeValue,name:r.getDataSourceAttributePath(a.name),scopeId:""}}).filter(a=>a!=null)}_getModelContextScopeStateType(e){switch(e.mode){case m.ModelMode.Init:return E.ScopeStateType.Init;case m.ModelMode.Create:return E.ScopeStateType.Create;case m.ModelMode.Copy:return E.ScopeStateType.Copy;case m.ModelMode.Update:return E.ScopeStateType.Update;default:return E.ScopeStateType.Unknown}}_getModelBusinessRuleContext(e,t){const a=this._dataSourcesInfos.get(e),r=this.getModelByName(e),s=this.dataSchemas[e],i=this._prepareModelBusinessRuleTrigger(e,t),l=this._getModelContextScopeStateType(r);return this._getDataSourceDto(e).pipe((0,o.map)(d=>({...r._getPersistedState(),...d})),(0,o.map)(d=>({enableCompareLargeAttributeValues:this._featureValues["BRules-EnableCompareLargeAttributeValues"],modelDto:d})),(0,o.map)(({enableCompareLargeAttributeValues:d,modelDto:h})=>Object.entries(h).map(([f,_])=>{let S;const M=this._getMappedAttributeName(a,f);if(M)S=this._attributeConfigs[M]?.dataValueTypeName;else{const T=s.findAttributeByName(f);S=n.DataValueType[T.dataValueType]}const He=this._getContextAttributeValue(_),D=this._getNormalizedContextAttributeValue(He,S,d);return{attributeName:f,value:D,displayValue:_?.displayValue,dataValueTypeName:S,hasValue:this._getHasValueContextAttributeValue(He,S),isSignificant:f===s.primaryAttributeName}})),(0,o.map)(d=>({scopeType:E.ScopeType.Model,scopeName:r.dataSchemaName,scopeId:e,scopeState:l,parentScopeId:this._scopeName,attributes:d,triggers:i,modelType:r.getDataSource()?.type})))}_prepareDataSourceNamesForBusinessRules(){return this._modelsMap.size===0?[]:[...this._modelsMap.values()].filter(e=>!this._dataSourcesInfos.get(e.name).isCollection).map(e=>e.name)}_getModelsBusinessRuleContexts(e){return this._prepareDataSourceNamesForBusinessRules().map(a=>a?this._getModelBusinessRuleContext(a,e):(0,c.of)(null))}_prepareBusinessRulesContexts(e){const t=this._getModelsBusinessRuleContexts(e);if(!this._scopeName)return t.length===0?(0,c.of)([]):(0,c.forkJoin)([...t]);const r=[(0,c.of)(this._getViewModelBusinessRuleContext(e)),...t];return r.length===0?(0,c.of)([]):(0,c.forkJoin)(r)}_isAttributeChange(e){return!e.attributeName?.includes(":")}_businessRulesSubscribeOnChangeAttributes(){if(!this._businessRulesProcessingEnabled)return;const e=this.events$.pipe((0,o.filter)(a=>a.type===P.ChangeAttributeValue),(0,o.filter)(a=>this._isAttributeChange(a.payload)),(0,o.filter)(a=>!a.payload.silent),(0,o.filter)(a=>!a.payload?.preventRunBusinessRules),(0,o.filter)(a=>{const r=a.payload;return this._canExecuteBusinessRulesByViewModelAttributeValue(r.attributeName,r.value)}),(0,o.filter)(()=>this._businessRulesActive),(0,o.map)(a=>a.payload.attributeName)),t=e.pipe((0,o.tap)(()=>this._onAsyncTaskStarted(F.DebouncingBusinessRules)),(0,o.buffer)(e.pipe((0,o.debounceTime)(Ri))),(0,o.map)(a=>Array.from(new Set(a))),(0,o.map)(a=>this._createChangeAttributeTriggers(a)),(0,o.mergeMap)(a=>this._prepareBusinessRulesContexts(a)),(0,o.tap)(()=>this._onAsyncTaskFinished(F.DebouncingBusinessRules)),(0,o.filter)(a=>a.length>0),(0,o.mergeMap)(a=>this._runBusinessRulesForContexts(a)));this._subscriptions.add(t.subscribe())}_subscribeOnChangeAttributes(){const e=this.events$.pipe((0,o.filter)(t=>t.type===P.ChangeAttributeValue),(0,o.tap)(t=>{const a=t,r=a.payload.attributeName,s=this.getBoundDataSourceName(r),i=this.getModelByName(s),d=this._dataSourcesInfos.get(s)?.attributesMap.get(r);d&&i?.attributeChanged(d,a.payload?.preventStateChange??a.payload?.silent)}));this._subscriptions.add(e.subscribe())}_getHasRelation(e,t,a){return e.map(s=>{const i=s.relationPath.split("."),l=s.trackByAttributes??[],d=i.shift(),h=i.shift();return l.push(h),{rootModelName:d,trackedAttributes:l}}).filter(({rootModelName:s})=>s===t).filter(({trackedAttributes:s})=>this._dataSourcesInfos.get(t).isCollection?!0:a.some(i=>s.includes(i))).length!==0}_getDependentModelsNames(e,t=[]){return e?Object.entries(this._modelDependencies).filter(([a])=>a!==e).filter(([,a])=>this._getHasRelation(a,e,t)).map(([a])=>a).map(a=>[a,...this._getDependentModelsNames(a)]).flat():[]}_getIsModelDataChanged(e){if(!this.getModelByName(e)?.isLoaded)return!1;const a=this._dataSourcesInfos.get(e);if(a.isCollection){const s=a.collectionViewModelAttributeName,i=this.attributes[s];return i?i.isChanged:!1}return a.getMappedAttributes().some(s=>this.getIsDirty(s))}_requestReloadModels(e){this._createRequestsForReloadingDataSources(e).forEach(a=>{this._ngZone.runOutsideAngular(()=>this.processRequest(a))})}_isModelAttributeValueValid(e,t,a){return this._getDataSourceAttributeSchema(e,t)?.dataValueType===n.DataValueType.Lookup?(0,m.isValidLookupValue)(a):!0}_canReloadModelDependentData(e,t){return e.canReloadDependentData(t)?!0:this._conflictedModels.includes(e.name)?!1:this._getDependentModelsNames(e.name,[t]).length>0}_getModelDependentAttributes(e,t){return[...t,...t.map(a=>e.getDependentAttributesNames(a)).flat()]}_getChangedModelsNames(e){return e.filter(t=>this._getIsModelDataChanged(t))}_showNotification(e){this._ngZone.runOutsideAngular(()=>this.processRequest({type:"crt.NotificationRequest",$context:this,...e}))}_isSyncForModelAllowed(e){return e.allowSync}_subscribeOnReloadDataEvents(){const e=this.events$.pipe((0,o.filter)(()=>this._modelSynchronizationEnabled),(0,o.filter)(t=>t.type===P.ChangeAttributeValue),(0,o.filter)(t=>t.payload.silent!==!0),(0,o.map)(t=>({modelName:this.getBoundDataSourceNameByAttributePath(t.payload.attributeName),attributeName:t.payload.attributeName,attributeValue:t.payload.value})),(0,o.filter)(({modelName:t})=>t!=null),(0,o.map)(({modelName:t,attributeName:a,attributeValue:r})=>{const s=this._dataSourcesInfos.get(t),i=s?.attributesMap.get(a);return{model:this.getModelByName(t),dataSourceInfo:s,modelAttribute:i,attributeValue:r}})).pipe((0,o.filter)(({model:t})=>t!=null),(0,o.filter)(({dataSourceInfo:t})=>!t.isCollection),(0,o.filter)(({model:t})=>this._isSyncForModelAllowed(t)),(0,o.filter)(({dataSourceInfo:t,modelAttribute:a,attributeValue:r})=>this._isModelAttributeValueValid(t,a,r)),(0,o.filter)(({model:t,modelAttribute:a})=>this._canReloadModelDependentData(t,a))).pipe((0,o.tap)(({model:t,dataSourceInfo:a,modelAttribute:r,attributeValue:s})=>{const i=this._getModelDependentAttributes(t,[r]),l=Object.fromEntries(i.map(d=>[this._getMappedAttributeName(a,d),!0]));this._dispatchStartLoadModelAttributes(l),t.reloadDependentData(r,s).pipe((0,o.switchMap)(d=>{if(d.length===0)return(0,c.of)(d);const h=a.getModelDto(d);return this.setValue(h,{silent:!0}).pipe((0,o.switchMap)(()=>this._runBusinessRulesForModel(t,d)))}),(0,o.tap)(()=>this._reloadDependentModels(t,[r])),(0,o.tap)(()=>this._dispatchFinishLoadModelAttributes(l))).subscribe()}));this._subscriptions.add(e.subscribe())}_subscribeOnChangeRequests(){const e=this.events$.pipe((0,o.filter)(t=>t.type===P.ChangeAttributeValue),(0,o.mergeMap)(t=>{const a=t.payload.attributeName,r=this._attributeConfigs[a];return Array.isArray(r?.change)?r.change:[r?.change]}),(0,o.filter)(t=>t!=null),(0,o.map)(t=>({type:t.request,$context:this,scopes:this._scopeName?[this._scopeName]:[],...t.params})),(0,o.tap)(t=>this._ngZone.runOutsideAngular(()=>this.handlerChain.process(t))));this._subscriptions.add(e.subscribe())}_subscribeOnFilteringEvents(){const e=this.events$.pipe((0,o.filter)(t=>t.type===P.ChangeAttributeValue),(0,o.map)(t=>{const a=t.payload.attributeName;return this._getDataSourceNamesAffectedByFilteringAttribute(a)}),(0,o.map)(t=>this._createRequestsForReloadingDataSources(t)),(0,o.tap)(t=>{t.forEach(a=>{this._ngZone.runOutsideAngular(()=>this.processRequest(a))})}));this._subscriptions.add(e.subscribe())}_saveModel(e,t,a){const r="MODEL_SAVING";this.maskService.showMask(r,this);const s=this._getBoundDataSourceAttributeControls(e);return Object.keys(s).forEach(i=>this.formApiModel.controls[i].updateValueAndValidity()),this._saveModelAndGetDataSourceSaveResult(e,t).pipe((0,o.finalize)(()=>this.maskService.hideMask(r,this)),(0,o.catchError)(i=>{const l=typeof i=="string"?i:i?.message||i?.errorInfo;return a?.silent===!0?(0,c.of)({success:!1,rowsAffected:0,errorInfo:l}):(0,c.throwError)(()=>new Error(l))}))}_saveModelAndGetDataSourceSaveResult(e,t){return(0,c.from)(this.isValid(e)).pipe((0,o.switchMap)(a=>{if(!a){const i=this.injector.get(_e.TranslateService);return(0,c.of)({success:!1,rowsAffected:0,errorInfo:i.instant("HomePage.DialogMessages.RequiredFieldsAreNotFilled")})}const r=this.getModelByName(e),s=r.mode;return(0,c.forkJoin)({parameters:this._modelParametersBuilder.getModelParameters(this,t),dto:this._getDataSourceDto(e)}).pipe((0,o.mergeMap)(({parameters:i,dto:l})=>(0,c.forkJoin)({result:r.insertOrUpdate(l,i),dto:(0,c.of)(l)})),(0,o.tap)(({result:i,dto:l})=>{const d=s===m.ModelMode.Create||s===m.ModelMode.Copy,h=this.dataSchemas[e],f=h.dataSourceConfig?.type===m.DataSourceType.EntityDataSource;if(i.success&&d&&f){const _=h.primaryAttributeName,S=l[_];this._loadedDataSources.add(e),this._lastEventLoadParameters.set(e,[{type:n.ModelParameterType.PrimaryColumnValue,value:S}])}}),(0,o.map)(({result:i})=>i))}))}_deleteModel(e,t,a){return(0,c.from)(this._modelParametersBuilder.getModelParameters(this,t,a?.payload)).pipe((0,o.mergeMap)(r=>this.getModelByName(e).delete(r)))}_initSubscriptions(){return this._measurePerformanceService.measure(`ViewModel.initSubscriptions.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>(this._subscribeOnFilteringEvents(),this._subscribeModelsEvents(),this._subscribeOnChangeAttributes(),this._subscribeOnChangeRequests(),this._subscribeOnReloadDataEvents(),this._businessRulesSubscribeOnChangeAttributes(),(0,c.of)(null)))}_getDataSchemas(){if(this.models&&this.models.length!==0){const e=this.models.map(t=>t.getSchema().pipe((0,o.map)(a=>[t.name,a])));return(0,c.combineLatest)(e).pipe((0,o.take)(1),(0,o.map)(t=>Object.fromEntries(t)))}return(0,c.of)({})}_setAttributesDefaultValues(e){var t=this;return(0,c.from)((0,y.A)(function*(){let a=Object.entries(t.dataSchemas);e&&(a=a.filter(([r])=>r===e));for(const[r,s]of a){const i={};for(const l of s.attributes){const d=yield(0,c.lastValueFrom)(l.defaultValue,{defaultValue:null});if(!(0,b.isNil)(d)){const h=t.getViewModelAttributePath(r,l.name);h&&(i[h]=d)}}t.setValue(i).subscribe()}})())}_generateDataSourcesInfo(){return this._dataSourcesInfos=L.getFromViewModelConfig(this.viewModelConfig,this.models),(0,c.of)(this._dataSourcesInfos)}_generateAttributesToDataSourceNameMap(e){const t=Array.from(e.values()).map(a=>this._getDataSourceAttributesMap(a)).flat();return this._initializeAttributesToDataSourceNameMap(t),(0,c.of)(this._attributesToDataSourceNameMap)}_initializeAttributesToDataSourceNameMap(e){this._attributesToDataSourceNameMap=new Map(e)}_getDataSourceAttributesMap(e){const a=e.getMappedAttributes().map(r=>[r,e.name]);return e.isCollection&&a.push([e.collectionViewModelAttributeName,e.name]),a}_checkDataSourceName(e){if(!e)throw new Error("Data source name is not provided")}_getDataSourceLoadType(e){return e?e||n.DataSourceLoadType.Reload:null}_getLoadTypeForDataSource(e,t){if(t===n.DataSourceLoadType.Load)return t;const a=e.getPagingConfig();return!t&&a?n.DataSourceLoadType.LoadNext:t}_loadDefaultSorting(e){this._measurePerformanceService.measure(`ViewModel.mergeCollectionModels.${this._injectionContext?.id}.parent.${!!this.parent}.dsNames.${e?.toString()}`,()=>{Array.from(this._dataSourcesInfos.entries()).filter(([t])=>!e?.length||e.includes(t)).map(([,t])=>t.getSortingConfig()).filter(t=>!!t?.default).map(t=>({[t.attributeName]:t.default})).forEach(t=>this.setValue(t,{silent:!0}).subscribe())})}_getDropdownPageSize(){var e=this;return(0,y.A)(function*(){if(!(0,b.isEmpty)(e._dropdownPageSize))return e._dropdownPageSize;const t=yield e.sysSettingsService.getByCode(e._dropdownPageSizeSettingsCode);return e._dropdownPageSize={pagingConfig:{rowCount:t?.value,rowsOffset:0}},e._dropdownPageSize})()}_mergeCollectionModels(e,t){this._measurePerformanceService.measure(`ViewModel.mergeCollectionModels.${this._injectionContext?.id}.parent.${!!this.parent}.collection.${e}`,()=>{const a=this.attributes[e];this._featureValues.DisableBaseViewModelCollectionOptimization||a.length?a.merge(t):a.push(...t)})}_getEmbeddedModels(){const e=Object.entries(this.viewModelConfig?.attributes??{}).filter(([,r])=>r&&"embeddedModel"in r&&r.embeddedModel).map(([r,s])=>({attributeName:r,embeddedModel:s.embeddedModel}));if(e.length===0)return(0,c.of)([]);const t={},a=[];if(e.forEach(({attributeName:r,embeddedModel:{name:s,config:i}})=>{s?t[s]&&a.push(`Duplicated embedded model : ${s}.`):a.push(`Embedded model name is not provided for ${r}.`),t[s]=i}),a.length>0)throw new Error(a.join(" "));return this._modelGenerator.generate({dataSources:t},this.injector)}_concatModelsWithEmbedded(e=null){return this._getEmbeddedModels().pipe((0,o.map)(t=>{const a=[...e??[],...t??[]],r=a.map(s=>s.name).filter((s,i,l)=>l.indexOf(s)!==i);if(r.length>0)throw new Error(`Duplicated model names found : ${r.join(",")}.`);return a}))}_updateModelsMap(){const e=this.models.map(t=>[t.name,t]);this._modelsMap=new Map(e)}_subscribeModelsChanges(){this._subscriptions.add(this._models$.subscribe(()=>this._updateModelsMap()))}_subscribeModelsEvents(){this.models.forEach(e=>this._subscribeModelEvents(e))}_subscribeModelEvents(e){this._subscriptions.add(e.event$.pipe((0,o.mergeMap)(t=>this._waitDataDelay(t)),(0,o.mergeMap)(t=>this._ngZone.runOutsideAngular(()=>this.processRequest({type:"crt.HandleModelEventRequest",$context:this,scopes:this._eventScopes,modelName:e.name,modelEvent:t})),1)).subscribe())}initDependencies(){this.formBuilder=this.injector.get(x.FormBuilder),this.resourceFinderService=this.injector.get(m.ResourceFinderService),this.validatorTypeResolver=this.injector.get(Je),this.maskService=this.injector.get(m.DEVKIT_MASK_SERVICE),this.sysSettingsService=this.injector.get(n.SysSettingsService),this.crtControlStateAdapter=this.injector.get(G),this._businessRulesEngine=this.injector.get(E.BusinessRulesEngine),this._businessRulesApplier=this.injector.get(E.BusinessRulesApplier),this._featureValues=this.injector.get(m.FEATURE_VALUES),this._modelGenerator=this.injector.get(Fe),this._ngZone=this.injector.get(p.NgZone),this._translateService=this.injector.get(_e.TranslateService),this._scopeName=this.injector.get(Ge,null),this._attributeGenerator=this.injector.get(Ce),this._attributeResourceGenerator=this.injector.get(Xe),this._crtZoneService=this.injector.get(m.CrtZoneService),this._viewEventZoneName=this.injector.get(Jt,m.DefaultZones.Root),this._modelParametersBuilder=this.injector.get(Oe),this._context=this.injector.get(ds,null),this._crtInjectionContextService=this.injector.get(m.CrtInjectionContextsService),this._viewModelDataDelayerService=this.injector.get(ms,null),this._isDesignTime=this.injector.get(m.IS_DESIGN_TIME,null),this._measurePerformanceService=this.injector.get(m.MeasurePerformanceService,null),this._measurePerformancePageLoadService=this.injector.get(m.MeasurePerformancePageLoadService),this._appInfo=this.injector.get(m.ApplicationInfo,null)}processRequest(e){return this.handlerChain.process(e)}_upsertModel(e,t){const a=[...this.models],r=a.findIndex(({name:s})=>s===e);r===-1?a.push(t):a.splice(r,1,t).forEach(s=>s.destroy()),this._subscribeModelEvents(t),this._models$.next(a)}_replaceDataSourceInfo(e,t){!e||!t||(this._loadedDataSources.has(e)&&this._loadedDataSources.delete(e),this._dataSourcesInfos.set(e,t),this._replaceAttributesToDataSourceNameMap(t))}_updateModels(e){e.forEach((t,a)=>{const r=this.getModelByName(a);r&&(this._markModelAsCollection(r,t),this._updateModelDependentAttributes(r,t))})}_markModelAsCollection(e,t){t.isCollection&&(e._isCollection=!0)}_updateModelDependentAttributes(e,t){const a=t.attributes.map(r=>({path:r.path,type:r.type}));e.updateDependentAttributes(a)}_initIsChangedAttribute(){this._systemAttributes.push(ye),this.attributes[ye]=!1;const e=this._models$.pipe((0,o.switchMap)(t=>t?.length?(0,c.combineLatest)(t.map(a=>a._dirty$)):(0,c.of)([])),(0,o.map)(t=>t.some(a=>a)),(0,o.filter)(()=>!this._viewModelAttributeChangeEventOptions.getOptions().preventStateChange),(0,o.distinctUntilChanged)()).subscribe(t=>{this._setSystemAttributeValue(ye,t)});this._subscriptions.add(e)}_initHasUnsavedDataAttribute(){this._systemAttributes.push(ze),this.attributes[ze]=!1;const e=this.events$.pipe((0,o.filter)(i=>i?.type===P.ChangeAttributeValue&&i.payload?.attributeName===ye),(0,o.map)(i=>i.payload.value)),t=(0,c.merge)(this.IsChanged,e),r=this._models$.pipe((0,o.map)(i=>i.map(l=>l._modeChanges$.pipe((0,o.map)(d=>({mode:d,name:l.name})),(0,o.startWith)({mode:l.mode,name:l.name})))),(0,o.switchMap)(i=>i?.length?(0,c.combineLatest)(i):(0,c.of)([]))).pipe((0,o.map)(i=>i.some(({mode:l,name:d})=>(l===m.ModelMode.Create||l===m.ModelMode.Copy)&&!this._isRootModelAndDependsOnPrimaryDSByOneToManyRelation(d)))),s=(0,c.combineLatest)([t,r]).pipe((0,o.map)(([i,l])=>!!(i||l)),(0,o.distinctUntilChanged)()).subscribe(i=>{this._setSystemAttributeValue(ze,i)});this._subscriptions.add(s)}_initPrimaryModelModeAttribute(){const e=this._getPrimaryModelModeChanges();if(!e)return;this._systemAttributes.push(lt),this.attributes[lt]=this.getPrimaryModelMode();const t=e.pipe((0,o.startWith)(this.getPrimaryModelMode())).subscribe(a=>this._setSystemAttributeValue(lt,a));this._subscriptions.add(t)}_initStateAttribute(){this._systemAttributes.push(We),this.attributes[We]=bt.Active}_initBusinessRulesActivatedAttribute(){if(this._systemAttributes.push(ut),this.attributes[ut]=this._businessRulesAreActivated,this._businessRulesAreActivated)return;const e=this._businessRulesActivated$.pipe((0,o.filter)(t=>t===!0)).subscribe(t=>{this._setSystemAttributeValue(ut,t)});this._subscriptions.add(e)}_initSystemAttributes(){var e=this;return(0,y.A)(function*(){yield e._measurePerformanceService.measureCallback(`ViewModel.initSystemAttributes.${e._injectionContext?.id}.parent.${!!e.parent}`,()=>(e._initIsChangedAttribute(),e._initPrimaryModelModeAttribute(),e._initHasUnsavedDataAttribute(),e._featureValues.DisableDelayingModelEvents||e._initStateAttribute(),e._initBusinessRulesActivatedAttribute(),Promise.resolve()))})()}_handleCircularDependencies(){const e=(0,m.detectCircularDependencies)(this._modelDependencies);if(e.hasCycles){const t=this._translateService.instant("BaseViewModel.WarningModelsWithCircularDependencies");this._showNotification({message:t,duration:1e4}),console.warn(t,e.cycledModelsNames)}this._conflictedModels=e?.cycledModelsNames}_forEachControl(e,t){Object.keys(e).forEach(r=>{if(this.attributes[r]instanceof q){const s=this.attributes[r],i=e[r];s.forEach(l=>{const d=l.primaryAttributeName,h=l.attributes[d],f=i.find(_=>_[d]===h);f&&l._forEachControl(f,t)})}else if(this.attributes[r]instanceof U)this.attributes[r]._forEachControl(e[r],t);else{const s=this.getControl(r);t(s.formControl)}})}_getModelsErrors(e){return(e??[]).filter(t=>!t.isCollectionItemModel&&t.hasErrors).map(t=>t.getLastError())}_notifyAboutModelsErrors(e){const t=this._getModelsErrors(e);if(t.length>0){const a=t.map(r=>r.message).join(" ");this._showNotification({message:a})}}_initFeaturesStates(){this._disableViewModelWaitingForAsyncTasks=this._featureValues.DisableViewModelWaitingForAsyncTasks,this._disableViewModelLoadUnblockingThread=this._featureValues.DisableViewModelLoadUnblockingThread,this._blockFieldsAffectedByBusinessRules=this._featureValues.BlockFieldsWhileRunBusinessRules,this._modelSynchronizationEnabled=!this._featureValues.ModelSynchronizationDisabled}_handleAsyncTasksCycle(e){let t=null;const a=100,r=Array.from(e).filter(s=>s.startsWith(F.ProcessingAttributeChangeRequest));if(!(!e.size||!r.length))return r.length&&(t=setTimeout(()=>{console.warn("[ViewModel]: Clearing executing tasks by exceeded timeout",r),r.forEach(s=>e.delete(s)),this._asyncTasksExecutingSubject.next(e)},a)),t}_getAffectedViewModelAttributes(e,t){return this.models.filter(r=>r.dataSchemaName===e).map(r=>r.name).flatMap(r=>this.getViewModelAttributePaths(r,t))}_toggleControlsAffectedByBusinessRules(e,t){if(!this._blockFieldsAffectedByBusinessRules)return;this._attributesAffectedByBusinessRules?.filter(r=>(0,E.canToggleAttribute)(this._scopeName,r,t))?.forEach(r=>{r.scopeName===this._scopeName?this.getControl(r.name).toggle(e):this._getAffectedViewModelAttributes(r.scopeName,r.name).forEach(i=>{this.getControl(i).toggle(e)})})}_initAttributesAffectedByBusinessRules(){var e=this;return(0,y.A)(function*(){const a=e._prepareDataSourceNamesForBusinessRules().filter(s=>!!s).map(s=>e.getModelByName(s)).map(s=>({scopeId:s.name,scopeName:s.dataSchemaName,scopeType:E.ScopeType.Model,modelType:s.getDataSource()?.type})),r={scopeName:e._scopeName,scopeType:E.ScopeType.ViewModel,scopeId:e._scopeName};e._attributesAffectedByBusinessRules=yield e._businessRulesEngine.getAffectedAttributes([r,...a])})()}_initBusinessRules(){var e=this;return(0,y.A)(function*(){return e._measurePerformanceService.measureCallback(`ViewModel.initBusinessRules.${e._injectionContext?.id}.parent.${!!e.parent}`,(0,y.A)(function*(){e._businessRulesProcessingEnabled=!e._featureValues.BusinessRulesProcessingDisabled,yield e._initAttributesAffectedByBusinessRules(),e._businessRulesAreActivated=e._businessRulesProcessingEnabled&&e._businessRulesActive!==!1,e._businessRulesActivated$.next(e._businessRulesAreActivated)}))})()}_attributeGenerate$(e,t){return(0,c.of)(this._featureValues.UseDesignerHotSwapViewModel).pipe((0,o.switchMap)(a=>a&&this._isDesignTime?this._initDataSourceValidators().pipe((0,o.tap)(()=>{this._initSchemaValidators(e)}),(0,o.switchMap)(()=>this._attributeGenerate(e,t))):this._attributeGenerate(e,t)))}_validateByDataSourceName(e){var t=this;return(0,y.A)(function*(){const a={},r=t._getBoundDataSourceAttributeControls(e);return yield Promise.all(Object.entries(r).map(([s,i])=>(i.markAsTouched(),i.updateValueAndValidity(),(0,c.lastValueFrom)(ta(i).pipe((0,o.tap)(()=>{i.errors&&(a[s]=i.errors)})))))),a})()}_validateAll(){var e=this;return(0,y.A)(function*(){const t={};return e.formApiModel.markAllAsTouched(),e.formApiModel.updateValueAndValidity(),ea(e.formApiModel),yield(0,c.lastValueFrom)(ta(e.formApiModel).pipe((0,o.tap)(()=>{Object.entries(e.formApiModel.controls).forEach(([r,s])=>{s.errors&&(t[r]=s.errors)})}))),t})()}runInitFlow(e=null){return this._concatModelsWithEmbedded(e).pipe(this._measurePerformanceService.measure$(`ViewModel.runInitFlow.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,o.tap)(t=>this._notifyAboutModelsErrors(t)),(0,o.tap)(t=>this._models$.next(t)),(0,o.tap)(()=>this._initFeaturesStates()),(0,o.mergeMap)(()=>this._generateDataSourcesInfo()),(0,o.tap)(t=>this._updateModels(t)),(0,o.mergeMap)(t=>this._generateAttributesToDataSourceNameMap(t)),(0,o.mergeMap)(t=>this._getDataSchemas()),(0,o.tap)(t=>this.dataSchemas=t),(0,o.mergeMap)(()=>this._initDataSourceValidators()),(0,o.switchMap)(()=>this._initBusinessRules()),(0,o.tap)(()=>{this._initSchemaValidators(this.viewModelConfig.attributes)}),(0,o.mergeMap)(()=>(0,c.forkJoin)([...this._generateResourceAttribute(),this._initSystemAttributes(),this._attributeGenerate(this.viewModelConfig.attributes),(0,c.of)(this),this._initSubscriptions()])),(0,o.mergeMap)(()=>this._generatePrimaryAttributes()),(0,o.tap)(()=>this._loadDefaultSorting()),(0,o.mergeMap)(()=>this._runInitialBusinessRules()),(0,o.tap)(()=>this._viewModelAttributeChangeEventOptions.reset())).pipe((0,o.switchMap)(()=>(0,c.of)(this)))}get modelInitConfigs(){return this._modelsInitConfig}init(e,t){return this._primaryModelName=t?.primaryModelName,this._modelDependencies=t?.modelDependencies||{},this._modelsLoadingConfig=t?.modelsLoadingConfig||{},this._lastEventLoadParameters=new Map,t?.businessRulesActive||this.deactivateBusinessRules(),this._modelDependencies&&this._handleCircularDependencies(),this._ngZone.runOutsideAngular(()=>this.runInitFlow(e))}setValue(e,t){const a=[],r=[];for(const s of Object.keys(this._attributeConfigs))"viewModelConfig"in this._attributeConfigs[s]||"viewModelName"in this._attributeConfigs[s]?r.push(s):a.push(s);return this._executeWithOptions(()=>{this._measurePerformanceService.measure(`ViewModel.setValue.updateViewModelModelAttributes.${this._injectionContext?.id}.parent.${!!this.parent}.data.${Object.keys(e).toString()}`,()=>{for(const s in e)a.includes(s)&&(this[s]=e[s])})},t),(0,c.forkJoin)([...r.filter(s=>e&&e[s]).map(s=>{if(this.attributes[s]instanceof U)return this.attributes[s].setValue(e[s],{silent:t?.silent,preventAttributeChangeRequest:t?.preventAttributeChangeRequest,preventStateChange:t?.preventStateChange,preventRunBusinessRules:t?.preventRunBusinessRules});{const i=this._attributeConfigs[s].viewModelConfig||this._attributeConfigs[s].viewModelName,l=!this._featureValues.DisableDataGridEditingMode,d=(e[s]||[]).map(h=>{const f=this.getBoundDataSourceName(s),S=this._getDataSourceInfoByViewModelAttributePath(s)?.isCollection&&this.getModelByName(f)?.createCollectionItemModel(m.ModelMode.Update);return this.viewModelGenerator.generate({viewModelConfig:i,modelConfig:l&&S?{primaryDataSourceName:S.name}:void 0,models:l&&S?[S]:void 0,parentViewModel:this,businessRulesActive:!1},p.Injector.create({providers:[{provide:Ge,useValue:null}],parent:this.injector})).pipe(this._measurePerformanceService.measure$(`ViewModel.setValue.generateViewModel.${this._injectionContext?.id}.parent.${!!this.parent}.modelName.${S?.name}`),(0,o.tap)(M=>{f&&(M.dataSchemas[f]=this.dataSchemas[f])}),(0,o.tap)(M=>{M.deactivateBusinessRules()}),(0,o.switchMap)(M=>M.setValue(h,{silent:t?.silent,preventAttributeChangeRequest:t?.preventAttributeChangeRequest,preventStateChange:t?.preventStateChange,preventRunBusinessRules:t?.preventRunBusinessRules}).pipe((0,o.tap)(()=>S&&S.setLoadedState()),(0,o.map)(()=>M))))});return!d.length&&t?.collectionLoadType===m.CollectionLoadType.Reload&&this.attributes[s].clear(),d.length===0?(0,c.of)(null):(0,c.forkJoin)([...d]).pipe((0,o.tap)(h=>{const f=this.getBoundDataSourceName(s);this.getModelByName(f)?.childrenChange(),this._executeWithOptions(()=>{t?.collectionLoadType===m.CollectionLoadType.Reload||!t?.collectionLoadType?this.attributes[s].reload(h):this.getBoundDataSchema(s)?this._mergeCollectionModels(s,h):this.attributes[s].push(...h)},t)}))}}),(0,c.of)(this)])}deactivateBusinessRules(){this._businessRulesActive=!1}activateBusinessRules(){const e=this._businessRulesActive;if(this._businessRulesActive=!0,e)return(0,c.of)(null);const t=this.models.filter(a=>a.isLoaded);if(t.length>0){const a={type:m.BusinessRuleTriggerType.ContextReady,name:null,scopeId:""};return(0,c.forkJoin)(t.map(r=>this._runBusinessRulesForModel(r,[],!0,[a]))).pipe((0,o.tap)(()=>this._businessRulesAreActivated=this._businessRulesProcessingEnabled),(0,o.tap)(()=>this._businessRulesActivated$.next(this._businessRulesAreActivated)))}}_getModelDependencies(e){return this._modelDependencies[e]??[]}_getIsAffectedByBusinessRules(e){if(!this._businessRulesProcessingEnabled)return Promise.resolve(!1);const t=e.name,a=this._attributesAffectedByBusinessRules;if(a.length===0||!t)return Promise.resolve(!1);const r=a.some(d=>d.name===t),s=this.getBoundDataSchemaByAttributePath(t),i=this.getBoundDataSchemaAttributeByAttributePath(t);if(!i)return Promise.resolve(r);const l=a.filter(d=>d.scopeName===s.name).some(d=>d.name===i.name);return Promise.resolve(l||r)}executeRequest(e){return e.scopes=e.scopes||this._eventScopes,this._crtZoneService.runInZone(this._viewEventZoneName,()=>this.processRequest(e))}getAttributeControl(e){let t=this.formApiModel;gs(this,e).then(b.noop);for(const a of e.split("."))t=t.get(a);return t??new x.FormControl}loadLookupList(e,t=[],a){const r=e.control,s=e.items,i=this._getDataSourceInfoByViewModelAttributePath(s);if(i){const l=this._ngZone.runOutsideAngular(()=>this.processRequest({type:"crt.LoadDataRequest",$context:this,dataSourceName:i.name,parameters:t,config:{payload:a}}));Promise.resolve(l)}else{const l=this._getDataSourceInfoByViewModelAttributePath(r);if(l){const d=l.getDataSourceAttributePath(r);(0,c.forkJoin)([this._getDropdownPageSize(),this._modelParametersBuilder.getModelParameters(this,t,a)]).pipe((0,o.mergeMap)(([h,f])=>this.getModelByName(l.name).loadLookupList(d,f,h)),(0,o.map)(h=>L.getLookupListDataSourceInfo(s,{value:h.primaryAttributeName,displayValue:h.primaryDisplayAttributeName}).getModelDto(h.data)),(0,o.mergeMap)(h=>this.setValue(h,{silent:!0}))).subscribe()}}}load(...e){const t=this._disableViewModelLoadUnblockingThread?(0,c.of)(null):(0,c.timer)(0,c.asyncScheduler);if(typeof e[0]=="string"){const r=e[0],s=e[1],i=e[2];this._checkDataSourceName(r);const l=this._getDataSourceLoadType(i?.loadType);return t.pipe((0,o.switchMap)(()=>this._loadStaticModel(r,s,l,i?.payload,i?.useLastLoadParameters,i?.doNotUpdateLastLoadParameters).pipe(this._measurePerformanceService.measure$(`ViewModel.loadStaticModel.${this._injectionContext?.id}.parent.${!!this.parent}.datasourceName.${r}`))))}const a=e[0];return t.pipe((0,o.switchMap)(()=>this._loadDynamicModel(a).pipe(this._measurePerformanceService.measure$(`ViewModel.loadDynamicModel.${this._injectionContext?.id}.parent.${!!this.parent}.model.${a.dataSourceName}`))))}setSorting(e,t){const r=this._dataSourcesInfos.get(e).getSortingConfig(),s=r&&r.attributeName;return s&&(this[s]=t),(0,c.of)(null)}create(e,t){return this._checkDataSourceName(e),this._createModelData(e,t)}copy(e,t,a){return this._checkDataSourceName(e),this._copyModelData(e,t,a)}loadDefaultValues(e){return this._setAttributesDefaultValues(e)}save(e,t,a){return(0,c.from)(this.waitAsyncTasksFinish()).pipe((0,o.switchMap)(()=>(this._checkDataSourceName(e),this.getModelMode(e)===m.ModelMode.Delete?this.delete(e,t,a):this._saveModel(e,t,a))))}delete(e,t,a){return this._checkDataSourceName(e),this._deleteModel(e,t,a)}resume(){return(0,c.of)(void 0)}pause(){return(0,c.of)(void 0)}destroy(){this._subscriptions.unsubscribe(),Array.from(this._collectionSubscription.values()).forEach(t=>t.unsubscribe()),this._collectionSubscription.clear(),this._crtControls.forEach(t=>{t.destroy()}),this.models?.forEach(t=>t.destroy()),this._crtControls.clear(),this._eventsSubject$.complete(),this._replayEvents$.complete(),this._modelLoaded$.complete();const e=[];for(const t of Object.values(this.attributes))t instanceof U&&e.push(t.destroy()),t instanceof q&&e.push((0,c.from)(t.destroy()));return(0,c.forkJoin)(e).pipe((0,o.defaultIfEmpty)(void 0),(0,o.map)(()=>{}),(0,o.finalize)(()=>{this.parent||(this._crtInjectionContextService.removeContext(this._injectionContext?.id),(0,n.callOnContextDestroyHooks)(this._injectionContext),this._context=null,this._viewModelDataDelayerService?.destroy(),this._viewModelDataDelayerService=null),this._asyncTasksExecutingSubject.complete(),this._dataSourcesInfos.clear(),this.__destroyed=!0,this._destroySubject.next(),this._destroySubject.complete()}))}getBoundDataSourceName(e){if(this._attributesToDataSourceNameMap.has(e))return this._attributesToDataSourceNameMap.get(e);const t=Array.from(this._attributesToDataSourceNameMap.keys()).find(a=>a.includes(".")&&a.split(".")[1]===e);return this._attributesToDataSourceNameMap.has(t)?this._attributesToDataSourceNameMap.get(t):null}_getBoundDataSourceAttributeControls(e){return Object.fromEntries(Array.from(this._attributesToDataSourceNameMap.entries()).filter(([t,a])=>a===e).map(([t])=>[t,this.getAttributeControl(t)]))}getBoundDataSourceAttributeControls(e){return Object.values(this._getBoundDataSourceAttributeControls(e))}getBoundDataSourceNameByAttributePath(e){return this._attributesToDataSourceNameMap.has(e)?this._attributesToDataSourceNameMap.get(e):null}getBoundDataSchema(e){return this.dataSchemas[this.getBoundDataSourceName(e)]}getBoundDataSchemaByAttributePath(e){return this.dataSchemas[this.getBoundDataSourceNameByAttributePath(e)]??null}getBoundDataSchemaAttributeByAttributePath(e){const t=this.getBoundDataSourceNameByAttributePath(e),a=this.getBoundDataSchemaByAttributePath(e);if(!t||!a)return null;const s=this._getDataSourceInfoByViewModelAttributePath(e).getDataSourceAttributePath(e);return a.findAttributeByName(s)}getPrimaryModelName(){return Promise.resolve(this._primaryModelName)}getPrimaryDataSchema(){return this.getPrimaryModelName().then(e=>this.dataSchemas[e])}isValid(e){const t=this._waitAsyncValidation().pipe((0,o.map)(()=>e?this.getBoundDataSourceAttributeControls(e).every(a=>!a.invalid):this.formApiModel.valid));return(0,c.lastValueFrom)(t)}validate(e){return this._ngZone.run(()=>e?this._validateByDataSourceName(e):this._validateAll())}getViewModelAttributePath(e,t){const a=this._dataSourcesInfos.get(e);return this._getMappedAttributeName(a,t)}getViewModelAttributePaths(e,t){return this._dataSourcesInfos.get(e)?.getMappedAttributeNames(t)}getCollectionViewModelAttributePath(e){return this._dataSourcesInfos.get(e)?.collectionViewModelAttributeName}canDelete(e,t){var a=this;return(0,y.A)(function*(){return a.getModelByName(e).canDelete(t)})()}canSave(e,t){var a=this;return(0,y.A)(function*(){return a.getModelByName(e).canSave(t)})()}enableAttributeValidator(e,t){this.getControl(e).enableValidator(t)}disableAttributeValidator(e,t){this.getControl(e).disableValidator(t)}_hotSwap(e){return this._measurePerformanceService.measure(`ViewModel.generatePrimaryAttributes.${this._injectionContext?.id}.parent.${!!this.parent}.hotSwap`,()=>{const t=e?.attributes?.changed||[],a=(0,b.isEmpty)(e.resources?.strings);if((0,b.isEmpty)(t)&&a)return(0,c.of)(!1);a||(this.resources={strings:this._getChangedResourcesStrings(e.resources.strings)}),this.viewModelConfig=e.actualViewModelConfig;const r=L.getFromViewModelConfig(this.viewModelConfig),s=Object.fromEntries(t.map(_=>[_,this.viewModelConfig.attributes[_]])),i=e?.models?.changed??[],l=i.map(_=>_.name),d=this.models.filter(_=>_.isLoaded||_.isLoading).filter(_=>l.includes(_.name)).map(_=>_.name),h=i.map(_=>{const S=r.get(_.name);return this._upsertModel(_.name,_),this._replaceDataSourceInfo(_.name,S),this._addDataSchemaToDataSchemas(_)}),f=this._attributeGenerate$(s,{disableDefaultConfig:!0});return(0,c.forkJoin)([...h,f]).pipe(this._measurePerformanceService.measure$(`ViewModel.generatePrimaryAttributes.${this._injectionContext?.id}.parent.${!!this.parent}.hotSwap.forkJoin`),(0,o.switchMap)(()=>this._reGenerateResourcesAttributes()),(0,o.tap)(()=>this._loadDefaultSorting(l)),(0,o.tap)(()=>this._requestReloadModels(d)),(0,o.map)(()=>!0))})}_setAttributeValue(e,t,a){this._executeWithOptions(()=>this[e]=t,a)}set(e,t,a){return this._setAttributeValue(e,t,a),Promise.resolve()}_markAsPristine(e){this._forEachControl(e,t=>t.markAsPristine())}getAttributeNameByViewItemName(e){return Object.keys(this._attributeConfigs).find(t=>this._attributeConfigs[t].viewItemName===e)}getControl(e){return this._crtControls.has(e)?this._crtControls.get(e):Se.create({name:e,value:null,propertiesConfig:[]})}getAttributePropertyValue(...e){let t,a;if(e.length===2)t=e[0],a=e[1];else if(e.length===1){const s=e[0].split(":");t=s[0],a=s[1]}else throw new Error("ArgumentException");return this.getControl(t).getPropertyValue(a)}setAttributePropertyValue(...e){let t,a,r;if(e.length===3)t=e[0],a=e[1],r=e[2];else if(e.length===2){const i=e[0].split(":");t=i[0],a=i[1],r=e[1]}else throw new Error("ArgumentException");return this.getControl(t).setPropertyValue(a,r)}resetAttributePropertyValue(...e){let t,a;if(e.length===1)[t,a]=e[0].split(":");else if(e.length===2)t=e[0],a=e[1];else throw new Error("ArgumentException");this.getControl(t).getPropertyByName(a)?.resetValue()}getInvariabilityPropertyName(e){return this.getControl(e).getInvariabilityPropertyName()}setModelValues(e,t){return this.getModelByName(e).setValue(t)}_getBoundAttributesNames(e){const t=this.getBoundDataSourceNameByAttributePath(e);if(!t)return null;const a=this._dataSourcesInfos.get(t),r=a.attributesMap.get(e);return Array.from(a.attributesMap.entries()).filter(([s,i])=>i===r&&s!==e).map(([s])=>s)}_getAttributeDataValueTypeName(e){return this._attributeConfigs[e].dataValueTypeName}getDataSourceLoadParameters(e,t){const a=this._dataSourcesInfos.get(e);return a?this._modelParametersBuilder.getModelLoadParameters(this,a,[],n.DataSourceLoadType.Load,{modelLoadConfiguration:t}).then(([r,s,i])=>({parameters:r,options:{pagingConfig:s,sortingConfig:i}})):null}isDataSourceForCollection(e){return!!this._dataSourcesInfos.get(e)?.isCollection}_getDataSourceAttributeDataValueType(e){const t=this._getDataSourceInfoByViewModelAttributePath(e);let a=null;if(t){const r=t.getDataSourceAttributePath(e);r&&(a=this._getDataSourceAttributeSchema(t,r)?.dataValueType)}return a}_getModelNamesByLoadType(e){return Object.entries(this._modelsLoadingConfig).filter(([t,a])=>a.type===e).map(([t,a])=>t)}_reloadDependentModels(e,t=[]){const a=this._getDependentModelsForLoad(e,t);this._requestReloadModels(a)}_getDependentModelsForLoad(e,t=[]){const a=this._getDependentModelsNames(e.name,t),r=this._getChangedModelsNames(a).filter(s=>!Q(this.getModelByName(s)));return r.length!==0&&this._showNotification({message:"BaseViewModel.RefreshModelDataConflict"}),a.filter(s=>!r.includes(s)).filter(s=>this._modelsRequestedToLoad.has(s)||Q(this.getModelByName(s)))}getIsDirty(e){return this.getControl(e).isDirty}getModelByName(e){return this._modelsMap.get(e)}getModelMode(e){return this.getModelByName(e)?.mode}getPrimaryModelMode(){return this.getModelMode(this._primaryModelName)}_getModelModeChanges(e){return this.getModelByName(e)?._modeChanges$}_getPrimaryModelModeChanges(){return this._getModelModeChanges(this._primaryModelName)}markModelFor(e,t){this.getModelByName(e)?.markFor(t)}markPrimaryModelFor(e){this.markModelFor(this._primaryModelName,e)}_setStateAttribute(e){this._setSystemAttributeValue(We,e)}_onAsyncTaskStarted(e){if(this._disableViewModelWaitingForAsyncTasks)return;const t=this._asyncTasksExecutingSubject.value;t.add(e),this._asyncTasksExecutingSubject.next(t)}_onAsyncTaskFinished(e){if(this._disableViewModelWaitingForAsyncTasks)return;const t=this._asyncTasksExecutingSubject.value;t.delete(e),this._asyncTasksExecutingSubject.next(t)}waitAsyncTasksFinish(){let e;return(0,c.firstValueFrom)(this._asyncTasksExecutingSubject.pipe((0,o.tap)(t=>{clearTimeout(e),e=this._handleAsyncTasksCycle(t)}),(0,o.filter)(t=>t.size===0),(0,o.take)(1),(0,o.map)(()=>{})))}}function Di(u){return(e,t,a)=>{const r=a.value;a.value=function(){var s=(0,y.A)(function*(i){if(!i||i.trackUnsavedData===!1)return r.call(this,i);if(yield vi(u,i))return r.call(this,i)});return function(i){return s.apply(this,arguments)}}()}}function vi(u,e){return ya.apply(this,arguments)}function ya(){return ya=(0,y.A)(function*(u,e){const t=yield Pi(u?.context,e);if(!t)return!0;const a=u?.collectionAttributeName,r=a?{type:"crt.CanDiscardUnsavedCollectionDataRequest",$context:t,scopes:e?.scopes,collectionAttributeName:yield Ei(a,e)}:{type:"crt.CanDiscardUnsavedDataRequest",$context:t,scopes:e?.scopes};return yield n.HandlerChainService.instance.process(r)}),ya.apply(this,arguments)}function Pi(u,e){const t=e.$context;return u==="current"?Promise.resolve(t):!u||u==="root"?Promise.resolve(Me(t)):u(e)}function Ei(u,e){return typeof u=="string"?Promise.resolve(u):u(e)}class et{static{this.\u0275fac=function(t){return new(t||et)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:et,factory:et.\u0275fac})}}const js=new p.InjectionToken("A factory of expression interpreter");let Pt=class extends n.BaseRequestHandler{constructor(e){super(),this._ngZone=e}_validateRequest(e){const{$context:t,collectionAttributeName:a}=e;if(!t)throw new Error('The "$context" request property is not specified.');if(!a)throw new Error('The "collectionAttributeName" request property is not specified.');const r=t._attributeConfigs[a];if(!(("viewModelConfig"in r||"viewModelName"in r)&&r.isCollection))throw new Error(`There is no view model collection for the specified "${a}" attribute.`)}_canCancelPrimaryDataChanges(e,t){var a=this;return(0,y.A)(function*(){if(!t)return!0;const r=yield a._getPrimaryAttributeValue(e);return t.includes(r)})()}_getPrimaryAttributeValue(e){return(0,y.A)(function*(){const t=yield e.getPrimaryModelName(),a=yield e.getPrimaryDataSchema(),r=e.getViewModelAttributePath(t,a.primaryAttributeName);return e[r]})()}_resetFormApiModel(e){this._ngZone.run((0,y.A)(function*(){const t=yield e.getPrimaryModelName();e.getBoundDataSourceAttributeControls(t)?.forEach(r=>{ht(r)})}))}_cancelPrimaryDataChanges(e){var t=this;return(0,y.A)(function*(){try{const a={type:"crt.CancelPrimaryDataChangesRequest",$context:e};return yield t.handlerChain.process(a)}catch(a){return[{success:!1,errorInfo:a?.message}]}})()}handle(e){var t=this;return(0,y.A)(function*(){t._validateRequest(e);const{$context:a,collectionAttributeName:r,primaryAttributeValues:s}=e??{},i=yield a.attributes[r],l=i.getChangedItems(),d=[];for(const f of l)(yield t._canCancelPrimaryDataChanges(f,s))&&d.push(t._cancelPrimaryDataChanges(f));for(const f of i)l.includes(f)||t._resetFormApiModel(f);return(yield Promise.all(d)).flat()})()}};Pt=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.CancelCollectionPrimaryDataHandler",requestType:"crt.CancelCollectionPrimaryDataChangesRequest"}),(0,g.__metadata)("design:paramtypes",[p.NgZone])],Pt);let Et=class extends n.BaseRequestHandler{_validateRequest(e){const{$context:t}=e;if(!t)throw new Error('The "$context" request property is not specified.')}_cancelCurrentDataChanges(e){var t=this;return(0,y.A)(function*(){const a=e.getPrimaryModelMode();if(a===m.ModelMode.Create){const r=yield e.getPrimaryModelName();return e.getModelByName(r).getDataSource().scope===n.DataSourceScope.ViewElement&&e.markPrimaryModelFor(m.ModelMode.Delete),Promise.resolve({success:!0})}return a===m.ModelMode.Delete&&e.markPrimaryModelFor(m.ModelMode.Update),(yield e.IsChanged)?t._reloadCurrentDataChanges(e):Promise.resolve({success:!0})})()}_reloadCurrentDataChanges(e){var t=this;return(0,y.A)(function*(){try{return yield t._loadPrimaryData(e),yield t._onSuccessCancelPrimaryData(e),{success:!0}}catch(a){const r=a?.message;return t._onFailCancelPrimaryData(e,r),{success:!1,errorInfo:r}}})()}_loadPrimaryData(e){var t=this;return(0,y.A)(function*(){const a=yield e.getPrimaryModelName(),r=yield e.getPrimaryDataSchema(),s=e.getViewModelAttributePath(a,r.primaryAttributeName);yield t.handlerChain.process({type:"crt.LoadDataRequest",$context:e,dataSourceName:a,parameters:[{type:n.ModelParameterType.PrimaryColumnValue,value:s}]})})()}_onFailCancelPrimaryData(e,t){e.formApiModel.setErrors({cancel:{message:t}})}_onSuccessCancelPrimaryData(e){return(0,y.A)(function*(){const t=yield e.getPrimaryModelName();e.getBoundDataSourceAttributeControls(t)?.forEach(r=>{ht(r)})})()}_cancelNestedDataChanges(e){var t=this;return(0,y.A)(function*(){const a=[],r=Object.entries(e._attributeConfigs);for(const[i,l]of r)if(!(!("viewModelConfig"in l)&&!("viewModelName"in l)))if(l.isCollection)a.push(t._cancelPrimaryDataSafely(()=>t._cancelCollectionPrimaryDataChanges(e,i)));else{const d=yield e[i];a.push(t._cancelPrimaryDataSafely(()=>t._cancelPrimaryDataChanges(d)))}return(yield Promise.all(a)).flat()})()}_cancelPrimaryDataChanges(e){var t=this;return(0,y.A)(function*(){const a={type:"crt.CancelPrimaryDataChangesRequest",$context:e};return yield t.handlerChain.process(a)})()}_cancelCollectionPrimaryDataChanges(e,t){var a=this;return(0,y.A)(function*(){const r={type:"crt.CancelCollectionPrimaryDataChangesRequest",$context:e,collectionAttributeName:t};return yield a.handlerChain.process(r)})()}_cancelPrimaryDataSafely(e){return e().catch(t=>[{success:!1,errorInfo:t?.message}])}handle(e){var t=this;return(0,y.A)(function*(){t._validateRequest(e);const a=e.$context,r=yield t._cancelNestedDataChanges(a);return[yield t._cancelCurrentDataChanges(a),...r]})()}};Et=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.CancelPrimaryDataChangesHandler",requestType:"crt.CancelPrimaryDataChangesRequest"})],Et);let Sa=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.ChangeViewModelAttributeValueRequest"}};Sa=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.ChangeViewModelAttributeValueRequest"})],Sa);let Ma=class extends n.BaseRequestHandler{handle(e){return(0,y.A)(function*(){const{$context:t,attributeName:a,attributeValue:r}=e||{};if(!t||!a)return;const s=t;return yield(0,c.lastValueFrom)(s.setValue({[a]:r}),{defaultValue:null}),r})()}};Ma=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.ChangeViewModelAttributeValueHandler",requestType:"crt.ChangeViewModelAttributeValueRequest"})],Ma);let Vt=class extends n.BaseRequestHandler{_validateRequest(e){const{$context:t,collectionAttributeName:a}=e;if(!t)throw new Error('The "$context" request property is not specified.');if(!a)throw new Error('The "collectionAttributeName" request property is not specified.');const r=t._attributeConfigs[a];if(!(("viewModelConfig"in r||"viewModelName"in r)&&r.isCollection))throw new Error(`There is no view model collection for the specified "${a}" attribute.`)}_canSavePrimaryData(e,t){var a=this;return(0,y.A)(function*(){if(!t)return!0;const r=yield a._getPrimaryAttributeValue(e);return t.includes(r)})()}_getPrimaryAttributeValue(e){return(0,y.A)(function*(){const t=yield e.getPrimaryModelName(),a=yield e.getPrimaryDataSchema(),r=e.getViewModelAttributePath(t,a.primaryAttributeName);return e[r]})()}_savePrimaryData(e){var t=this;return(0,y.A)(function*(){try{const a={type:"crt.SavePrimaryDataRequest",$context:e};return yield t.handlerChain.process(a)}catch(a){return[{success:!1,rowsAffected:0,errorInfo:a?.message}]}})()}handle(e){var t=this;return(0,y.A)(function*(){t._validateRequest(e);const{$context:a,collectionAttributeName:r,primaryAttributeValues:s}=e??{},l=a.attributes[r].getChangedItems(),d=[];for(const h of l)(yield t._canSavePrimaryData(h,s))&&d.push(yield t._savePrimaryData(h));return d.flat()})()}};Vt=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.SaveCollectionPrimaryDataHandler",requestType:"crt.SaveCollectionPrimaryDataRequest"})],Vt);function Us(u,e){if(!u||!e)return c.EMPTY;const t=e.events$.pipe((0,o.filter)(a=>a.type===P.ChangeAttributeValue),(0,o.filter)(a=>a.payload.attributeName===u),(0,o.switchMap)(()=>e[u]));return new c.Observable(a=>(u in e?(0,c.merge)((0,c.from)(e[u]),t):t).subscribe(a))}class ba{}class J extends ba{getChanges(e,t,a){const r=e.map(s=>Us(s,a));return(0,c.combineLatest)(r)}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(J)))(a||J)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:J,factory:J.\u0275fac})}}class ${constructor(e){this._converterExpressionInterpreter=e?.create("converter")}_getConverterFn(e,t,a){if(!e||!this._converterExpressionInterpreter)return(0,c.of)(a);const r={viewModel$:(0,c.of)(t),parent:null};return this._converterExpressionInterpreter.evaluate(e,r)}evaluate(e){const{args:t,expression:a,context:r,defaultEvaluationFn:s}=e;return this._getConverterFn(a,r,s).pipe((0,o.switchMap)(i=>{const l=i(t);return l instanceof Promise?l:Promise.resolve(l)}))}static{this.\u0275fac=function(t){return new(t||$)(p.\u0275\u0275inject(js,8))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:$,factory:$.\u0275fac})}}function $s(u,e){if(!u||!e)return c.EMPTY;const t=new c.ReplaySubject(1),a=n.HandlerChainService.instance.subscribe(r=>{r.type===u&&t.next(r)},e);return e._subscriptions.add(a),t}const Vi=100;class ne extends ba{constructor(e){super(),this._converterEvaluator=e}_accumulateRequests(e,t,a){const r=new c.BehaviorSubject([]),s=this._accumulateRequestsCombinations(e,r,t,a).subscribe();return new c.Observable(i=>(r.complete(),s.unsubscribe(),this._findAcceptableRequestsCombination(r.value,t,a).pipe((0,o.switchMap)(l=>l?(0,c.merge)((0,c.of)(l),e):e)).subscribe(i)))}_accumulateRequestsCombinations(e,t,a,r){return e.pipe((0,o.map)(s=>[s,...t.value]),(0,o.switchMap)(s=>s.length<Vi?(0,c.of)(s):this._findAcceptableRequestsCombination(s,a,r).pipe((0,o.map)(i=>i?[i]:[]))),(0,o.tap)(s=>t.next(s)),(0,o.map)(()=>{}))}_findAcceptableRequestsCombination(e,t,a){if(!e.length)return(0,c.of)(null);const{filter:r,originalFrom:s}=t;return(0,c.from)(e).pipe((0,A.concatMapWith)(i=>this._converterEvaluator.evaluate({args:Array.isArray(s)?i:i[0],context:a,expression:r})),(0,o.first)(([,i])=>!!i,[null]),(0,o.map)(([i])=>i))}getChanges(e,t,a){const r=e.map(i=>$s(i,a)),s=(0,c.combineLatest)(r);return t.filter?this._accumulateRequests(s,t,a):s}static{this.\u0275fac=function(t){return new(t||ne)(p.\u0275\u0275inject($))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:ne,factory:ne.\u0275fac})}}const Aa=new p.InjectionToken("Represents a factory of calculated attribute source changes providers"),Hs=A.FactoryProvider.create({token:Aa,mappings:[{predicate:u=>u.every(e=>n.RequestRegistryService.requestsRegistrationInfos.has(e)),injectable:ne}],default:{injectable:J}});class zs{}class Ws extends zs{constructor(e){super(),this._converterEvaluator=e}getTrigger(e,t){return this.getTriggerInternal(e,t).pipe((0,A.concatMapWith)(a=>this._converterEvaluator.evaluate({args:a,expression:e?.filter,context:t,defaultEvaluationFn:()=>!0})),(0,o.filter)(([,a])=>!!a),(0,o.map)(()=>{}))}}class oe extends Ws{constructor(e){super(e)}getTriggerInternal(e,t){return Us(e?.attribute,t)}static{this.\u0275fac=function(t){return new(t||oe)(p.\u0275\u0275inject($))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:oe,factory:oe.\u0275fac})}}class le extends Ws{constructor(e){super(e)}getTriggerInternal(e,t){return new c.Observable(a=>$s(e?.request,t).subscribe(a))}static{this.\u0275fac=function(t){return new(t||le)(p.\u0275\u0275inject($))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:le,factory:le.\u0275fac})}}const Ca=new p.InjectionToken("Represents a factory of calculated attribute trigger providers");function Ti(u){let e=[];return typeof u=="string"&&(e=[u]),Array.isArray(u)&&(e=u),e.map(t=>typeof t=="string"&&t?.trim()).filter(Boolean)}function Ni(u){return(u??[]).filter(e=>Da(e)||Ra(e))}function Ii(u){const e=u.map(r=>n.RequestRegistryService.requestsRegistrationInfos.has(r)),t=e.includes(!0),a=e.includes(!1);return t&&a}function Ra(u){return!!u&&"attribute"in u&&!!u.attribute}function Da(u){return!!u&&"request"in u&&!!u.request}function Gs(u){const e=Ti(u.from),t=Ni(u.triggers),{from:a,filter:r,converter:s,change:i,triggersOptions:l}=u;return e.length===0&&t.length===0?(console.error(`Both 'from' and 'triggers' properties of calculated attribute cannot be empty: ${JSON.stringify(u)}.`),null):e.length===0&&!s?(console.error(`Converter is required in a calculated attribute if there are 'triggers' and no 'from': ${JSON.stringify(u)}.`),null):Ii(e)?(console.error(`Simultaneous specification of attributes and request in the "from" property of calculated attribute is not supported: ${JSON.stringify(u)}.`),null):(e.length===0&&r&&console.warn(`Filter is skipped in a calculated attribute if there are 'triggers' and no 'from': ${JSON.stringify(u)}.`),{from:e,originalFrom:a,filter:e.length?r:void 0,converter:s,triggers:t,triggersOptions:{debounce:l?.debounce??0},change:i})}const Js=A.FactoryProvider.create({token:Ca,mappings:[{predicate:Ra,injectable:oe},{predicate:Da,injectable:le}]}),wi=u=>!0,xi=u=>u;class ue{constructor(e,t,a,r){this._converterEvaluator=e,this._attributeSourcesChangesProviderFactory=t,this._attributeTriggerProviderFactory=a,this._measurePerformanceService=r}_createCalculateAttributeValueFn(e,t){const{viewModel:a,attribute:r,generateOptions:s}=e,{originalFrom:i,filter:l,converter:d}=t,h=Array.isArray(i);return f=>f.pipe((0,o.map)(_=>h?_:_?.[0]),(0,A.concatMapWith)(_=>this._converterEvaluator.evaluate({args:_,expression:l,context:a,defaultEvaluationFn:wi})),(0,o.filter)(([,_])=>!!_),(0,o.concatMap)(([_])=>this._converterEvaluator.evaluate({args:_,expression:d,context:a,defaultEvaluationFn:xi})),(0,o.map)(_=>{const S=a.attributes[r];return[(0,b.cloneDeep)(_),(0,b.cloneDeep)(S)]}),(0,o.filter)(([_,S])=>!(0,b.isEqual)(_,S)),(0,o.tap)(([_,S])=>{a.attributes[r]=_,s?.onChangeAttributeValue(r,_,S)}),(0,o.map)(([_])=>_))}_createGetAttributeValueFn(e){const{viewModel:t,attributeName:a,attributeConfig:r,calculateAttributeFn:s}=e;let i;const l=this._getAttributeSourcesStream(r,t);return()=>{const d=a in t.attributes;return i?d?(0,c.of)(t.attributes[a]):i:(i=s(l).pipe((0,o.shareReplay)({bufferSize:1,refCount:!0})),t._subscriptions.add(i.subscribe()),i)}}_getAttributeSourcesStream(e,t){const a=this._getAttributeTriggers(e,t),r=this._getAttributeSourcesChanges(e,t);if(!a)return r;const s=e.triggersOptions.debounce;return r?(0,c.merge)(a.pipe((0,o.debounceTime)(s)),r).pipe((0,o.withLatestFrom)(r),(0,o.map)(([,i])=>i)):a.pipe((0,o.startWith)(void 0),(0,o.debounceTime)(s))}_getAttributeTriggers(e,t){const{triggers:a}=e,r=a.map(s=>this._attributeTriggerProviderFactory.create(s)?.getTrigger(s,t)).filter(Boolean);return r.length===0?null:(0,c.merge)(...r)}_getAttributeSourcesChanges(e,t){const{from:a}=e;return a.length===0?null:this._attributeSourcesChangesProviderFactory.create(a).getChanges(a,e,t)}_defineCalculatedAttribute(e,t,a){Object.defineProperty(a,e,{get:()=>(0,c.firstValueFrom)(t(),{defaultValue:null}),configurable:!0})}defineAttribute(e){this._measurePerformanceService.measure(`CalculatedAttributeCreator.defineAttribute.${e.attribute}`,()=>{const{viewModel:t,attribute:a,attributeConfig:r}=e,s=Gs(r);if(s===null)return;const i=this._createCalculateAttributeValueFn(e,s),l=this._createGetAttributeValueFn({attributeName:a,attributeConfig:s,calculateAttributeFn:i,viewModel:t});this._defineCalculatedAttribute(a,l,t)})}static{this.\u0275fac=function(t){return new(t||ue)(p.\u0275\u0275inject($),p.\u0275\u0275inject(Aa),p.\u0275\u0275inject(Ca),p.\u0275\u0275inject(m.MeasurePerformanceService))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:ue,factory:ue.\u0275fac,providedIn:"root"})}}class ke{static{this.\u0275fac=function(t){return new(t||ke)}}static{this.\u0275mod=p.\u0275\u0275defineNgModule({type:ke})}static{this.\u0275inj=p.\u0275\u0275defineInjector({providers:[ue,$,oe,le,J,ne,Hs,Js]})}}class ce{constructor(e,t){this.ngZone=e,this.measurePerformanceService=t}innerDefineAttribute(e,t){this.measurePerformanceService.measure(`DefaultAttributeCreator.defineAttribute.${e.attribute}`,()=>{const a=e.viewModel,r=a.attributes,s=e.attribute,i=e.attributeConfig,l=e.control,d=f=>{r[s]=f,this.ngZone.run(()=>{const _=a._viewModelAttributeChangeEventOptions?.getAsSilent();l.setValue(f,_),t?.call(this,f)})},h=()=>l.value;Ke.defineAsyncAttribute(a,s,i,h,d)})}defineAttribute(e){this.innerDefineAttribute(e)}static{this.\u0275fac=function(t){return new(t||ce)(p.\u0275\u0275inject(p.NgZone),p.\u0275\u0275inject(m.MeasurePerformanceService))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:ce,factory:ce.\u0275fac,providedIn:"root"})}}class Be extends ce{constructor(e,t){super(e,t)}defineAttribute(e){this.innerDefineAttribute(e,t=>{e?.viewModel?.setAttributePropertyValue(e?.attribute,"displayColor",t?.primaryColorValue)})}static{this.\u0275fac=function(t){return new(t||Be)(p.\u0275\u0275inject(p.NgZone),p.\u0275\u0275inject(m.MeasurePerformanceService))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Be,factory:Be.\u0275fac,providedIn:"root"})}}class Z extends Je{constructor(e){super(e)}getValidator(e,t){const a=n.ValidatorRegistry.items.get(e);if(!a)throw new Error(`Validator '${e}' was not registered`);if(a.lazy&&!a.instantiate)throw new Error(`Lazy module with ${e} validator is not loaded`);return a.instantiate(t?.injectionContext)}static{this.\u0275fac=function(t){return new(t||Z)(p.\u0275\u0275inject(p.Injector))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Z,factory:Z.\u0275fac})}}class je{constructor(e){this.injector=e,this._schemaValidators=new Map}register(e,t){if((0,n.checkTypeNameFormat)(e.type,"ValidatorTypeName"),(0,n.checkCrtTypeNamePascalCase)(e.type),this._schemaValidators.has(e.type))throw new Error(`Error when register ${e.type} type. Element with this type has already exist`);this._schemaValidators.set(e.type,{instanceType:t,instanceConfig:e})}clearSchemaValidators(){this._schemaValidators.clear()}has(e){return this._schemaValidators.has(e)}get(e,t){const r=this._schemaValidators.get(e)?.instanceType;if(!r)throw new Error(`Validator '${e}' was not registered`);return new r(this.injector)}static{this.\u0275fac=function(t){return new(t||je)(p.\u0275\u0275inject(p.Injector))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:je,factory:je.\u0275fac})}}class tt extends Z{constructor(e,t){super(t),this._schemaValidatorRegistry=e}getValidator(e,t){return this._schemaValidatorRegistry.has(e)?this._schemaValidatorRegistry.get(e,t?.validationParameters):super.getValidator(e,t)}static{this.\u0275fac=function(t){return new(t||tt)(p.\u0275\u0275inject(je),p.\u0275\u0275inject(p.Injector))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:tt,factory:tt.\u0275fac})}}class qi extends N{constructor(){super(...arguments),this.async=!1}validate(e){return null}}class at extends Z{constructor(e){super(e)}getValidator(e,t){try{return super.getValidator(e,t)}catch{return new qi(this.injector)}}static{this.\u0275fac=function(t){return new(t||at)(p.\u0275\u0275inject(p.Injector))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:at,factory:at.\u0275fac})}}class de{constructor(e){this._translateService=e}_getAttributesCaptions(e,t){const a=t.map(r=>{const s=e._attributeConfigs[r];return s&&s.caption?Promise.resolve(s.caption):e[m.SchemaResourcesSuffix][m.TypeResources.string][r].then(i=>i||r)});return Promise.all(a)}_getFirstValidationError(e){const t=Object.entries(e??{});if(t.length===0)return null;const a=t[0][1];return Object.entries(a)[0]}getValidationErrorMessage(e,t){var a=this;return(0,y.A)(function*(){const r=a._getFirstValidationError(t);if(!r)return"";const s=r[0],i=r[1].message,d=Object.entries(t).filter(([_,S])=>Object.keys(S).includes(s)).map(([_,S])=>_),h=(yield a._getAttributesCaptions(e,d)).map(_=>`"${_}"`),f=d.length===1?a._translateService.instant("BaseViewModel.ValidationErrorMessageSingleErrorField"):a._translateService.instant("BaseViewModel.ValidationErrorMessageSeveralErrorFields");return da.String.format(f,h.join(", "),i)})()}static{this.\u0275fac=function(t){return new(t||de)(p.\u0275\u0275inject(_e.TranslateService))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:de,factory:de.\u0275fac})}}class Ue{constructor(e){this._injector=e,this._subscription=new c.Subscription,this._handlerRegisterMap=new Map;for(const[,t]of n.InternalRequestHandlerRegistry.requestHandlersMap)this._registerHandler(t);this._subscription.add(n.InternalRequestHandlerRegistry.onAddRequestHandler((t,a)=>{this._registerHandler(a)})),this._subscription.add(n.InternalRequestHandlerRegistry.onRemoveRequestHandler((t,a)=>{this._removeHandler(a)}))}_registerHandler(e){const{type:t,scopes:a,requestType:r,createHandler:s,lazy:i,lazyModuleRef:l,source:d}=e.instanceConfig;this._handlerRegisterMap.has(t)?n.HandlerChainService.instance.update({type:t,createHandler:s}):this._handlerRegisterMap.set(t,n.HandlerChainService.instance.register({type:t,requestType:r,scopes:[...a??[]],source:d,createHandler:s,lazy:i,lazyModuleRef:l}))}_removeHandler(e){const{type:t}=e.instanceConfig;this._handlerRegisterMap.get(t)()}ngOnDestroy(){this._subscription.unsubscribe(),this._handlerRegisterMap.forEach(e=>{e()})}static{this.\u0275fac=function(t){return new(t||Ue)(p.\u0275\u0275inject(p.Injector))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:Ue,factory:Ue.\u0275fac,providedIn:"root"})}}const Li={provide:p.APP_INITIALIZER,useFactory:()=>()=>{},deps:[Ue],multi:!0};class Zs{create(e){const{validator:t,...a}=e,r=a.params.map(({name:s})=>s);return class extends N{constructor(s){super(s),this.async=a.async}_getMessageFromParams(s){return{[a.type]:{message:s.message}}}_setParamsProxy(s){return new Proxy(s,{get(i,l){if(r.includes(l))return i[l];throw new Error(`Property ${l} is not defined in validator params config`)}})}_toPromise(s){let i;return s instanceof Promise?i=s:s instanceof c.Observable?i=(0,c.lastValueFrom)(s,{defaultValue:null}):i=Promise.resolve(s),i}validate(s,i){let l=i;i&&(l=this._setParamsProxy(i));const h=t(l)(s,l);return this.isAsync?this._toPromise(h).then(f=>f&&l?.message?this._getMessageFromParams(l):f):l?.message&&h?this._getMessageFromParams(l):h}}}}const Fi={get:u=>{if(u===O)return{create:()=>(0,c.of)(null)};if(u===m.MeasurePerformanceService)return{measure:(e,t)=>t(),measureCallback:(e,t)=>t(),measure$:e=>t=>t}}};var va=R(31725);class rt{constructor(e,t){this._modelGenerator=e,this._measurePerformanceService=t}_getSchemaDiff(e,t){const a=(0,va.diff)(e?.viewModelConfig??{},t?.viewModelConfig??{}),r=(0,va.diff)(e?.modelConfig??{},t?.modelConfig??{}),s=(0,va.diff)(e?.resources??{},t?.resources??{});return{changedAttributesDiff:a,changedModelDiff:r,changedResourcesDiff:s}}diff(e,t,a){return this._measurePerformanceService.measure("ViewModelDiffPatch.diff",()=>{const{changedAttributesDiff:r,changedModelDiff:s,changedResourcesDiff:i}=this._getSchemaDiff(e,t);if((0,b.isEmpty)(r)&&(0,b.isEmpty)(s))return(0,c.of)({actualViewModelConfig:t?.viewModelConfig,resources:i});r.attributes=r.attributes||{},s.dataSources=s.dataSources||{};let l=Object.keys(r.attributes);const d=Object.keys(s.dataSources),h=Object.keys(t.viewModelConfig?.attributes??{}).filter(_=>{const S=t.viewModelConfig.attributes[_]??{};if((0,m.isModelAttributeConfig)(S))return d.includes(S.modelConfig?.path)||l.includes(S.modelConfig?.sortingConfig?.attributeName)});l=(0,b.uniq)([...l,...h]);const f=l.map(_=>{const S=t.viewModelConfig.attributes[_]??{};if((0,m.isModelAttributeConfig)(S))return S?.modelConfig?.path?.split(".")[0]}).filter(Boolean);return this._modelGenerator.generate(t.modelConfig,a).pipe(this._measurePerformanceService.measure$("ViewModelDiffPatch.diff.modelGenerate"),(0,o.map)(_=>({actualViewModelConfig:t?.viewModelConfig,attributes:{changed:l},resources:i,models:{changed:_.filter(S=>f.includes(S.name))}})))})}static{this.\u0275fac=function(t){return new(t||rt)(p.\u0275\u0275inject(Fe),p.\u0275\u0275inject(m.MeasurePerformanceService))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:rt,factory:rt.\u0275fac})}}const Oi="LiveEditingNotifier";class $e{constructor(e){this._messageChannelService=e,this._subscribeEntityChanged()}get liveEditingEvent$(){return this._messageChannelService.messageEvent$.pipe((0,o.filter)(e=>e.header.sender===Oi),(0,o.map)(e=>{const t=e.body;return{entitySchemaName:t.EntitySchemaName,columnNames:t.ColumnNames,primaryColumnValue:t.PrimaryColumnValue,eventType:this._getLiveEditingEventType(t.EventType),primaryColumnName:t.PrimaryColumnName,connectedLiveSchemaColumns:t.ConnectedLiveSchemaColumns}}))}_subscribeEntityChanged(){this.liveEditingEvent$.subscribe(e=>{this._notifyModel(e)})}_notifyModel(e){re.instance.notify({modelId:(0,n.generateGuid)(),dataSchemaName:e.entitySchemaName,type:e.eventType,payload:{primaryAttributesValues:[[{name:e.primaryColumnName,value:e.primaryColumnValue}]],changedAttributes:e.columnNames}})}_getLiveEditingEventType(e){switch(e){case 0:return V.Create;case 1:return V.Update;case 2:return V.Delete;default:break}}static{this.\u0275fac=function(t){return new(t||$e)(p.\u0275\u0275inject(m.MessageChannelService))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:$e,factory:$e.\u0275fac,providedIn:"root"})}}const ki={provide:p.APP_INITIALIZER,useFactory:()=>()=>{},deps:[$e],multi:!0};class he{constructor(){}_getDataSchema(e,t){return e.dataSchemas[t]}_getRelationData(e,t){const a=t.attributePath;if(a.split(".").length!==1)throw new Error(["Transition relation is not allowed.",`Model name: '${e}', attribute path: '${a}'`].join(" "));const r=t.relationPath.split(".");if(r.length!==2)throw new Error(["Transition relation is not allowed.",`Model name: '${e}', relation path: '${t.relationPath}'`].join(" "));const[s,i]=r;return{modelAttributeName:a,dependOnModelName:s,dependOnModelAttributeName:i}}_mergeRelationTypes(e,t){if(e===C.None)return t;if(t===C.None)return e;if(e===C.CircularDependency||t===C.CircularDependency)return C.CircularDependency;if(e===t)return e;if(e===C.OneToMany&&t===C.ManyToOne||e===C.ManyToOne&&t===C.OneToMany)return C.CircularDependency;if(e===C.ManyToMany||t===C.ManyToMany)return C.ManyToMany}_saveBefore(e,t,a){const r=a.find(s=>s.name===t);r.dependsOn.includes(e)||r.dependsOn.push(e)}_saveAfter(e,t,a){const r=a.find(s=>s.name===e);r.dependsOn.includes(t)||r.dependsOn.push(t)}_sort(e,t){const a=t.map(r=>({name:r,dependsOn:[]}));return t.forEach(r=>{const s=e._getModelDependencies(r);if(!s||s.length===0)return;const i=new Map;for(const l of s){const{modelAttributeName:d,dependOnModelName:h,dependOnModelAttributeName:f}=this._getRelationData(r,l),_=sa(this._getDataSchema(e,r),d,this._getDataSchema(e,h),f);let S=i.get(h)??C.None;S=this._mergeRelationTypes(S,_),i.set(h,S)}i.forEach((l,d)=>{switch(l){case C.ManyToOne:this._saveBefore(r,d,a);break;case C.OneToMany:this._saveAfter(r,d,a);break;case C.ManyToMany:throw new Error("Many-to-many relation is not supported");case C.CircularDependency:throw new Error("Circular dependency detected")}})}),(0,A.buildOrder)(a)}sort(e,t){return t.every(r=>e.getModelMode(r)===m.ModelMode.Update)?t:this._sort(e,t).flat()}static{this.\u0275fac=function(t){return new(t||he)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:he,factory:he.\u0275fac})}}let Tt=class extends n.BaseRequestHandler{constructor(e,t,a){super(),this._baseViewModelProcessValidationResultService=e,this.modelSaveOrderSorterService=t,this._featureValues=a}_validateRequest(e){const{$context:t}=e;if(!t)throw new Error('The "$context" request property is not specified.')}_saveModel(e,t){var a=this;return(0,y.A)(function*(){const r=e.dataSchemas[t],s=e.getViewModelAttributePath(t,r.primaryAttributeName);try{const i=yield a._saveData(e,t,s);return i.success&&a._onSuccessSaveRootData(e,t,i),i}catch(i){const l=i?.message;return a._createFailedSaveResult(l)}})()}_validateModel(e,t){var a=this;return(0,y.A)(function*(){if(!(yield e.isValid(t))){const s=yield e.validate(t),i=yield a._baseViewModelProcessValidationResultService.getValidationErrorMessage(e,s);return a._createFailedSaveResult(i)}return null})()}_getModels(e){var t=this;return(0,y.A)(function*(){const a=yield e.getPrimaryModelName();let r=Ds(e);return r=r.filter(s=>e.getModelMode(s)!==m.ModelMode.Init),a&&!r.includes(a)&&r.unshift(a),t._featureValues.AllowMultipleDataSources&&(r=t.modelSaveOrderSorterService.sort(e,r)),r})()}_canSaveDataResult(e,t){var a=this;return(0,y.A)(function*(){const r=e.dataSchemas[t],s=e.getViewModelAttributePath(t,r.primaryAttributeName),i=yield a._canSaveData(e,t,s);if(i&&!i?.result)return a._createFailedSaveResult(i.message)})()}_checkPdsGroupValidationResults(e,t){var a=this;return(0,y.A)(function*(){const r=yield Promise.all(t.map(i=>a._validateModel(e,i)));if(r.some(i=>i&&!i.success))return r;const s=yield Promise.all(t.map(i=>a._canSaveDataResult(e,i)));return s.some(i=>i&&!i.success)?s:[]})()}_saveModelChanges(e,t){var a=this;return(0,y.A)(function*(){let r;return(yield a._shouldSkipUnchangedDependentPageModel(e,t))||(r=yield a._saveModel(e,t)),r})()}_saveRootData(e){var t=this;return(0,y.A)(function*(){const a=yield t._getModels(e),r=yield e.getPrimaryModelName();let s=[r,...a.filter(h=>mt(e._getModelDependencies(h),r))];t._featureValues.AllowMultipleDataSources||(s=[]);const i=a.filter(h=>!s.includes(h));let l=yield t._checkPdsGroupValidationResults(e,s);if(!l.length)for(const h of s)l.push(yield t._saveModelChanges(e,h));for(const h of i){const f=yield t._validateModel(e,h),_=yield t._canSaveDataResult(e,h);!f&&!_?l.push(yield t._saveModelChanges(e,h)):l.push(f||_)}l=l.filter(Boolean);const d=l.filter(h=>!h.success).map(h=>h.errorInfo);return d.length&&t._onFailSaveRootData(e,d.join(", ")),l})()}_shouldSkipUnchangedDependentPageModel(e,t){var a=this;return(0,y.A)(function*(){if(!a._featureValues.AllowMultipleDataSources)return!1;const r=e.getModelByName(t);if(r?.getDataSource()?.isForceUpdateUnchangedData)return!1;const i=yield e.getPrimaryModelName(),l=mt(e._getModelDependencies(t),i),d=r?._isChanged;return l&&!d})()}_canSaveData(e,t,a){return(0,y.A)(function*(){const s={primaryColumnValue:yield e[a]};return e.canSave(t,s)})()}_saveData(e,t,a){var r=this;return(0,y.A)(function*(){const s={type:"crt.SaveDataRequest",$context:e,parameters:[{type:n.ModelParameterType.PrimaryColumnValue,value:a}],dataSourceName:t};return yield r.handlerChain.process(s)})()}_onFailSaveRootData(e,t){e.formApiModel.setErrors({save:{message:t}})}_updateAttributesOnSaveResult(e,t,a){if(a?.primaryAttributes?.length)for(const r of a.primaryAttributes)for(const[s,i]of Object.entries(r)){const l=e.getViewModelAttributePath(t,s);e[l]=i}}_onSuccessSaveRootData(e,t,a){this._updateAttributesOnSaveResult(e,t,a),e.getBoundDataSourceAttributeControls(t)?.forEach(s=>{ht(s)})}_saveNestedData(e,t){var a=this;return(0,y.A)(function*(){const r=[],s=Object.entries(e._attributeConfigs);for(const[l,d]of s)if(!(!("viewModelConfig"in d)&&!("viewModelName"in d)))if(d.isCollection)r.push(a._saveDataSafely(()=>a._saveInnerViewModelCollection(e,l,t)));else{const h=yield e[l];r.push(a._saveDataSafely(()=>a._saveInnerViewModel(h)))}return(yield Promise.all(r)).flat()})()}_saveInnerViewModel(e){var t=this;return(0,y.A)(function*(){const a={type:"crt.SavePrimaryDataRequest",$context:e};return yield t.handlerChain.process(a)})()}_saveInnerViewModelCollection(e,t,a){var r=this;return(0,y.A)(function*(){const s={type:"crt.SaveCollectionPrimaryDataRequest",$context:e,collectionAttributeName:t,scopes:a};return yield r.handlerChain.process(s)})()}_saveDataSafely(e){return e().catch(t=>[this._createFailedSaveResult(t?.message)])}_createFailedSaveResult(e){return{success:!1,rowsAffected:0,errorInfo:e}}handle(e){var t=this;return(0,y.A)(function*(){t._validateRequest(e);const a=e.$context,r=yield t._saveRootData(a);if(r.some(i=>!i.success))return r;const s=yield t._saveNestedData(a,e.scopes);return[...r,...s]})()}};Tt=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.SavePrimaryDataHandler",requestType:"crt.SavePrimaryDataRequest"}),(0,g.__param)(2,(0,p.Inject)(m.FEATURE_VALUES)),(0,g.__param)(2,(0,n.CrtInject)(m.FEATURE_VALUES)),(0,g.__metadata)("design:paramtypes",[de,he,m.FeatureValues])],Tt);let Pa=class extends n.BaseRequest{};Pa=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.LoadLookupListRequest"})],Pa);let Nt=class extends n.BaseRequestHandler{handle(e){const t={control:e.valueAttributeName,items:e.itemsAttributeName},a=e.filterValue??null,r=[{type:n.ModelParameterType.PrimaryDisplayValueFilter,value:"@requestPayload.lookupFilterValue"},...e.parameters||[]],s={...e.payload,lookupFilterValue:a};return e.$context.loadLookupList(t,r,s),Promise.resolve()}};Nt=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.LoadLookupListHandler",requestType:"crt.LoadLookupListRequest"})],Nt);let It=class extends n.BaseRequestHandler{constructor(e,t){super(),this._translateService=e,this._featureValues=t}_isDynamicDS(e){const t=e.config||{};return!!(t.dataSourceConfig&&t.attributeName)}_loadDynamicDS(e){const t=e.$context,a=e.config;return(0,c.lastValueFrom)(t.load(a),{defaultValue:null})}_load(e){if(!e.dataSourceName)return;const t=e.$context;let a=e.parameters;a=this._addPrimaryDisplayValueFilterIfNeed(e,a);const r=e.config;return this._trySubscribeToLoadedData(e),(0,c.lastValueFrom)(t.load(e.dataSourceName,a,r),{defaultValue:null})}_trySubscribeToLoadedData(e){if(this._featureValues[cs]||!e?.showSuccessMessage)return;const t=e.$context,a=t._modelsMap.get(e.dataSourceName),r=a.affectedAttributes.map(h=>h.path),i=[...t._getDependentModelsForLoad(a,r),e.dataSourceName],l=new Set,d=t._modelLoaded$.subscribe(h=>{if(i.includes(h)&&l.add(h),l.size===i.length){d.unsubscribe();const f={$context:e.$context,type:"crt.NotificationRequest",message:this._translateService.instant("LoadDataRequest.SuccessMessage")};this.handlerChain.process(f)}})}_addPrimaryDisplayValueFilterIfNeed(e,t){return e.primaryDisplayFilterValue?(t=t||[],[...t,{type:n.ModelParameterType.PrimaryDisplayValueFilter,value:e.primaryDisplayFilterValue}]):t}handle(e){if(!e.$context)throw new Error("Property '$context' should be specified");return this._isDynamicDS(e)?this._loadDynamicDS(e):this._load(e)}};It=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.LoadDataSourceHandler",requestType:"crt.LoadDataRequest"}),(0,g.__param)(1,(0,p.Inject)(m.FEATURE_VALUES)),(0,g.__param)(1,(0,n.CrtInject)(m.FEATURE_VALUES)),(0,g.__metadata)("design:paramtypes",[_e.TranslateService,m.FeatureValues])],It);let Ea=class extends n.DataRequest{};Ea=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.LoadDefaultValuesRequest"})],Ea);let wt=class extends n.BaseRequestHandler{handle(e){const t=e.$context;return(0,c.lastValueFrom)(t.loadDefaultValues(e.dataSourceName),{defaultValue:null})}};wt=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.LoadDefaultValuesHandler",requestType:"crt.LoadDefaultValuesRequest"})],wt);let Va=class extends n.DataRequest{};Va=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SaveDataRequest"})],Va);let xt=class extends n.BaseRequestHandler{handle(e){const t=e.$context,{dataSourceName:a,options:r,parameters:s}=e,i=t.save(a,s,r);return(0,c.lastValueFrom)(i,{defaultValue:null})}};xt=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.SaveDataHandler",requestType:"crt.SaveDataRequest"})],xt);let Ta=class extends n.DataRequest{};Ta=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.DeleteDataRequest"})],Ta);let qt=class extends n.BaseRequestHandler{handle(e){const t=e.$context;return(0,c.lastValueFrom)(t.delete(e.dataSourceName,e.parameters,e.config),{defaultValue:null})}};qt=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.DeleteDataHandler",requestType:"crt.DeleteDataRequest"})],qt);let Na=class extends n.DataRequest{};Na=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.CopyDataRequest"})],Na);let Lt=class extends n.BaseRequestHandler{handle(e){const t=e.$context,{dataSourceName:a,recordId:r,copiedValues:s}=e;return(0,c.lastValueFrom)(t.copy(a,r,s),{defaultValue:null})}};Lt=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.CopyDataHandler",requestType:"crt.CopyDataRequest"})],Lt);let Ia=class extends n.DataRequest{};Ia=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SortDataRequest"})],Ia);let Ft=class extends n.BaseRequestHandler{handle(e){const t=e.$context;return(0,c.lastValueFrom)(t.setSorting(e.dataSourceName,e.config),{defaultValue:null})}};Ft=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.SortDataHandler",requestType:"crt.SortDataRequest"})],Ft);let wa=class extends n.BaseRequestHandler{handle(e){var t=this;return(0,y.A)(function*(){const a=e.$context,r=a._injectionContext;a._injectionContext?.id&&t.handlerChain.clearContextedHandlersCache(r.id),yield t.next?.handle(e)})()}};wa=(0,g.__decorate)([(0,n.CrtRequestHandler)({requestType:"crt.HandleViewModelDestroyRequest",type:"crt.ClearContextedHandlersCacheHandler"})],wa);let xa=class extends n.DataRequest{};xa=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.GetDataSourceLoadFiltersRequest"})],xa);let Ot=class extends n.BaseRequestHandler{constructor(e){super(),this._entitySchemaQueryBuilder=e}handle(e){var t=this;return(0,y.A)(function*(){const a=e.$context;if(!a)throw new Error("Property '$context' should be specified");const r=e.dataSourceName;if(!r)throw new Error("Property 'dataSourceName' should be specified");const s=a.dataSchemas[r];if(!s)throw new Error(`Schema for data source with name ${r} not found`);const i=yield a.getDataSourceLoadParameters(r);return i.parameters.some(l=>l.type===n.ModelParameterType.Never)?null:(0,c.lastValueFrom)(t._entitySchemaQueryBuilder.build(s,[],i.parameters).pipe((0,c.map)(l=>l.getMetadata().filters)))})()}};Ot=(0,g.__decorate)([(0,n.CrtRequestHandler)({type:"crt.GetDataSourceLoadFiltersHandler",requestType:"crt.GetDataSourceLoadFiltersRequest"}),(0,g.__metadata)("design:paramtypes",[X])],Ot);class K{selectData(){return null}static{this.\u0275fac=function(t){return new(t||K)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:K,factory:K.\u0275fac,providedIn:"root"})}}class me extends K{constructor(){super(...arguments),this._elon={FirstName:"Elon",Account:{Name:"SpaceX",Ships:[{Id:"Falcon 9"},{Id:"Falcon Heavy"}],Employee:{Name:"Mask",Age:49}},Employees:["Elon"]}}selectData(){return(0,c.of)(this._elon).pipe((0,o.delay)(50))}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(me)))(a||me)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:me,factory:me.\u0275fac,providedIn:"root"})}}class Bi extends U{get userProperty(){return this._field}set userProperty(e){this._field=e}initDependencies(){super.initDependencies(),this.dataService=this.injector.get(K)}init(e=null){return super.init(e).pipe((0,o.tap)(()=>{this.userField="userField",this.userProperty="userProperty",this.parentField="parentField",this.dataService.selectData().pipe((0,o.first)(),(0,o.switchMap)(t=>this.setValue(t).pipe((0,o.tap)(()=>this._markAsPristine(t))))).subscribe(c.noop)}))}enterKeyDown(e){this.FirstName+="_enterKeyDown"}buttonClick(e){this.FirstName+="$"}}var Ks=R(40297),qa=R(8206);const Ys=A.FactoryProvider.create({token:ia,mappings:[{predicate:n.DataValueType.Lookup,injectable:Be},{predicate:Vs,injectable:ue}],default:{injectable:ce}});let La=class extends n.BaseRequest{};La=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.AddCommunicationOptionsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.Add\u0421ommunicationOptionsRequest",propertiesPanelComponentTypeName:"crt.AddCommunicationOptionsRequestPropertiesPanel",position:740})],La);class Fa extends n.BaseRequest{}class Oa extends Fa{}let ka=class extends Oa{};ka=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.AddRecordsInStaticFoldersRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.AddRecordsInStaticFoldersRequest",propertiesPanelComponentTypeName:"crt.AddRecordsInStaticFoldersRequestPropertiesPanel",position:706,compatibleAPIs:{[n.PlatformAPIs.Selection]:!0}})],ka);class Qs extends n.BaseRequest{}let Ba=class extends Qs{};Ba=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.AddTagsInRecordRequest"})],Ba);class ja extends Fa{}let Ua=class extends ja{};Ua=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.AddTagsInRecordsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.AddTagsInRecordsRequest",propertiesPanelComponentTypeName:"crt.AddTagsInRecordsRequestPropertiesPanel",position:703,compatibleAPIs:{[n.PlatformAPIs.Selection]:!0}})],Ua);class $a extends n.BaseRequest{}let Ha=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.CancelCollectionPrimaryDataChangesRequest"}};Ha=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.CancelCollectionPrimaryDataChangesRequest"})],Ha);let za=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.CancelPrimaryDataChangesRequest"}};za=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.CancelPrimaryDataChangesRequest"})],za);let Wa=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.CancelRecordChangesRequest"}};Wa=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.CancelRecordChangesRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.CancelRecordChangesRequest",position:500})],Wa);let Ga=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.CancelRecordsChangesRequest"}};Ga=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.CancelRecordsChangesRequest"})],Ga);let Ja=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.ClosePageRequest"}};Ja=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.ClosePageRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.ClosePageRequest",position:600})],Ja);let kt=class extends n.DataRequest{};kt=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.LoadDataRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.LoadDataRequest",propertiesPanelComponentTypeName:"crt.LoadDataRequestPropertiesPanel",position:500})],kt);let Za=class extends kt{};Za=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.ComboboxLoadDataRequest"})],Za);let Ka=class extends n.BaseRequest{};Ka=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.ContinueInOtherPageRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.ContinueInOtherPageRequest",position:1e3})],Ka);let Ya=class extends n.BaseRequest{};Ya=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.CopilotActionRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.CopilotActionRequest",propertiesPanelComponentTypeName:"crt.CopilotActionRequestPropertiesPanelComponent",position:3001})],Ya);let Qa=class extends n.BaseRequest{};Qa=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.CreateCollectionItemsRequest"})],Qa);let Xa=class extends n.BaseRequest{};Xa=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.CreateRecordRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.CreateRecordRequest",propertiesPanelComponentTypeName:"crt.CreateRecordRequestPropertiesPanel",position:200})],Xa);let er=class extends n.BaseRequest{};er=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.DeleteClientUnitSchemaRequest"})],er);let st=class extends n.BaseRequest{};st=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.DeleteRecordRequest"})],st);let tr=class extends st{};tr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.DeleteFileRequest"})],tr);let ar=class extends st{};ar=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.DeleteOldTagRecordRequest"})],ar);let rr=class extends n.BaseRequest{};rr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.DeleteRecordsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.DeleteRecordsRequest",propertiesPanelComponentTypeName:"crt.DeleteRecordsRequestPropertiesPanel",position:701,compatibleAPIs:{[n.PlatformAPIs.Selection]:!0}})],rr);let sr=class extends Qs{};sr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.DeleteTagInRecordRequest"})],sr);let ir=class extends n.BaseRequest{};ir=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.DetailChangedRequest"})],ir);let nr=class extends n.BaseRequest{};nr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.EmailLinkClickRequest"})],nr);let or=class extends n.BaseRequest{};or=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.ExportChartDataGridToExcelRequest"})],or);let lr=class extends n.BaseRequest{};lr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.ExportDataGridToExcelRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.ExportDataGridToExcelRequest",propertiesPanelComponentTypeName:"crt.ExportDataGridToExcelRequestPropertiesPanel",position:800,compatibleAPIs:{[n.PlatformAPIs.Selection]:!0}})],lr);class k extends n.BaseRequest{}class ur extends k{}let Bt=class extends ur{};Bt=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.AddFolderDataRequest"})],Bt);let cr=class extends ur{};cr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.CopyFolderDataRequest"})],cr);let dr=class extends k{};dr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.DeleteFolderDataRequest"})],dr);let hr=class extends k{};hr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.FolderTreeActiveFolderChangedRequest"})],hr);let mr=class extends k{};mr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.FolderTreeVisibleRequest"})],mr);let pr=class extends k{};pr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.FolderTreeMoveRequest"})],pr);let gr=class extends k{};gr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.FolderTreeRenameRequest"})],gr);let fr=class extends k{};fr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.ToggleFolderFavoriteRequest"})],fr);let _r=class extends k{};_r=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.FolderTreeUpdateFiltersRequest"})],_r);let yr=class extends k{};yr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.FolderTreeExpandedItemsRequest"})],yr);let Sr=class extends Bt{};Sr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.ConvertToStaticFolderRequest"})],Sr);let Mr=class extends n.BaseRequest{};Mr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.BaseImageListItemClickRequest"})],Mr);let br=class extends n.BaseRequest{constructor(e,t){super(),this.event=e,this.$context=t,this.type="crt.HandleKeyboardHotkeysRequest"}};br=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleKeyboardHotkeysRequest"}),(0,g.__metadata)("design:paramtypes",[KeyboardEvent,Object])],br);let Ar=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.HandleModelEventRequest"}};Ar=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleModelEventRequest"})],Ar);let jt=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.HandleViewModelDestroyRequest"}};jt=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleViewModelDestroyRequest"})],jt);let Ut=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.HandleViewModelInitRequest"}};Ut=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleViewModelInitRequest"})],Ut);let $t=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.HandleViewModelPauseRequest"}};$t=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleViewModelPauseRequest"})],$t);let Ht=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.HandleViewModelResumeRequest"}};Ht=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleViewModelResumeRequest"})],Ht);let Cr=class extends n.BaseRequest{};Cr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.ImportDataRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.ImportDataRequest",propertiesPanelComponentTypeName:"crt.ImportDataRequestPropertiesPanel",position:750})],Cr);class H extends n.BaseRequest{}let Rr=class extends H{constructor(){super(...arguments),this.type="crt.HandleAfterModelDeleteRequest"}};Rr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleAfterModelDeleteRequest"})],Rr);let Dr=class extends H{constructor(){super(...arguments),this.type="crt.HandleAfterModelInsertRequest"}};Dr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleAfterModelInsertRequest"})],Dr);let vr=class extends H{constructor(){super(...arguments),this.type="crt.HandleAfterModelLoadRequest"}};vr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleAfterModelLoadRequest"})],vr);let Pr=class extends H{constructor(){super(...arguments),this.type="crt.HandleAfterModelUpdateRequest"}};Pr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleAfterModelUpdateRequest"})],Pr);let Er=class extends H{constructor(){super(...arguments),this.type="crt.HandleBeforeModelDeleteRequest"}};Er=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleBeforeModelDeleteRequest"})],Er);let Vr=class extends H{constructor(){super(...arguments),this.type="crt.HandleBeforeModelInsertRequest"}};Vr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleBeforeModelInsertRequest"})],Vr);let Tr=class extends H{constructor(){super(...arguments),this.type="crt.HandleBeforeModelLoadRequest"}};Tr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleBeforeModelLoadRequest"})],Tr);let Nr=class extends H{constructor(){super(...arguments),this.type="crt.HandleBeforeModelUpdateRequest"}};Nr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.HandleBeforeModelUpdateRequest"})],Nr);let Ir=class extends n.BaseRequest{};Ir=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.MoveSelectedItemsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.MoveSelectedItemsRequest",propertiesPanelComponentTypeName:"crt.MoveSelectedItemsRequestPropertiesPanel",position:1e3,compatibleAPIs:{[n.PlatformAPIs.Selection]:!0}})],Ir);var wr;(function(u){u.Root="root",u.Item="item",u.Const="const"})(wr||(wr={}));class ji{}let xr=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.NotificationRequest"}};xr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.NotificationRequest"})],xr);let qr=class extends n.BaseRequest{};qr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.OpenDuplicatesPageRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.OpenDuplicatesPageRequest",propertiesPanelComponentTypeName:"crt.OpenDuplicatesPageRequestPropertiesPanel",position:360})],qr);let Lr=class extends n.BaseRequest{};Lr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.OpenOldTagMiniPageRequest"})],Lr);let Fr=class extends n.BaseRequest{};Fr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.OpenPageRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.OpenPageRequest",propertiesPanelComponentTypeName:"crt.OpenPageRequestPropertiesPanel",position:350})],Fr);let Or=class extends n.BaseRequest{};Or=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.OpenPositionedPageRequest"})],Or);let kr=class extends n.BaseRequest{};kr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.PhoneLinkClickRequest"})],kr);let Br=class extends n.BaseRequest{};Br=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.PrintablesRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.PrintablesRequest",propertiesPanelComponentTypeName:"crt.PrintablesRequestPropertiesPanel",position:3e3,compatibleAPIs:{[n.PlatformAPIs.Selection]:!0}})],Br);let jr=class extends n.BaseRequest{};jr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.RemoveCollectionItemsRequest"})],jr);let Ur=class extends Oa{};Ur=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.RemoveRecordsInStaticFoldersRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.RemoveRecordsInStaticFoldersRequest",propertiesPanelComponentTypeName:"crt.RemoveRecordsInStaticFoldersRequestPropertiesPanel",position:705,compatibleAPIs:{[n.PlatformAPIs.Selection]:!0}})],Ur);let $r=class extends ja{};$r=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.RemoveTagsInRecordsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.RemoveTagsInRecordsRequest",propertiesPanelComponentTypeName:"crt.RemoveTagsInRecordsRequestPropertiesPanel",position:704,compatibleAPIs:{[n.PlatformAPIs.Selection]:!0}})],$r);let Hr=class extends n.BaseRequest{};Hr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.RunBusinessProcessRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.RunBusinessProcessRequest",propertiesPanelComponentTypeName:"crt.RunBusinessProcessRequestPropertiesPanel",position:700,compatibleAPIs:{[n.PlatformAPIs.Selection]:!0}})],Hr);let zr=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.SaveCollectionPrimaryDataRequest"}};zr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SaveCollectionPrimaryDataRequest"})],zr);let Wr=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.SavePrimaryDataRequest"}};Wr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SavePrimaryDataRequest"})],Wr);let zt=class extends n.BaseRequest{};zt=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SaveRecordRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.SaveRecordRequest",propertiesPanelComponentTypeName:"crt.SaveRecordRequestPropertiesPanel",position:400})],zt);let Gr=class extends zt{};Gr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SaveRecordWithErrorRequest"})],Gr);let Jr=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.SaveRecordsRequest"}};Jr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SaveRecordsRequest"})],Jr);let Zr=class extends $a{};Zr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SearchFilterColumnsGroupsRequest"})],Zr);let Kr=class extends $a{};Kr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SearchFilterRequest"})],Kr);let Yr=class extends n.BaseRequest{constructor(){super(...arguments),this.multiple=!0,this.displayErrors=!1}};Yr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SelectFileRequest"})],Yr);let Qr=class extends n.BaseRequest{};Qr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SelectLookupPageRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.SelectLookupPageRequest",propertiesPanelComponentTypeName:"crt.SelectLookupPageRequestPropertiesPanel",scopes:["BaseLookupPageTemplate"],position:2e3})],Qr);let Xr=class extends n.BaseRequest{};Xr=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SetRecordRightsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.SetRecordRightsRequest",propertiesPanelComponentTypeName:"crt.SetRecordRightsRequestPropertiesPanel",position:800})],Xr);let es=class extends n.BaseRequest{constructor(){super(...arguments),this.type="crt.SetTopRecordRequest"}};es=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.SetTopRecordRequest"})],es);let ts=class extends n.BaseRequest{};ts=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.ShowRelationshipsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.ShowRelationshipsRequest",propertiesPanelComponentTypeName:"crt.ShowRelationshipsRequestPropertiesPanel",position:900})],ts);let as=class extends n.BaseRequest{};as=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.UpdateRecordRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.UpdateRecordRequest",propertiesPanelComponentTypeName:"crt.UpdateRecordRequestPropertiesPanel",position:300})],as);let rs=class extends n.BaseRequest{};rs=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.UploadFileRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.UploadFileRequest",propertiesPanelComponentTypeName:"crt.UploadFileRequestPropertiesPanel",position:702})],rs);let ss=class extends n.BaseRequest{constructor(){super(...arguments),this.awaitResponse=!1}};ss=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.UploadImageRequest"})],ss);let is=class extends n.BaseRequest{};is=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.WorkplaceNavigationPanelCloseRequest"})],is);let ns=class extends n.BaseRequest{};ns=(0,g.__decorate)([(0,n.CrtRequest)({type:"crt.OpenChangeLogRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.OpenChangeLogRequest",propertiesPanelComponentTypeName:"crt.OpenChangeLogRequestPropertiesPanel",position:370})],ns);class pe{constructor(){this.viewModelConstructor=U}static useClass(e){return new class extends pe{constructor(){super(...arguments),this.viewModelConstructor=e}}}create(e,t,a,r,s,i,l,d){return new this.viewModelConstructor(e,t,a,r,s,i,l,d)}static{this.\u0275fac=function(t){return new(t||pe)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:pe,factory:pe.\u0275fac,providedIn:"root"})}}class ge extends W{constructor(){super(...arguments),this._lifecycleHooksRequests={init:Ut,resume:Ht,pause:$t,destroy:jt},this.handlerChain=n.HandlerChainService.instance}_processRequest(e,t,a){return this.ngZone.runOutsideAngular(()=>this.sendRequest({...e,scopes:a,$context:t}))}_processViewModelAttributeChanges(e,t){e.events$.pipe((0,o.filter)(a=>a.type===P.ChangeAttributeValue&&!a.payload?.preventAttributeChangeRequest)).subscribe({next:a=>{const r=`${F.ProcessingAttributeChangeRequest}-${(0,n.generateGuid)()}`;e._onAsyncTaskStarted(r),this._processRequest(new n.HandleViewModelAttributeChangeRequest(a.payload),e,t).then(()=>e._onAsyncTaskFinished(r))}})}initDependencies(){super.initDependencies(),this.viewModelFactory=this.injector.get(pe)}generateLifecycleHooks(e,t){Object.entries(this._lifecycleHooksRequests).forEach(([a,r])=>{e[a]=new Proxy(e[a],{apply:(s,i,l)=>{const d=s.apply(i,l);if(!(d instanceof c.Observable))throw new Error(`Method ${a} should return Observable`);return d.pipe((0,o.switchMap)(h=>(0,c.from)(this._processRequest(new r,e,t.scopes)).pipe((0,c.map)(()=>h))))}})})}_generateFromConfig(e,t){const a=t||this.injector,{viewModelConfig:r,modelConfig:s,resources:i,models:l,scopes:d,modelInitConfigs:h,modelConfig:{primaryDataSourceName:f}={},parentViewModel:_,businessRulesActive:S}=e,M=this.viewModelFactory.create(this,a,this._trimEmptyAttributes(r),i,null,d,h,_);return this.generateLifecycleHooks(M,e),this._processViewModelAttributeChanges(M,d),M.init(l,{modelDependencies:s?.dependencies,primaryModelName:f,modelsLoadingConfig:s?.loadingConfig,businessRulesActive:S})}_trimEmptyAttributes(e){const t=e?.attributes??{};return Object.keys(t).forEach(a=>{t[a]||delete t[a]}),{...e,attributes:t}}_generateFromString(e,t){return this.repository.resolveModelConfig(e.viewModelConfig).pipe((0,o.switchMap)(a=>this._generateFromConfig({...e,viewModelConfig:a},t)))}sendRequest(e){return this.handlerChain.process(e)}generate(e,t){const a=t?.get(m.MeasurePerformanceService);return typeof e.viewModelConfig=="string"?a?this._generateFromString(e,t).pipe(a.measure$("viewModelGenerator.generateFromString")):this._generateFromString(e,t):a?this._generateFromConfig(e,t).pipe(a.measure$("viewModelGenerator.generateFromConfig")):this._generateFromConfig(e,t)}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=p.\u0275\u0275getInheritedFactory(ge)))(a||ge)}})()}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:ge,factory:ge.\u0275fac,providedIn:"root"})}}const Ui={"hr-HR":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Molimo odaberite vrijednost iz popisa","SelectionWindowMessage":"Molimo odaberite vrijednost iz popisa ili pretra\u017Eite koriste\u0107i prozor za pretra\u017Eivanje"},"Required":{"Message":"Unesite vrijednost"},"MaxLength":{"Message":"Prema\u0161ena maksimalna duljina teksta ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimalna duljina teksta nije dosegnuta ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Neispravan format datuma i vremena"},"DatePickerSyntax":{"Message":"Neispravan format datuma"},"TimePickerSyntax":{"Message":"Neispravan format vremena"},"RegExp":{"Message":"Neispravan format vrijednosti"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kod mora zapo\u010Deti prefiksom {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"Unesite barem jedan znak."},"SchemaNameAllowedSymbols":{"Message":"Koristite simbole: a-z, A-Z, 0-9, donja crta ili crtica. Samo slova mogu biti prva."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Stupac uklonjen","ValidationErrorMessageSingleErrorField":"Polje: {0}. Gre\u0161ka: {1}","ValidationErrorMessageSeveralErrorFields":"Polja: {0}. Gre\u0161ka: {1}","RefreshModelDataConflict":"Creatio ima nove podatke za trenutnu stranicu. Kako biste ih vidjeli, spremite ili poni\u0161tite svoje promjene i osvje\u017Eite stranicu.","WarningModelsWithCircularDependencies":"Neki modeli imaju cikli\u010Dke ovisnosti i nisu u\u010Ditani","LoadingModelErrorMessage":"Do\u0161lo je do gre\u0161ke tijekom izvr\u0161avanja upita"}}'),"hu-HU":JSON.parse('{"Validators":{"Autocomplete":{"Message":"K\xE9rj\xFCk, v\xE1lassza ki az \xE9rt\xE9ket a list\xE1b\xF3l","SelectionWindowMessage":"K\xE9rj\xFCk, v\xE1lasszon \xE9rt\xE9ket a list\xE1b\xF3l, vagy keressen a keres\u0151ablak seg\xEDts\xE9g\xE9vel"},"Required":{"Message":"Adj meg egy \xE9rt\xE9ket"},"MaxLength":{"Message":"A maxim\xE1lis sz\xF6veghossz t\xFAll\xE9pve ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Nem \xE9rte el a minim\xE1lis sz\xF6veghosszt ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\xC9rv\xE9nytelen d\xE1tum- \xE9s id\u0151form\xE1tum"},"DatePickerSyntax":{"Message":"\xC9rv\xE9nytelen d\xE1tumform\xE1tum"},"TimePickerSyntax":{"Message":"\xC9rv\xE9nytelen id\u0151form\xE1tum"},"RegExp":{"Message":"\xC9rv\xE9nytelen \xE9rt\xE9kform\xE1tum"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Oszlop elt\xE1vol\xEDtva","ValidationErrorMessageSingleErrorField":"Mez\u0151: {0}. Hiba: {1}","ValidationErrorMessageSeveralErrorFields":"Mez\u0151k: {0}. Hiba: {1}","RefreshModelDataConflict":"A Creatio \xFAj adatokkal rendelkezik az aktu\xE1lis oldalhoz. A megtekint\xE9s\xE9hez mentse vagy vonja vissza a m\xF3dos\xEDt\xE1sokat, \xE9s friss\xEDtse az oldalt.","WarningModelsWithCircularDependencies":"Egyes modellek k\xF6rk\xF6r\xF6s f\xFCgg\u0151s\xE9ggel rendelkeznek, \xE9s nincsenek bet\xF6ltve","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"zh-CN":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u8BF7\u4ECE\u5217\u8868\u4E2D\u9009\u62E9\u503C","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"\u8F93\u5165\u503C"},"MaxLength":{"Message":"\u8D85\u8FC7\u6587\u672C\u957F\u5EA6\u9650\u5236({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u672A\u8FBE\u6587\u672C\u6700\u5C0F\u9650\u5236({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u65E5\u671F\u548C\u65F6\u95F4\u683C\u5F0F\u65E0\u6548"},"DatePickerSyntax":{"Message":"\u65E5\u671F\u683C\u5F0F\u65E0\u6548"},"TimePickerSyntax":{"Message":"\u65F6\u95F4\u683C\u5F0F\u65E0\u6548"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u5217\u5DF2\u79FB\u9664","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio \u5F53\u524D\u9875\u9762\u6570\u636E\u5DF2\u66F4\u6539\u3002\u8BF7\u4FDD\u5B58\u6216\u53D6\u6D88\u540E\uFF0C\u518D\u5237\u65B0\u672C\u9875\u9762\u4EE5\u67E5\u770B","WarningModelsWithCircularDependencies":"\u6709\u4E9B\u6A21\u578B\u6709\u5FAA\u73AF\u4F9D\u8D56\u5173\u7CFB\u5E76\u4E14\u6CA1\u6709\u88AB\u52A0\u8F7D","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"uk-UA":JSON.parse('{"BaseViewModel":{"RefreshModelDataConflict":"Creatio \u043C\u0430\u0454 \u043D\u043E\u0432\u0456 \u0434\u0430\u043D\u0456 \u0434\u043B\u044F \u043F\u043E\u0442\u043E\u0447\u043D\u043E\u0457 \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438. \u0429\u043E\u0431 \u043F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0457\u0457, \u0437\u0431\u0435\u0440\u0435\u0436\u0456\u0442\u044C \u0430\u0431\u043E \u0441\u043A\u0430\u0441\u0443\u0439\u0442\u0435 \u0432\u0430\u0448\u0456 \u0437\u043C\u0456\u043D\u0438 \u0456 \u043E\u043D\u043E\u0432\u0456\u0442\u044C \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0443.","WarningModelsWithCircularDependencies":"\u0414\u0435\u044F\u043A\u0456 \u043C\u043E\u0434\u0435\u043B\u0456 \u043C\u0430\u044E\u0442\u044C \u0446\u0438\u043A\u043B\u0456\u0447\u043D\u0456 \u0437\u0430\u043B\u0435\u0436\u043D\u043E\u0441\u0442\u0456 \u0456 \u043D\u0435 \u0431\u0443\u043B\u0438 \u0437\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u0456","DataSourceAttributeRemoved":"\u041A\u043E\u043B\u043E\u043D\u043A\u0443 \u0432\u0438\u0434\u0430\u043B\u0435\u043D\u043E","ValidationErrorMessageSingleErrorField":"\u041F\u043E\u043B\u0435: {0}. \u041F\u043E\u043C\u0438\u043B\u043A\u0430: {1}","ValidationErrorMessageSeveralErrorFields":"\u041F\u043E\u043B\u044F: {0}. \u041F\u043E\u043C\u0438\u043B\u043A\u0430: {1}","LoadingModelErrorMessage":"\u0421\u0442\u0430\u043B\u0430\u0441\u044F \u043F\u043E\u043C\u0438\u043B\u043A\u0430 \u043F\u0456\u0434 \u0447\u0430\u0441 \u0432\u0438\u043A\u043E\u043D\u0430\u043D\u043D\u044F \u0437\u0430\u043F\u0438\u0442\u0443"},"Validators":{"Autocomplete":{"Message":"\u0411\u0443\u0434\u044C \u043B\u0430\u0441\u043A\u0430, \u043E\u0431\u0435\u0440\u0456\u0442\u044C \u0437\u043D\u0430\u0447\u0435\u043D\u043D\u044F \u0437\u0456 \u0441\u043F\u0438\u0441\u043A\u0443","SelectionWindowMessage":"\u0411\u0443\u0434\u044C \u043B\u0430\u0441\u043A\u0430, \u0432\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u0437\u043D\u0430\u0447\u0435\u043D\u043D\u044F \u0437\u0456 \u0441\u043F\u0438\u0441\u043A\u0443 \u0430\u0431\u043E \u0441\u043A\u043E\u0440\u0438\u0441\u0442\u0430\u0439\u0442\u0435\u0441\u044F \u043F\u043E\u0448\u0443\u043A\u043E\u043C \u0437\u0430 \u0434\u043E\u043F\u043E\u043C\u043E\u0433\u043E\u044E \u0432\u0456\u043A\u043D\u0430 \u0434\u043E\u0432\u0456\u0434\u043D\u0438\u043A\u0430"},"Required":{"Message":"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u0437\u043D\u0430\u0447\u0435\u043D\u043D\u044F"},"MaxLength":{"Message":"\u041F\u0435\u0440\u0435\u0432\u0438\u0449\u0435\u043D\u043E \u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u0443 \u0434\u043E\u0432\u0436\u0438\u043D\u0443 \u0442\u0435\u043A\u0441\u0442\u0443 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u041D\u0435 \u0434\u043E\u0441\u044F\u0433\u043D\u0443\u0442\u043E \u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u043E\u0457 \u0434\u043E\u0432\u0436\u0438\u043D\u0438 \u0442\u0435\u043A\u0441\u0442\u0443 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0434\u0430\u0442\u0438 \u0456 \u0447\u0430\u0441\u0443"},"DatePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0434\u0430\u0442\u0438"},"TimePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0447\u0430\u0441\u0443"},"RegExp":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0437\u043D\u0430\u0447\u0435\u043D\u043D\u044F"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u041A\u043E\u0434 \u043C\u0430\u0454 \u043F\u043E\u0447\u0438\u043D\u0430\u0442\u0438\u0441\u044F \u0437 \u043F\u0440\u0435\u0444\u0456\u043A\u0441\u0443 {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043F\u0440\u0438\u043D\u0430\u0439\u043C\u043D\u0456 \u043E\u0434\u0438\u043D \u0441\u0438\u043C\u0432\u043E\u043B."},"SchemaNameAllowedSymbols":{"Message":"\u0412\u0438\u043A\u043E\u0440\u0438\u0441\u0442\u043E\u0432\u0443\u0439\u0442\u0435 \u0441\u0438\u043C\u0432\u043E\u043B\u0438: a-z, A-Z, 0-9, \u043F\u0456\u0434\u043A\u0440\u0435\u0441\u043B\u0435\u043D\u043D\u044F \u0430\u0431\u043E \u0442\u0438\u0440\u0435. \u0421\u043F\u043E\u0447\u0430\u0442\u043A\u0443 \u043C\u043E\u0436\u0443\u0442\u044C \u0431\u0443\u0442\u0438 \u043B\u0438\u0448\u0435 \u043B\u0456\u0442\u0435\u0440\u0438."}},"LoadDataRequest":{"SuccessMessage":"\u0414\u0430\u043D\u0456 \u043E\u043D\u043E\u0432\u043B\u0435\u043D\u043E"}}'),"sq-AL":JSON.parse('{"Validators":{"Autocomplete":{"Message":"T\xEB lutem p\xEBrzgjidh vler\xEBn nga lista","SelectionWindowMessage":"T\xEB lutem p\xEBrzgjidh vler\xEB nga lista ose k\xEBrko duke p\xEBrdorur dritaren e k\xEBrkimit"},"Required":{"Message":"Vendos vler\xEBn"},"MaxLength":{"Message":"\xCBsht\xEB tejkaluar gjat\xEBsia maksimale e tekstit ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Gjat\xEBsia minimale e tekstit nuk \xEBsht\xEB arritur ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Format i pavlefsh\xEBm i dat\xEBs dhe or\xEBs"},"DatePickerSyntax":{"Message":"Format i pavlefsh\xEBm i dat\xEBs"},"TimePickerSyntax":{"Message":"Format i pavlefsh\xEBm i or\xEBs"},"RegExp":{"Message":"Formati i vler\xEBs i pavlefsh\xEBm"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kodi duhet t\xEB filloj\xEB me prefiksin {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"Vendos t\xEB pakt\xEBn nj\xEB simbol m\xEB shum\xEB."},"SchemaNameAllowedSymbols":{"Message":"P\xEBrdor simbolet: a-z, A-Z, 0-9, n\xEBnvij\xEBzim ose vij\xEBzim. Vet\xEBm shkronja mund t\xEB vendoset n\xEB fillim."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Kolonat u hoq\xEBn","ValidationErrorMessageSingleErrorField":"Fusha: {0}. Gabim: {1}","ValidationErrorMessageSeveralErrorFields":"Fushat: {0}. Gabim: {1}","RefreshModelDataConflict":"Creatio ka t\xEB dh\xEBna t\xEB reja p\xEBr faqen aktuale. P\xEBr t\xEB pare, ruajtur apo anuluar ndryshimet e tua dhe p\xEBr t\xEB rifreskuar faqen.","WarningModelsWithCircularDependencies":"Disa modele kan\xEB var\xEBsi ciklike dhe nuk jan\xEB ngarkuar","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"en-GB":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list"},"Required":{"Message":"Enter a value"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}"}}'),"bg-BG":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u041C\u043E\u043B\u044F, \u0438\u0437\u0431\u0435\u0440\u0438 \u0441\u0442\u043E\u0439\u043D\u043E\u0441\u0442 \u043E\u0442 \u0441\u043F\u0438\u0441\u044A\u043A\u0430","SelectionWindowMessage":"\u041C\u043E\u043B\u044F, \u0438\u0437\u0431\u0435\u0440\u0438 \u0441\u0442\u043E\u0439\u043D\u043E\u0441\u0442 \u043E\u0442 \u0441\u043F\u0438\u0441\u044A\u043A\u0430 \u0438\u043B\u0438 \u043F\u043E\u0442\u044A\u0440\u0441\u0438 \u0441 \u043F\u043E\u043C\u043E\u0449\u0442\u0430 \u043D\u0430 \u043F\u0440\u043E\u0437\u043E\u0440\u0435\u0446\u0430 \u0437\u0430 \u0441\u043F\u0440\u0430\u0432\u043A\u0430"},"Required":{"Message":"\u0412\u044A\u0432\u0435\u0434\u0438 \u0441\u0442\u043E\u0439\u043D\u043E\u0441\u0442"},"MaxLength":{"Message":"\u041F\u0440\u0435\u0432\u0438\u0448\u0435\u043D\u0430 \u0435 \u043C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u043D\u0430\u0442\u0430 \u0434\u044A\u043B\u0436\u0438\u043D\u0430 \u043D\u0430 \u0442\u0435\u043A\u0441\u0442\u0430 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u043D\u0430\u0442\u0430 \u0434\u044A\u043B\u0436\u0438\u043D\u0430 \u043D\u0430 \u0442\u0435\u043A\u0441\u0442\u0430 \u043D\u0435 \u0435 \u0434\u043E\u0441\u0442\u0438\u0433\u043D\u0430\u0442\u0430 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0444\u043E\u0440\u043C\u0430\u0442 \u0437\u0430 \u0434\u0430\u0442\u0430 \u0438 \u0447\u0430\u0441"},"DatePickerSyntax":{"Message":"\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0444\u043E\u0440\u043C\u0430\u0442 \u043D\u0430 \u0434\u0430\u0442\u0430\u0442\u0430"},"TimePickerSyntax":{"Message":"\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0444\u043E\u0440\u043C\u0430\u0442 \u043D\u0430 \u0447\u0430\u0441\u0430"},"RegExp":{"Message":"\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0444\u043E\u0440\u043C\u0430\u0442 \u043D\u0430 \u0441\u0442\u043E\u0439\u043D\u043E\u0441\u0442\u0442\u0430"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u041A\u043E\u0434\u044A\u0442 \u0442\u0440\u044F\u0431\u0432\u0430 \u0434\u0430 \u0437\u0430\u043F\u043E\u0447\u0432\u0430 \u0441 \u043F\u0440\u0435\u0444\u0438\u043A\u0441\u0430 {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"\u0412\u044A\u0432\u0435\u0434\u0438 \u043F\u043E\u043D\u0435 \u043E\u0449\u0435 \u0435\u0434\u0438\u043D \u0441\u0438\u043C\u0432\u043E\u043B."},"SchemaNameAllowedSymbols":{"Message":"\u0418\u0437\u043F\u043E\u043B\u0437\u0432\u0430\u0439 \u0441\u0438\u043C\u0432\u043E\u043B\u0438: a-z, A-Z, 0-9, \u0434\u043E\u043B\u043D\u0430 \u0447\u0435\u0440\u0442\u0430 \u0438\u043B\u0438 \u0442\u0438\u0440\u0435. \u041F\u044A\u0440\u0432\u0438 \u043C\u043E\u0433\u0430\u0442 \u0434\u0430 \u0431\u044A\u0434\u0430\u0442 \u0441\u0430\u043C\u043E \u0431\u0443\u043A\u0432\u0438."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u041A\u043E\u043B\u043E\u043D\u0430\u0442\u0430 \u0435 \u043F\u0440\u0435\u043C\u0430\u0445\u043D\u0430\u0442\u0430","ValidationErrorMessageSingleErrorField":"\u041F\u043E\u043B\u0435: {0}. \u0413\u0440\u0435\u0448\u043A\u0430: {1}","ValidationErrorMessageSeveralErrorFields":"\u041F\u043E\u043B\u0435\u0442\u0430: {0}. \u0413\u0440\u0435\u0448\u043A\u0430: {1}","RefreshModelDataConflict":"Creatio \u0438\u043C\u0430 \u043D\u043E\u0432\u0438 \u0434\u0430\u043D\u043D\u0438 \u0437\u0430 \u0442\u0435\u043A\u0443\u0449\u0430\u0442\u0430 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0430. \u0417\u0430 \u0434\u0430 \u0433\u043E \u0432\u0438\u0434\u0438\u0448, \u0437\u0430\u043F\u0430\u0437\u0438 \u0438\u043B\u0438 \u0430\u043D\u0443\u043B\u0438\u0440\u0430\u0439 \u043F\u0440\u043E\u043C\u0435\u043D\u0438\u0442\u0435 \u0441\u0438 \u0438 \u043E\u043F\u0440\u0435\u0441\u043D\u0438 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0430\u0442\u0430.","WarningModelsWithCircularDependencies":"\u041D\u044F\u043A\u043E\u0438 \u043C\u043E\u0434\u0435\u043B\u0438 \u0438\u043C\u0430\u0442 \u043A\u0440\u044A\u0433\u043E\u0432\u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043C\u043E\u0441\u0442\u0438 \u0438 \u043D\u0435 \u0441\u0430 \u0437\u0430\u0440\u0435\u0434\u0435\u043D\u0438","LoadingModelErrorMessage":"\u0412\u044A\u0437\u043D\u0438\u043A\u043D\u0430 \u0433\u0440\u0435\u0448\u043A\u0430 \u043F\u043E \u0432\u0440\u0435\u043C\u0435 \u043D\u0430 \u0438\u0437\u043F\u044A\u043B\u043D\u0435\u043D\u0438\u0435 \u043D\u0430 \u0437\u0430\u044F\u0432\u043A\u0430\u0442\u0430"}}'),"zh-TW":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u8ACB\u5F9E\u6E05\u55AE\u4E2D\u9078\u64C7\u503C","SelectionWindowMessage":"\u8ACB\u5F9E\u5217\u8868\u4E2D\u9078\u64C7\u503C\u6216\u4F7F\u7528\u67E5\u8A62\u503C\u8996\u7A97\u9032\u884C\u641C\u7D22\u3002"},"Required":{"Message":"\u8F93\u5165\u503C"},"MaxLength":{"Message":"\u8D85\u8FC7\u6587\u672C\u957F\u5EA6\u9650\u5236({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u672A\u8FBE\u6587\u672C\u6700\u5C0F\u9650\u5236({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u65E5\u671F\u548C\u65F6\u95F4\u683C\u5F0F\u65E0\u6548"},"DatePickerSyntax":{"Message":"\u65E5\u671F\u683C\u5F0F\u65E0\u6548"},"TimePickerSyntax":{"Message":"\u65F6\u95F4\u683C\u5F0F\u65E0\u6548"},"RegExp":{"Message":"\u7121\u6548\u503C\u683C\u5F0F"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u4EE3\u78BC\u5FC5\u9808\u4EE5{{schemaNamePrefix}} \u524D\u7DB4\u958B\u59CB","OnlySchemaNamePrefixMessage":"\u6700\u5C11\u8F38\u51651\u500B\u7B26\u865F"},"SchemaNameAllowedSymbols":{"Message":"\u4F7F\u7528\u7B26\u865F\uFF1Aa-z\u3001A-Z\u30010-9\u3001\u5E95\u7DDA\u6216\u7834\u6298\u865F\u3002\u9996\u5B57\u7B26\u50C5\u53EF\u70BA\u5B57\u6BCD\u3002"}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u5217\u5DF2\u79FB\u9664","ValidationErrorMessageSingleErrorField":"\u6B04\u4F4D: {0}. \u932F\u8AA4: {1}","ValidationErrorMessageSeveralErrorFields":"\u6B04\u4F4D: {0}. \u932F\u8AA4: {1}","RefreshModelDataConflict":"Creatio \u5F53\u524D\u9875\u9762\u6570\u636E\u5DF2\u66F4\u6539\u3002\u8BF7\u4FDD\u5B58\u6216\u53D6\u6D88\u540E\uFF0C\u518D\u5237\u65B0\u672C\u9875\u9762\u4EE5\u67E5\u770B","WarningModelsWithCircularDependencies":"\u6709\u4E9B\u6A21\u578B\u6709\u5FAA\u73AF\u4F9D\u8D56\u5173\u7CFB\u5E76\u4E14\u6CA1\u6709\u88AB\u52A0\u8F7D","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"no-NO":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Vennligst velg verdi fra listen"},"Required":{"Message":"Angi en verdi"},"MaxLength":{"Message":"Maksimal tekstlengde er overskredet ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minste tekstlengde ikke n\xE5dd ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Ugyldig dato og klokkeslett format"},"DatePickerSyntax":{"Message":"Ugyldig datoformat"},"TimePickerSyntax":{"Message":"Ugyldig tidsformat"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Kolonne fjernet","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}"}}'),"ko-KR":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\uBAA9\uB85D\uC5D0\uC11C \uAC12\uC744 \uC120\uD0DD\uD558\uC2ED\uC2DC\uC624.","SelectionWindowMessage":"\uBAA9\uB85D\uC5D0\uC11C \uAC12\uC744 \uC120\uD0DD\uD558\uAC70\uB098 \uC870\uD68C \uCC3D\uC744 \uC0AC\uC6A9\uD558\uC5EC \uAC80\uC0C9\uD558\uC2ED\uC2DC\uC624"},"Required":{"Message":"\uAC12\uC744 \uC785\uB825\uD569\uB2C8\uB2E4"},"MaxLength":{"Message":"\uCD5C\uB300 \uD14D\uC2A4\uD2B8 \uAE38\uC774 \uCD08\uACFC({actualLength}/{maxLength})"},"MinLength":{"Message":"\uCD5C\uC18C \uD14D\uC2A4\uD2B8 \uAE38\uC774({{actualLength}/{{minLength}})\uC5D0 \uB3C4\uB2EC\uD558\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4."},"DatetimePickerSyntax":{"Message":"\uC798\uBABB\uB41C \uB0A0\uC9DC \uBC0F \uC2DC\uAC04 \uD615\uC2DD"},"DatePickerSyntax":{"Message":"\uC798\uBABB\uB41C \uB0A0\uC9DC \uD615\uC2DD"},"TimePickerSyntax":{"Message":"\uC798\uBABB\uB41C \uC2DC\uAC04 \uD615\uC2DD"},"RegExp":{"Message":"\uC798\uBABB\uB41C \uAC12 \uD615\uC2DD"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\uC5F4 \uC81C\uAC70","ValidationErrorMessageSingleErrorField":"\uD544\uB4DC: {0}. \uC624\uB958: {1}","ValidationErrorMessageSeveralErrorFields":"\uD544\uB4DC: {0}. \uC624\uB958: {1}","RefreshModelDataConflict":"Creatio\uC5D0\uB294 \uD604\uC7AC \uD398\uC774\uC9C0\uC5D0 \uB300\uD55C \uC0C8 \uB370\uC774\uD130\uAC00 \uC788\uC2B5\uB2C8\uB2E4. \uC774 \uB370\uC774\uD130\uB97C \uBCF4\uB824\uBA74 \uBCC0\uACBD \uC0AC\uD56D\uC744 \uC800\uC7A5\uD558\uAC70\uB098 \uCDE8\uC18C\uD558\uACE0 \uD398\uC774\uC9C0\uB97C \uC0C8\uB85C \uACE0\uCE69\uB2C8\uB2E4.","WarningModelsWithCircularDependencies":"\uC77C\uBD80 \uBAA8\uB378\uC5D0 \uC6D0\uD615 \uC885\uC18D\uC131\uC774 \uC788\uC5B4 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"ja-JP":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u30EA\u30B9\u30C8\u304B\u3089\u9805\u76EE\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044","SelectionWindowMessage":"\u30EA\u30B9\u30C8\u304B\u3089\u5024\u3092\u9078\u629E\u3059\u308B\u304B\u3001\u691C\u7D22\u7A93\u3088\u308A\u691C\u7D22\u3057\u3066\u304F\u3060\u3055\u3044"},"Required":{"Message":"\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044"},"MaxLength":{"Message":"\u6700\u5927\u6587\u5B57\u6570\u3092\u8D85\u3048\u307E\u3057\u305F ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u6700\u5C0F\u6587\u5B57\u6570\u306B\u9054\u3057\u3066\u3044\u307E\u305B\u3093 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u65E5\u4ED8\u3068\u6642\u523B\u306E\u5F62\u5F0F\u304C\u6B63\u3057\u304F\u3042\u308A\u307E\u305B\u3093"},"DatePickerSyntax":{"Message":"\u7121\u52B9\u306A\u65E5\u4ED8\u30D5\u30A9\u30FC\u30DE\u30C3\u30C8"},"TimePickerSyntax":{"Message":"\u7121\u52B9\u306A\u6642\u9593\u5F62\u5F0F\u3067\u3059"},"RegExp":{"Message":"\u5024\u306E\u5F62\u5F0F\u304C\u7121\u52B9\u3067\u3059"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u5217\u304C\u524A\u9664\u3055\u308C\u307E\u3057\u305F","ValidationErrorMessageSingleErrorField":"\u30D5\u30A3\u30FC\u30EB\u30C9: {0}. \u30A8\u30E9\u30FC: {1}","ValidationErrorMessageSeveralErrorFields":"\u30D5\u30A3\u30FC\u30EB\u30C9: {0}. \u30A8\u30E9\u30FC: {1}","RefreshModelDataConflict":"Creatio\u306B\u306F\u73FE\u5728\u306E\u30DA\u30FC\u30B8\u306B\u65B0\u3057\u3044\u30C7\u30FC\u30BF\u304C\u3042\u308A\u307E\u3059\u3002 \u5909\u66F4\u3092\u8868\u793A\u3059\u308B\u306B\u306F\u3001\u4FDD\u5B58\u307E\u305F\u306F\u30AD\u30E3\u30F3\u30BB\u30EB\u3057\u3066\u30DA\u30FC\u30B8\u3092\u66F4\u65B0\u3057\u3066\u304F\u3060\u3055\u3044\u3002","WarningModelsWithCircularDependencies":"\u4E00\u90E8\u306E\u30E2\u30C7\u30EB\u306B\u306F\u5FAA\u74B0\u4F9D\u5B58\u95A2\u4FC2\u304C\u3042\u308A\u3001\u8AAD\u307F\u8FBC\u307E\u308C\u3066\u3044\u307E\u305B\u3093","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"fr-CA":JSON.parse(`{"Validators":{"Autocomplete":{"Message":"Merci de s\xE9lectionner la valeur dans la liste"},"Required":{"Message":"Saisir une valeur"},"MaxLength":{"Message":"Longueur maximale du texte d\xE9pass\xE9e ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Longueur de texte minimale non atteinte ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Format de date et d'heure non valide"},"DatePickerSyntax":{"Message":"Format de date invalide"},"TimePickerSyntax":{"Message":"Format d'heure non valide"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed"}}`),zh:JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list"},"Required":{"Message":"Enter a value"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed"}}'),"vi-VN":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Vui l\xF2ng ch\u1ECDn gi\xE1 tr\u1ECB t\u1EEB danh s\xE1ch","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Nh\u1EADp m\u1ED9t gi\xE1 tr\u1ECB"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"tr-TR":JSON.parse('{"Validators":{"Autocomplete":{"Message":"L\xFCtfen listeden de\u011Fer se\xE7in","SelectionWindowMessage":"L\xFCtfen listeden de\u011Fer se\xE7in veya arama penceresini kullanarak aray\u0131n"},"Required":{"Message":"De\u011Fer girin"},"MaxLength":{"Message":"Maksimum metin uzunlu\u011Fu a\u015F\u0131ld\u0131 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum metin uzunlu\u011Funa ula\u015F\u0131lamad\u0131 ({{ActuAlghength}}/{{MinLength}})"},"DatetimePickerSyntax":{"Message":"Ge\xE7ersiz Tarih ve Saat Bi\xE7imi"},"DatePickerSyntax":{"Message":"Ge\xE7ersiz tarih bi\xE7imi"},"TimePickerSyntax":{"Message":"Ge\xE7ersiz Zaman Bi\xE7imi"},"RegExp":{"Message":"Ge\xE7ersiz de\u011Fer bi\xE7imi"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kod {{schemanameprefix}} \xF6neki ile ba\u015Flamal\u0131d\u0131r.","OnlySchemaNamePrefixMessage":"En az bir sembol daha girin."},"SchemaNameAllowedSymbols":{"Message":"Sembolleri kullan\u0131n: A-Z, A-Z, 0-9, alt \xE7izgi veya \xE7izgi.\u0130lk \xF6nce sadece harfler olabilir."}},"BaseViewModel":{"DataSourceAttributeRemoved":"S\xFCtun kald\u0131r\u0131ld\u0131","ValidationErrorMessageSingleErrorField":"Alan: {0}.Hata: {1}","ValidationErrorMessageSeveralErrorFields":"Alanlar: {0}.Hata: {1}","RefreshModelDataConflict":"Creatio, ge\xE7erli sayfa i\xE7in yeni verilere sahiptir.G\xF6r\xFCnt\xFClemek i\xE7in de\u011Fi\u015Fikliklerinizi kaydedin veya iptal edin ve sayfay\u0131 yenileyin.","WarningModelsWithCircularDependencies":"Baz\u0131 modellerin dairesel ba\u011F\u0131ml\u0131l\u0131klar\u0131 vard\u0131r ve y\xFCklenmemi\u015Ftir","LoadingModelErrorMessage":"Sorgu y\xFCr\xFCtme s\u0131ras\u0131nda hata olu\u015Ftu"}}'),"th-TH":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"\u0E1B\u0E49\u0E2D\u0E19\u0E04\u0E48\u0E32"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"sv-SE":JSON.parse('{"Validators":{"Autocomplete":{"Message":"V\xE4nligen v\xE4lj v\xE4rde ur listan","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Ange ett v\xE4rde"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"ro-RO":JSON.parse('{"Validators":{"Autocomplete":{"Message":"V\u0103 rug\u0103m s\u0103 selecta\u021Bi valoarea din list\u0103","SelectionWindowMessage":"V\u0103 rug\u0103m s\u0103 selecta\u0163i valoarea din list\u0103 sau s\u0103 c\u0103uta\u0163i folosind fereastra lookup-ului"},"Required":{"Message":"Introdu o valoare"},"MaxLength":{"Message":"Lungimea maxim\u0103 a textului a fost dep\u0103\u0219it\u0103 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Lungimea minim\u0103 a textului nu a fost atins\u0103 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Format dat\u0103 \u0219i or\u0103 invalid"},"DatePickerSyntax":{"Message":"Format dat\u0103 invalid"},"TimePickerSyntax":{"Message":"Format orar invalid"},"RegExp":{"Message":"Format valoare invalid"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Codul trebuie s\u0103 \xEEnceap\u0103 cu {{schemaNamePrefix}}  prefix.","OnlySchemaNamePrefixMessage":"Introduce\u021Bi cel pu\u021Bin \xEEnc\u0103 un simbol."},"SchemaNameAllowedSymbols":{"Message":"Folosi\u021Bi simbolurile: a-z, A-Z, 0-9, underscore sau dash. Doar litere pot fi primul."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Coloan\u0103 eliminat\u0103","ValidationErrorMessageSingleErrorField":"C\xE2mp: {0}. Eroare: {1}","ValidationErrorMessageSeveralErrorFields":"C\xE2mpuri: {0}. Eroare: {1}","RefreshModelDataConflict":"Creatio are date noi pentru pagina curent\u0103. Pentru a o vizualiza, salva\u021Bi sau anula\u021Bi modific\u0103rile \u0219i re\xEEmprosp\u0103ta\u021Bi pagina.","WarningModelsWithCircularDependencies":"Unele modele au dependen\u021Be circulare \u0219i nu au fost \xEEnc\u0103rcate","LoadingModelErrorMessage":"A ap\u0103rut o eroare \xEEn timpul execut\u0103rii interog\u0103rii"}}'),"pt-PT":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Selecione um valor da lista","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Insira um valor"},"MaxLength":{"Message":"Limite m\xE1ximo de texto excedido ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Limite m\xEDnimo de texto n\xE3o alcan\xE7ado ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Formado de data e hora inv\xE1lido"},"DatePickerSyntax":{"Message":"Formato de data inv\xE1lido"},"TimePickerSyntax":{"Message":"Formato de hora inv\xE1lido"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Coluna removida","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"pt-BR":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Favor, selecionar um valor da lista","SelectionWindowMessage":"Selecionar o valor na lista ou pesquisar utilizando a janela de pesquisas"},"Required":{"Message":"Inserir um valor"},"MaxLength":{"Message":"Comprimento m\xE1ximo de texto excedido ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Comprimento m\xEDnimo do texto n\xE3o atingido ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Formato de data e hora inv\xE1lido"},"DatePickerSyntax":{"Message":"Formato de data inv\xE1lido"},"TimePickerSyntax":{"Message":"Formato de hora inv\xE1lido"},"RegExp":{"Message":"Formato de valor inv\xE1lido"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"O c\xF3digo deve come\xE7ar com o prefixo \\"{{schemaNamePrefix}}\\"","OnlySchemaNamePrefixMessage":"Inserir ao menos mais um s\xEDmbolo."},"SchemaNameAllowedSymbols":{"Message":"Usar os s\xEDmbolos: a-z, A-Z, 0-9, sublinhados ou tra\xE7os. Apenas letras podem vir primeiramente."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Coluna removida","ValidationErrorMessageSingleErrorField":"Campo: {0}. Erro: {1}","ValidationErrorMessageSeveralErrorFields":"Campos: {0}. Erro: {1}","RefreshModelDataConflict":"Creatio tem novos dados para a p\xE1gina atual. Para visualiz\xE1-los, salvar ou cancelar as suas altera\xE7\xF5es e atualizar a p\xE1gina.","WarningModelsWithCircularDependencies":"Alguns modelos t\xEAm depend\xEAncias circulares e n\xE3o foram carregadas","LoadingModelErrorMessage":"Ocorreu um erro durante a execu\xE7\xE3o da query"}}'),"pl-PL":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Wybierz warto\u015B\u0107 z listy","SelectionWindowMessage":"Prosz\u0119 wybra\u0107 warto\u015B\u0107 z listy lub wyszuka\u0107 za pomoc\u0105 okna wyszukiwania"},"Required":{"Message":"Wpisz warto\u015B\u0107"},"MaxLength":{"Message":"Przekroczono maksymaln\u0105 d\u0142ugo\u015B\u0107 tekstu ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimalna d\u0142ugo\u015B\u0107 tekstu nie zosta\u0142a osi\u0105gni\u0119ta ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Nieprawid\u0142owy format daty i godziny"},"DatePickerSyntax":{"Message":"Nieprawid\u0142owy format daty"},"TimePickerSyntax":{"Message":"Nieprawid\u0142owy format czasu"},"RegExp":{"Message":"Nieprawid\u0142owy format warto\u015Bci"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kod musi zaczyna\u0107 si\u0119 od prefiksu \\"{{schemaNamePrefix}}\\"","OnlySchemaNamePrefixMessage":"Wprowad\u017A co najmniej jeden dodatkowy symbol."},"SchemaNameAllowedSymbols":{"Message":"U\u017Cyj symboli: a-z, A-Z, 0-9, podkre\u015Blenie lub my\u015Blnik. Tylko litery mog\u0105 by\u0107 pierwsze."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Kolumna usuni\u0119ta","ValidationErrorMessageSingleErrorField":"Pola: {0}. B\u0142\u0105d: {1}","ValidationErrorMessageSeveralErrorFields":"Pola: {0}. B\u0142\u0105d: {1}","RefreshModelDataConflict":"Creatio ma nowe dane dla bie\u017C\u0105cej strony. Aby je wy\u015Bwietli\u0107, zapisz lub anuluj zmiany i od\u015Bwie\u017C stron\u0119.","WarningModelsWithCircularDependencies":"Niekt\xF3re modele maj\u0105 cykliczne zale\u017Cno\u015Bci i nie zosta\u0142y za\u0142adowane","LoadingModelErrorMessage":"Wyst\u0105pi\u0142 b\u0142\u0105d podczas wykonywania zapytania"}}'),no:JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list"},"Required":{"Message":"Enter a value"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed"}}'),"nl-NL":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Selecteer een waarde uit de lijst","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Voer een waarde in"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"De code moet beginnen met het prefix {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"Voer minstens nog \xE9\xE9n symbool in."},"SchemaNameAllowedSymbols":{"Message":"Gebruik symbolen: a-z, A-Z, 0-9, underscore of dash. Alleen letters kunnen eerst komen."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"lv-LV":JSON.parse('{"Validators":{"Autocomplete":{"Message":"L\u016Bdzu, izv\u0113lieties v\u0113rt\u012Bbu no saraksta","SelectionWindowMessage":"L\u016Bdzu, izv\u0113lieties v\u0113rt\u012Bbu no saraksta vai mekl\u0113jiet, izmantojot logu"},"Required":{"Message":"Ievadiet v\u0113rt\u012Bbu"},"MaxLength":{"Message":"P\u0101rsniegts maksim\u0101lais teksta garums ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minim\u0101lais teksta garums nav sasniegts ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Neder\u012Bgs datuma un laika form\u0101ts"},"DatePickerSyntax":{"Message":"Neder\u012Bgs datu form\u0101ts"},"TimePickerSyntax":{"Message":"Neder\u012Bgs laika form\u0101ts"},"RegExp":{"Message":"Neder\u012Bgs v\u0113rt\u012Bbu form\u0101ts"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kodam j\u0101s\u0101kas ar \\"{{schemaNamePrefix}}\\" prefiksu.","OnlySchemaNamePrefixMessage":"Ievadiet vismaz vienu simbolu."},"SchemaNameAllowedSymbols":{"Message":"Izmantojiet simbolus: a-z, A-Z, 0-9, pasv\u012Btrojums vai domuz\u012Bme. Tikai burti var b\u016Bt pirmie."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Kolonna no\u0146emta","ValidationErrorMessageSingleErrorField":"Lauka: {0}. K\u013C\u016Bda: {1}","ValidationErrorMessageSeveralErrorFields":"Lauki: {0}. K\u013C\u016Bda: {1}","RefreshModelDataConflict":"Creatio ir jauni dati pa\u0161reiz\u0113jai lapai. Lai tos apskat\u012Btu, saglab\u0101jiet vai atceliet savas izmai\u0146as un atjaunojiet lapu.","WarningModelsWithCircularDependencies":"Da\u017Eiem mode\u013Ciem ir apa\u013Cas atkar\u012Bbas un tie nav iel\u0101d\u0113ti","LoadingModelErrorMessage":"K\u013C\u016Bda notika vaic\u0101juma izpildes laik\u0101"}}'),"kk-KZ":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list"},"Required":{"Message":"Enter a value"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}"}}'),"it-IT":JSON.parse(`{"Validators":{"Autocomplete":{"Message":"Seleziona il valore dalla lista","SelectionWindowMessage":"Seleziona il valore dalla lista o cercalo usando la finestra di lookup"},"Required":{"Message":"Inserisci un valore"},"MaxLength":{"Message":"Lunghezza massima del testo superata ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Lunghezza minima del testo non raggiunta ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Formato data e ora non valido"},"DatePickerSyntax":{"Message":"Formato data non valido"},"TimePickerSyntax":{"Message":"Formato orario non valido"},"RegExp":{"Message":"Formato valore non valido"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Il codice deve iniziare con il prefisso {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"Inserisci almeno un altro simbolo."},"SchemaNameAllowedSymbols":{"Message":"Usa i simboli: a-z, A-Z, 0-9, trattino basso o trattino. Solo le lettere possono essere le prime."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Colonna rimossa","ValidationErrorMessageSingleErrorField":"Campo: {0}. Errore: {1}","ValidationErrorMessageSeveralErrorFields":"Campi: {0}. Errore: {1}","RefreshModelDataConflict":"Creatio ha nuovi dati per la pagina corrente. Per visualizzarli, salva o annulla le modifiche e aggiorna la pagina.","WarningModelsWithCircularDependencies":"Alcuni modelli hanno dipendenze circolari e non sono stati caricati","LoadingModelErrorMessage":"Errore durante l'esecuzione della query"}}`),"id-ID":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Silakan pilih nilai dari daftar","SelectionWindowMessage":"Pilih nilai dari daftar atau cari menggunakan jendela pencarian"},"Required":{"Message":"Masukkan nilai"},"MaxLength":{"Message":"Panjang teks maksimum terlampaui ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Panjang teks minimum tidak tercapai ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Format tanggal dan waktu tidak valid"},"DatePickerSyntax":{"Message":"Format tanggal tidak valid"},"TimePickerSyntax":{"Message":"Format waktu tidak valid"},"RegExp":{"Message":"Format nilai tidak valid"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kode harus dimulai dengan awalan {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"Masukkan minimal satu simbol lagi."},"SchemaNameAllowedSymbols":{"Message":"Gunakan simbol: a-z, A-Z, 0-9, garis bawah atau tanda hubung. Hanya huruf yang bisa menjadi yang pertama."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Kolom dihapus","ValidationErrorMessageSingleErrorField":"Bidang {0}. Kesalahan: {1}","ValidationErrorMessageSeveralErrorFields":"Bidang {0}. Kesalahan: {1}","RefreshModelDataConflict":"Creatio memiliki data baru untuk halaman saat ini. Untuk melihatnya, simpan atau batalkan perubahan Anda dan perbarui halaman.","WarningModelsWithCircularDependencies":"Beberapa model memiliki referensi melingkar dan belum dimuat","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"he-IL":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u05D0\u05E0\u05D0 \u05D1\u05D7\u05E8 \u05E2\u05E8\u05DA \u05DE\u05D4\u05E8\u05E9\u05D9\u05DE\u05D4","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"\u05D4\u05D6\u05DF \u05E2\u05E8\u05DA"},"MaxLength":{"Message":"\u05D7\u05E8\u05D9\u05D2\u05D4 \u05DE\u05D0\u05D5\u05E8\u05DA \u05D4\u05D8\u05E7\u05E1\u05D8 \u05D4\u05DE\u05E8\u05D1\u05D9 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u05DC\u05D0 \u05D4\u05D5\u05E9\u05D2 \u05D0\u05D5\u05E8\u05DA \u05D4\u05D8\u05E7\u05E1\u05D8 \u05D4\u05DE\u05D9\u05E0\u05D9\u05DE\u05DC\u05D9 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u05E4\u05D5\u05E8\u05DE\u05D8 \u05EA\u05D0\u05E8\u05D9\u05DA \u05D5\u05E9\u05E2\u05D4 \u05DC\u05D0 \u05D7\u05D5\u05E7\u05D9"},"DatePickerSyntax":{"Message":"\u05E4\u05D5\u05E8\u05DE\u05D8 \u05EA\u05D0\u05E8\u05D9\u05DA \u05DC\u05D0 \u05E0\u05DB\u05D5\u05DF"},"TimePickerSyntax":{"Message":"\u05E4\u05D5\u05E8\u05DE\u05D8 \u05D6\u05DE\u05DF \u05DC\u05D0 \u05D7\u05D5\u05E7\u05D9"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u05D4\u05E7\u05D5\u05D3 \u05D7\u05D9\u05D9\u05D1 \u05DC\u05D4\u05EA\u05D7\u05D9\u05DC \u05E2\u05DD \u05D4\u05E7\u05D9\u05D3\u05D5\u05DE\u05EA {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"\u05D4\u05D6\u05DF \u05DC\u05E4\u05D7\u05D5\u05EA \u05EA\u05D5 \u05E0\u05D5\u05E1\u05E3 \u05D0\u05D7\u05D3."},"SchemaNameAllowedSymbols":{"Message":"\u05D4\u05E9\u05EA\u05DE\u05E9 \u05D1\u05E1\u05DE\u05DC\u05D9\u05DD: a-z, A-Z, 0-9, \u05E7\u05D5 \u05EA\u05D7\u05EA\u05D9 \u05D0\u05D5 \u05DE\u05E7\u05E3. \u05E8\u05E7 \u05D0\u05D5\u05EA\u05D9\u05D5\u05EA \u05D9\u05DB\u05D5\u05DC\u05D5\u05EA \u05DC\u05D4\u05D9\u05D5\u05EA \u05E8\u05D0\u05E9\u05D5\u05E0\u05D5\u05EA."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u05D4\u05E2\u05DE\u05D5\u05D3\u05D4 \u05D4\u05D5\u05E1\u05E8\u05D4","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"\u05D0\u05D9\u05E8\u05E2\u05D4 \u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05DE\u05D4\u05DC\u05DA \u05D1\u05D9\u05E6\u05D5\u05E2 \u05D4\u05E9\u05D0\u05D9\u05DC\u05EA\u05D4"}}'),"fr-FR":JSON.parse(`{"Validators":{"Autocomplete":{"Message":"Merci de s\xE9lectionner la valeur dans la liste","SelectionWindowMessage":"Merci de s\xE9lectionner une valeur dans la liste ou rechercher \xE0 l'aide de la fen\xEAtre de recherche"},"Required":{"Message":"Saisir une valeur"},"MaxLength":{"Message":"Longueur maximale du texte d\xE9pass\xE9e ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Longueur de texte minimale non atteinte ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Format de date et d'heure non valide"},"DatePickerSyntax":{"Message":"Format de date invalide"},"TimePickerSyntax":{"Message":"Format d'heure non valide"},"RegExp":{"Message":"Format de valeur invalide"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Le code doit commencer par le pr\xE9fixe \\"{{schemaNamePrefix}}\\"","OnlySchemaNamePrefixMessage":"Entrez au moins un symbole de plus."},"SchemaNameAllowedSymbols":{"Message":"Utilisez des symboles : a-z, A-Z, 0-9, tiret bas ou tiret. Seules les lettres peuvent \xEAtre en premier."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Colonne supprim\xE9e","ValidationErrorMessageSingleErrorField":"Champ: {0}. Erreur: {1}","ValidationErrorMessageSeveralErrorFields":"Champs : {0}. Erreur: {1}","RefreshModelDataConflict":"Creatio a de nouvelles donn\xE9es pour la page en cours. Pour les visualiser, enregistrez ou annulez vos modifications et actualisez la page.","WarningModelsWithCircularDependencies":"Certains mod\xE8les disposent de d\xE9pendances circulaires et n'ont pas \xE9t\xE9 charg\xE9s","LoadingModelErrorMessage":"Une erreur s'est produite lors de l'ex\xE9cution de la requ\xEAte"}}`),"fa-IR":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list"},"Required":{"Message":"\u06CC\u06A9 \u0645\u0642\u062F\u0627\u0631 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}"}}'),"es-ES":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Seleccione un valor de la lista","SelectionWindowMessage":"Por favor, seleccione el valor de la lista o busque usando la ventana de b\xFAsqueda"},"Required":{"Message":"Ingrese valor"},"MaxLength":{"Message":"Se super\xF3 la longitud m\xE1xima del texto ({{actualLength}} / {{maxLength}})"},"MinLength":{"Message":"No se alcanz\xF3 la longitud m\xEDnima del texto ({{actualLength}} / {{minLength}})"},"DatetimePickerSyntax":{"Message":"Formato de fecha y hora inv\xE1lido"},"DatePickerSyntax":{"Message":"Formato de fecha inv\xE1lido"},"TimePickerSyntax":{"Message":"Formato de hora inv\xE1lido"},"RegExp":{"Message":"Formato de valor inv\xE1lido"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"El c\xF3digo debe comenzar con el prefijo \\"{{schemaNamePrefix}}\\".","OnlySchemaNamePrefixMessage":"Ingrese al menos un s\xEDmbolo m\xE1s."},"SchemaNameAllowedSymbols":{"Message":"Use s\xEDmbolos: a-z, A-Z, 0-9, guion bajo o guion. Solo las letras pueden ser las primeras."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Columna eliminada","ValidationErrorMessageSingleErrorField":"Campo: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Campos: {0}. Error: {1}","RefreshModelDataConflict":"Creatio tiene nuevos datos para la p\xE1gina actual. Para verlo, guarde o cancele los cambios y actualice la p\xE1gina.","WarningModelsWithCircularDependencies":"Algunos modelos tienen dependencias circulares y no han sido cargados","LoadingModelErrorMessage":"Se produjo un error durante la ejecuci\xF3n de la consulta"}}'),"de-DE":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Bitte w\xE4hlen Sie einen Wert aus der Liste","SelectionWindowMessage":"Bitte w\xE4hlen Sie den Wert aus der Liste oder suchen Sie im Suchfenster"},"Required":{"Message":"Wert eingeben"},"MaxLength":{"Message":"Maximale Textl\xE4nge \xFCberschritten ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimale Textl\xE4nge nicht erreicht ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Ung\xFCltiges Datums- und Zeitformat"},"DatePickerSyntax":{"Message":"Ung\xFCltiges Datumsformat"},"TimePickerSyntax":{"Message":"Ung\xFCltiges Zeitformat"},"RegExp":{"Message":"Ung\xFCltiges Wertformat"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code muss mit dem {{schemaNamePrefix}} Pr\xE4fix beginnen.","OnlySchemaNamePrefixMessage":"Geben Sie mindestens ein weiteres Zeichen ein."},"SchemaNameAllowedSymbols":{"Message":"Symbole verwenden: a-z, A-Z, 0-9, Unterstrich oder Bindestrich. Das erste Zeichen muss ein Buchstabe sein."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Spalte entfernt","ValidationErrorMessageSingleErrorField":"Felder: {0}. Fehler: {1}","ValidationErrorMessageSeveralErrorFields":"Felder: {0}. Fehler: {1}","RefreshModelDataConflict":"Creatio hat neue Daten f\xFCr die aktuelle Seite. Um sie anzuzeigen, speichern oder l\xF6schen Sie Ihre \xC4nderungen und aktualisieren Sie die Seite.","WarningModelsWithCircularDependencies":"Einige Modelle haben zirkul\xE4re Abh\xE4ngigkeiten und wurden nicht geladen","LoadingModelErrorMessage":"Fehler bei der Ausf\xFChrung der Abfrage"}}'),"cs-CZ":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Vyberte pros\xEDm hodnotu ze seznamu","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Zadejte hodnotu"},"MaxLength":{"Message":"Byla p\u0159ekro\u010Dena maxim\xE1ln\xED d\xE9lka textu ({{Aktu\xE1ln\xEDD\xE9lka}}/{{Maxim\xE1ln\xEDD\xE9lka}})"},"MinLength":{"Message":"Nebyla dosa\u017Eena minim\xE1ln\xED d\xE9lka textu ({{Aktu\xE1ln\xEDD\xE9lka}}/{{Minim\xE1ln\xEDD\xE9lka}})"},"DatetimePickerSyntax":{"Message":"Neplatn\xFD form\xE1t data a \u010Dasu"},"DatePickerSyntax":{"Message":"Neplatn\xFD form\xE1t data"},"TimePickerSyntax":{"Message":"Neplatn\xFD form\xE1t \u010Dasu"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"ar-SA":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u0642\u064A\u0645\u0629 \u0645\u0646 \u0627\u0644\u0642\u0627\u0626\u0645\u0629","SelectionWindowMessage":"\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u0642\u064A\u0645\u0629 \u0645\u0646 \u0627\u0644\u0642\u0627\u0626\u0645\u0629 \u0623\u0648 \u0627\u0644\u0628\u062D\u062B \u0628\u0627\u0633\u062A\u062E\u062F\u0627\u0645 \u0646\u0627\u0641\u0630\u0629 \u0627\u0644\u0628\u062D\u062B"},"Required":{"Message":"\u0627\u062F\u062E\u0644 \u0642\u064A\u0645\u0629"},"MaxLength":{"Message":"\u062A\u062C\u0627\u0648\u0632 \u0627\u0644\u062D\u062F \u0627\u0644\u0623\u0642\u0635\u0649 \u0644\u0637\u0648\u0644 \u0627\u0644\u0646\u0635 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u0644\u0645 \u064A\u062A\u0645 \u0628\u0644\u0648\u063A \u0627\u0644\u062D\u062F \u0627\u0644\u0623\u062F\u0646\u0649 \u0644\u0637\u0648\u0644 \u0627\u0644\u0646\u0635 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u062A\u0646\u0633\u064A\u0642 \u0627\u0644\u062A\u0627\u0631\u064A\u062E \u0648\u0627\u0644\u0648\u0642\u062A \u063A\u064A\u0631 \u0635\u0627\u0644\u062D"},"DatePickerSyntax":{"Message":"\u062A\u0646\u0633\u064A\u0642 \u0627\u0644\u062A\u0627\u0631\u064A\u062E \u063A\u064A\u0631 \u0635\u0627\u0644\u062D"},"TimePickerSyntax":{"Message":"\u062A\u0646\u0633\u064A\u0642 \u0627\u0644\u0648\u0642\u062A \u063A\u064A\u0631 \u0635\u0627\u0644\u062D"},"RegExp":{"Message":"\u062A\u0646\u0633\u064A\u0642 \u0627\u0644\u0642\u064A\u0645\u0629 \u063A\u064A\u0631 \u0635\u0627\u0644\u062D"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u064A\u062C\u0628 \u0623\u0646 \u064A\u0628\u062F\u0623 \u0627\u0644\u0631\u0645\u0632 \u0628\u0628\u0627\u062F\u0626\u0629 {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"\u0623\u062F\u062E\u0644 \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644 \u0631\u0645\u0632 \u0625\u0636\u0627\u0641\u064A \u0648\u0627\u062D\u062F."},"SchemaNameAllowedSymbols":{"Message":"\u0627\u0633\u062A\u062E\u062F\u0645 \u0627\u0644\u0631\u0645\u0648\u0632: a-z\u060C \u0623\u0648 A-Z \u0623\u0648 0-9 (_) \u0623\u0648 (-). \u0648\u064A\u0645\u0643\u0646 \u0641\u0642\u0637 \u0644\u0644\u062D\u0631\u0648\u0641 \u0623\u0646 \u062A\u0643\u0648\u0646 \u0623\u0648\u0644\u064B\u0627."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u0639\u0645\u0648\u062F","ValidationErrorMessageSingleErrorField":"\u0627\u0644\u062D\u0642\u0644: {0}. \u0627\u0644\u062E\u0637\u0623: {1}","ValidationErrorMessageSeveralErrorFields":"\u0627\u0644\u062D\u0642\u0648\u0644: {0}. \u0627\u0644\u062E\u0637\u0623: {1}","RefreshModelDataConflict":"\u0644\u062F\u0649 Creatio \u0628\u064A\u0627\u0646\u0627\u062A \u062C\u062F\u064A\u062F\u0629 \u0644\u0644\u0635\u0641\u062D\u0629 \u0627\u0644\u062D\u0627\u0644\u064A\u0629. \u0644\u0639\u0631\u0636\u0647\u0627\u060C \u064A\u062C\u0628 \u062D\u0641\u0638 \u0623\u0648 \u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u062A\u063A\u064A\u064A\u0631\u0627\u062A \u0627\u0644\u062E\u0627\u0635\u0629 \u0628\u0643 \u0648\u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0635\u0641\u062D\u0629.","WarningModelsWithCircularDependencies":"\u0628\u0639\u0636 \u0627\u0644\u0646\u0645\u0627\u0630\u062C \u0644\u0647\u0627 \u062A\u0628\u0639\u064A\u0627\u062A \u062F\u0627\u0626\u0631\u064A\u0629 \u0648\u0644\u0645 \u064A\u062A\u0645 \u062A\u062D\u0645\u064A\u0644\u0647\u0627","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"en-US":JSON.parse(`{"Validators":{"Autocomplete":{"Message":"Please select value from the list","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Enter a value"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."},"UniqueCodeColumnValue":{"Message":"The value '{{controlValue}}' already exists in the 'Code' column."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"},"LoadDataRequest":{"SuccessMessage":"Data has been refreshed"}}`),"ru-RU":JSON.parse(`{"Validators":{"Autocomplete":{"Message":"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 \u0438\u0437 \u0441\u043F\u0438\u0441\u043A\u0430","SelectionWindowMessage":"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 \u0438\u0437 \u0441\u043F\u0438\u0441\u043A\u0430 \u0438\u043B\u0438 \u043E\u043A\u043D\u0430 \u0432\u044B\u0431\u043E\u0440\u0430"},"Required":{"Message":"\u041D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0443\u043A\u0430\u0437\u0430\u0442\u044C \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435"},"MaxLength":{"Message":"\u041F\u0440\u0435\u0432\u044B\u0448\u0435\u043D\u0430 \u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u0430\u044F \u0434\u043B\u0438\u043D\u0430 \u0442\u0435\u043A\u0441\u0442\u0430 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u041D\u0435 \u0434\u043E\u0441\u0442\u0438\u0433\u043D\u0443\u0442\u0430 \u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u0430\u044F \u0434\u043B\u0438\u043D\u0430 \u0442\u0435\u043A\u0441\u0442\u0430 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0434\u0430\u0442\u044B \u0438 \u0432\u0440\u0435\u043C\u0435\u043D\u0438"},"DatePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0434\u0430\u0442\u044B"},"TimePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0432\u0440\u0435\u043C\u0435\u043D\u0438"},"RegExp":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u041A\u043E\u0434 \u0434\u043E\u043B\u0436\u0435\u043D \u043D\u0430\u0447\u0438\u043D\u0430\u0442\u044C\u0441\u044F \u0441 \u043F\u0440\u0435\u0444\u0438\u043A\u0441\u0430 {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0445\u043E\u0442\u044F \u0431\u044B \u0435\u0449\u0435 \u043E\u0434\u0438\u043D \u0441\u0438\u043C\u0432\u043E\u043B."},"SchemaNameAllowedSymbols":{"Message":"\u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 a-z, A-Z, 0-9, \u043D\u0438\u0436\u043D\u0435\u0435 \u043F\u043E\u0434\u0447\u0435\u0440\u043A\u0438\u0432\u0430\u043D\u0438\u0435 \u0438\u043B\u0438 \u0442\u0438\u0440\u0435. \u0422\u043E\u043B\u044C\u043A\u043E \u0431\u0443\u043A\u0432\u044B \u043C\u043E\u0433\u0443\u0442 \u0431\u044B\u0442\u044C \u043F\u0435\u0440\u0432\u044B\u043C\u0438."},"UniqueCodeColumnValue":{"Message":"\u0417\u043D\u0430\u0447\u0435\u043D\u0438\u0435 '{{controlValue}}' \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u043A\u043E\u043B\u043E\u043D\u043A\u0435 '\u041A\u043E\u0434'."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u041A\u043E\u043B\u043E\u043D\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0430","ValidationErrorMessageSingleErrorField":"\u041F\u043E\u043B\u0435: {0}. \u041E\u0448\u0438\u0431\u043A\u0430: {1}","ValidationErrorMessageSeveralErrorFields":"\u041F\u043E\u043B\u044F: {0}. \u041E\u0448\u0438\u0431\u043A\u0430: {1}","RefreshModelDataConflict":"\u0412 \u0441\u0438\u0441\u0442\u0435\u043C\u0435 \u0435\u0441\u0442\u044C \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435 \u0434\u043B\u044F \u0442\u0435\u043A\u0443\u0449\u0435\u0439 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u044B. \u0427\u0442\u043E\u0431\u044B \u0438\u0445 \u043E\u0442\u043E\u0431\u0440\u0430\u0437\u0438\u0442\u044C. \u0441\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u0435 \u0438\u043B\u0438 \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u0435 \u0432\u043D\u0435\u0441\u0435\u043D\u043D\u044B\u0435 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0438 \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443.","WarningModelsWithCircularDependencies":"\u041D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u043C\u043E\u0434\u0435\u043B\u0438 \u0438\u043C\u0435\u044E\u0442 \u0446\u0438\u043A\u043B\u0438\u0447\u0435\u0441\u043A\u0438\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043C\u043E\u0441\u0442\u0438 \u0438 \u043D\u0435 \u0431\u044B\u043B\u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u044B","LoadingModelErrorMessage":"\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 \u0437\u0430\u043F\u0440\u043E\u0441\u0430"},"LoadDataRequest":{"SuccessMessage":"\u0414\u0430\u043D\u043D\u044B\u0435 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u044B"}}`)};let Wt=class ls{static{this.\u0275fac=function(t){return new(t||ls)}}static{this.\u0275mod=p.\u0275\u0275defineNgModule({type:ls})}static{this.\u0275inj=p.\u0275\u0275defineInjector({providers:[O,se,Fe,G,n.FeatureService,{provide:W,useClass:ge},{provide:z,useClass:be},{provide:K,useClass:me},m.USER_INFO_PROVIDER,j,m.ResourceFinderService,Zs,{provide:Je,useClass:Z},{provide:Jt,useValue:m.DefaultZones.Root},{provide:m.CRT_NAVIGATION_LOCK_TOKEN,useValue:m.CrtNoopNavigationLock.instance},Ys,de,he,xs,qs],imports:[Ks.CommonModule,x.ReactiveFormsModule,ke,A.CrtLibTranslateModule.forRoot({i18n:Ui}),E.BusinessRulesModule,qa.ExpressionEngineModule]})}};Wt=(0,g.__decorate)([(0,n.CrtModule)({includes:[qa.ExpressionEngineModule],requestHandlers:[Pt,Et,Nt,It,wt,xt,Vt,Tt,qt,Lt,Ft,Ot],validators:[Ze,dt,pt,gt,ft,Qe,_t,yt,St,Mt]})],Wt),function(){(typeof ngJitMode>"u"||ngJitMode)&&p.\u0275\u0275setNgModuleScope(Wt,{imports:[Ks.CommonModule,x.ReactiveFormsModule,ke,A.CrtLibTranslateModule,E.BusinessRulesModule,qa.ExpressionEngineModule]})}();const Xs=new p.InjectionToken("CRT_DESIGN_TIME_METADATA_POSTPROCESSOR");class it{constructor(e){this._postprocessors=e??[]}onMetaDataChanged(e){var t=this;return(0,y.A)(function*(){let a=(0,b.cloneDeep)(e);for(const r of t._postprocessors)"crtOnMetaDataChanged"in r&&(a=yield r.crtOnMetaDataChanged(a));return a})()}static{this.\u0275fac=function(t){return new(t||it)(p.\u0275\u0275inject(Xs,8))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:it,factory:it.\u0275fac,providedIn:"root"})}}class ei{constructor(e,t){this._injector=e,this._preprocessors=t,this._featureValues=this._injector.get(m.FEATURE_VALUES),this._measurePerformanceService=this._injector.get(m.MeasurePerformanceService)}onMetaDataInit(e){var t=this;return(0,y.A)(function*(){return t._measurePerformanceService.measureCallback(`MetadataPreprocessorsRunner.OnMetadataInit.${e?.name}`,(0,y.A)(function*(){let a=t._featureValues?.DisableCloneDeepMetaData?e:(0,b.cloneDeep)(e);for(const r of t._preprocessors)"crtOnMetaDataInit"in r&&(a=yield r.crtOnMetaDataInit(a));return a}))})()}onModelInit(e,t){var a=this;return(0,y.A)(function*(){return a._measurePerformanceService.measureCallback(`MetadataPreprocessorsRunner.onModelInit.${e?.name}`,(0,y.A)(function*(){for(const r of a._preprocessors)"crtOnModelInit"in r&&(e=yield r.crtOnModelInit(e,t));return e}))})()}onViewModelInit(e,t,a){var r=this;return(0,y.A)(function*(){return r._measurePerformanceService.measureCallback(`MetadataPreprocessorsRunner.onViewModelInit.${e?.name}`,(0,y.A)(function*(){for(const s of r._preprocessors)"crtOnViewModelInit"in s&&(e=yield s.crtOnViewModelInit(e,t,a));return e}))})()}getIsPreventCaching(){var e=this;return(0,y.A)(function*(){for(const t of e._preprocessors)if("crtGetIsPreventCaching"in t&&(yield t.crtGetIsPreventCaching()))return Promise.resolve(!0);return Promise.resolve(!1)})()}}class nt{constructor(e){this._injector=e}createRunner(e){return new ei(this._injector,e)}static{this.\u0275fac=function(t){return new(t||nt)(p.\u0275\u0275inject(p.Injector))}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:nt,factory:nt.\u0275fac,providedIn:"root"})}}const fe="__preprocessed";class ot{addProperty(e,t,a){this._setMutation(e,t,{operationType:"added"}),e[t]=a}updateProperty({source:e,keys:t,value:a}){if(t.includes(fe))return;const r=t.pop(),s=t.length===0?e:(0,m.getPropertyByPath)(e,t);s&&(this._setMutation(s,r,{operationType:"modified",input:s[r],output:a}),s[r]=a)}removeProperty(e,t){this._setMutation(e,t,{operationType:"deleted",input:e[t]}),delete e[t]}_forEachWithMutationsInObject(e,t){e&&e[fe]&&t(e);for(const a in e){const r=e[a];typeof r=="object"&&this._forEachWithMutationsInObject(r,t)}}revert(e){const t=e;return this._forEachWithMutationsInObject(t,a=>{this._revertMutations(a)}),e}_setMutation(e,t,a){e[fe]||(e[fe]={}),e[fe][t]=a}_revertMutations(e){const t=e[fe]??{};Object.entries(t).forEach(([a,r])=>{const s=r.operationType;switch(r.operationType){case"added":delete e[a];break;case"modified":(0,b.isEqual)(e[a],r.output)&&(e[a]=r.input);break;case"deleted":e[a]=r.input;break;default:throw new Error(`mutation with type: ${s} not supported`)}}),delete e[fe]}static{this.\u0275fac=function(t){return new(t||ot)}}static{this.\u0275prov=p.\u0275\u0275defineInjectable({token:ot,factory:ot.\u0275fac,providedIn:"root"})}}const $i=new p.InjectionToken("CRT_METADATA_NAVIGATION_PREPROCESSOR"),Hi=new p.InjectionToken("CRT_METADATA_LOOKUP_PREPROCESSOR")}}]);
