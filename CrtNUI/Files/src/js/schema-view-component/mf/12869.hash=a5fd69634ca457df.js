(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[12869],{12869:(te,V,m)=>{m.r(V),m.d(V,{AcceptChatHandler:()=>j,AcceptChatRequest:()=>k,BaseLoadInProgressChatsConverter:()=>f,CrtContactCenterModule:()=>S,CrtIncomingItemListPreprocessor:()=>v,LoadInProgressChatsConverter:()=>y,LoadNotAcceptedChatsConverter:()=>O,MergeIncomingItemsConverter:()=>M,SubscribeToChatUpdateHandler:()=>w,SubscribeToChatUpdateRequest:()=>N,SubscribeToCtiEventsHandler:()=>x,SubscribeToCtiEventsRequest:()=>L,ViewModelCollectionToIncomingItemsArray:()=>T});var o=m(5960),g=m(40297),a=m(38495),P=m(96590),r=m(20822),b=m(21018);const $={"hr-HR":{},"hu-HU":{},"zh-CN":{},"sq-AL":{},"en-GB":{},"bg-BG":{},"zh-TW":{},"no-NO":{},"ko-KR":{},"ja-JP":{},"fr-CA":{},zh:{},"vi-VN":{},"tr-TR":{},"th-TH":{},"sv-SE":{},"ro-RO":{},"pt-PT":{},"pt-BR":{},"pl-PL":{},no:{},"nl-NL":{},"lv-LV":{},"kk-KZ":{},"it-IT":{},"id-ID":{},"he-IL":{},"fr-FR":{},"fa-IR":{},"es-ES":{},"de-DE":{},"cs-CZ":{},"ar-SA":{},"en-US":JSON.parse('{"IncomingItemList":{"NoDataLabel":"Nothing to show here!","NoDataDescription":"Currently there are no items in your queue","AcceptButtonLabel":"Accept"}}'),"ru-RU":JSON.parse('{"IncomingItemList":{"NoDataLabel":"\u0417\u0434\u0435\u0441\u044C \u043D\u0435\u0447\u0435\u0433\u043E \u043F\u043E\u043A\u0430\u0437\u0430\u0442\u044C!","NoDataDescription":"\u0412\u0430\u0448\u0430 \u043E\u0447\u0435\u0440\u0435\u0434\u044C \u043F\u0443\u0441\u0442\u0430","AcceptButtonLabel":"\u041F\u0440\u0438\u043D\u044F\u0442\u044C"}}'),"uk-UA":{}};var e=m(59131),H=m(47742),h=m(73308),R=m(28399),K=m(30046),q=m.n(K),U=m(79772);const G=c=>({"item-outdated":c});function J(c,t){c&1&&(e.\u0275\u0275elementStart(0,"crt-chip",12),e.\u0275\u0275text(1," Input due "),e.\u0275\u0275elementEnd())}function Z(c,t){if(c&1){const i=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",13)(1,"crt-button",14),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275listener("clicked",function(){e.\u0275\u0275restoreView(i);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onAcceptClick())}),e.\u0275\u0275elementEnd()()}c&2&&(e.\u0275\u0275advance(),e.\u0275\u0275property("caption",e.\u0275\u0275pipeBind1(2,1,"IncomingItemList.AcceptButtonLabel")))}let I=class A extends H.CrtBaseComponent{constructor(){super(...arguments),this._defaultDate=new Date,this._outdateDelay=0,this.timerType=r.TimerType.Stopwatch,this.acceptClick=new e.EventEmitter}set data(t){this._incomingItem=t,this._setOutdateTimer()}get isOutdated(){const t=this._getTimeBeforeOutdate();return!!t&&t>=this._outdateDelay}set outdateDelay(t){this._outdateDelay=t*60,this._setOutdateTimer()}get incomingItem(){return this._incomingItem}get icon(){let t=this._incomingItem?.schemaName?.toLowerCase();return r.ENTITY_SCHEMA_ICONS.includes(t)||(t="default"),`${t}-entity-icon`}get tileIconKey(){return this._incomingItem?.schemaName||"omnichat"}get ownerId(){return this._incomingItem?.contact?.value}get ownerName(){return this._incomingItem?.contact?.displayValue?.toString()}get ownerNamePlaceholder(){const t=this.ownerName;return(0,R.isEmpty)(t)?"":t[0]}get photoUrl(){const t=this._incomingItem?.contact?.primaryImageValue;return t&&t!==a.EMPTY_GUID?(0,b.getImageFullUrlById)(t):""}get createdOn(){return this._incomingItem?.createdOn!==void 0?this._incomingItem?.createdOn||this._defaultDate:this._defaultDate}get isNeedAccept(){return this._incomingItem?.accepted===!1}get isPendingDetails(){return!0}get description(){return this._incomingItem?.itemTitle}_openDefaultPage(t,i){return(0,h.A)(function*(){const n={type:"crt.UpdateRecordRequest",entityName:t,recordId:i,$context:null};yield a.HandlerChainService.instance.process(n)})()}_getTimeBeforeOutdate(){return!this._incomingItem?.createdOn||!this._outdateDelay?null:q()().diff(this._incomingItem?.createdOn,"seconds",!1)}_setOutdateTimer(){const t=this._getTimeBeforeOutdate();t===null||t>=this._outdateDelay||setTimeout(()=>{this.changeDetectorRef.detectChanges()},(this._outdateDelay-t)*1e3)}onLinkClick(t,i){var n=this;return(0,h.A)(function*(){yield n._openDefaultPage(t,i)})()}get ownerLink(){const t=this.ownerId;return t?(0,b.getEntityUrl)("Contact",t):""}onAcceptClick(){this.acceptClick.emit(this._incomingItem)}static{this.\u0275fac=(()=>{let t;return function(n){return(t||(t=e.\u0275\u0275getInheritedFactory(A)))(n||A)}})()}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:A,selectors:[["crt-incoming-item"]],inputs:{data:"data",outdateDelay:"outdateDelay"},outputs:{acceptClick:"acceptClick"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:15,vars:18,consts:[[1,"icoming-item-tile",3,"ngClass"],[1,"icoming-item-tile-header"],[1,"icoming-item-tile-icon"],[3,"tileKey","icon"],[1,"icoming-item-tile-caption",3,"title"],["class","icoming-item-tile-caption-chip","color","Orange",4,"ngIf"],[1,"icoming-item-tile-footer"],[1,"icoming-item-tile-owner"],["readonly","true","placeholderMode","abbreviation","borderRadius","large","positioning","scale-down","size","none",1,"icoming-item-tile-owner-photo",3,"value","placeholder","colorId"],["mode","'preventDefault'",1,"icoming-item-tile-owner-link",3,"clicked","href"],[1,"icoming-item-tile-date",3,"timerType","control"],["class","icoming-item-tile-actions",4,"ngIf"],["color","Orange",1,"icoming-item-tile-caption-chip"],[1,"icoming-item-tile-actions"],["size","medium","color","accent",3,"clicked","caption"]],template:function(i,n){i&1&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),e.\u0275\u0275element(3,"crt-entity-icon",3),e.\u0275\u0275pipe(4,"lowercase"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",4),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,J,2,0,"crt-chip",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",6)(9,"div",7),e.\u0275\u0275element(10,"crt-image-input",8),e.\u0275\u0275elementStart(11,"crt-link",9),e.\u0275\u0275listener("clicked",function(){return n.onLinkClick("Contact",n.ownerId)}),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(13,"crt-timer",10),e.\u0275\u0275template(14,Z,3,3,"div",11),e.\u0275\u0275elementEnd()()),i&2&&(e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(16,G,n.isOutdated)),e.\u0275\u0275advance(3),e.\u0275\u0275property("tileKey",e.\u0275\u0275pipeBind1(4,14,n.tileIconKey))("icon",n.icon),e.\u0275\u0275advance(2),e.\u0275\u0275property("title",n.description),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n.description," "),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",!1),e.\u0275\u0275advance(3),e.\u0275\u0275property("value",n.photoUrl)("placeholder",n.ownerNamePlaceholder)("colorId",n.ownerId),e.\u0275\u0275advance(),e.\u0275\u0275property("href",n.ownerLink),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n.ownerName," "),e.\u0275\u0275advance(),e.\u0275\u0275property("timerType",n.timerType)("control",n.createdOn),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.isNeedAccept))},dependencies:[g.NgClass,g.NgIf,r.CrtLinkComponent,r.CrtImageInputComponent,r.CrtChipComponent,r.CrtEntityIconComponent,r.CrtTimerComponent,r.CrtButtonComponent,U.TranslatePipe,g.LowerCasePipe],styles:["body[_ngcontent-%COMP%]{--focus-outline-outer-color: var(--crt-palette-secondary-500);--focus-outline-inner-color: white}.icoming-item-tile[_ngcontent-%COMP%]{height:96px;max-width:100%;border:1px solid var(--crt-palette-interaction-900);border-radius:8px;overflow:auto;background:var(--crt-palette-background-400);padding:5px}.icoming-item-tile.item-outdated[_ngcontent-%COMP%]{border-color:var(--crt-palette-error-500);box-shadow:1px 1px 5px var(--crt-palette-error-500)}.icoming-item-tile[_ngcontent-%COMP%]   crt-chip.icoming-item-tile-caption-chip[_ngcontent-%COMP%]{font-family:var(--crt-body-2-font-family);font-size:var(--crt-body-2-font-size);line-height:var(--crt-body-2-line-height);font-weight:var(--crt-body-2-font-weight);letter-spacing:var(--crt-body-2-letter-spacing);text-transform:var(--crt-body-2-text-transform);-webkit-font-smoothing:antialiased;margin-top:6px;max-width:67px}.icoming-item-tile[_ngcontent-%COMP%]   crt-chip.icoming-item-tile-caption-chip[_ngcontent-%COMP%]   .crt-chip-focus-overlay[_ngcontent-%COMP%]{background-color:#ffd9d0;opacity:.2}.icoming-item-tile.selected[_ngcontent-%COMP%]{background-color:var(--crt-palette-interaction-900)}.icoming-item-tile[_ngcontent-%COMP%]:hover{background-color:var(--crt-palette-interaction-700)}.icoming-item-tile[_ngcontent-%COMP%]:hover   .icoming-item-tile-actions[_ngcontent-%COMP%]{width:100px;display:inline-block}.icoming-item-tile[_ngcontent-%COMP%]:hover   .icoming-item-tile-date[_ngcontent-%COMP%]{display:none}.icoming-item-tile-header[_ngcontent-%COMP%]{display:flex}.icoming-item-tile-footer[_ngcontent-%COMP%]{display:flex;margin:12px 8px 0;align-items:center;height:24px}.icoming-item-tile-caption[_ngcontent-%COMP%]{font-family:var(--crt-body-1-font-family);font-size:var(--crt-body-1-font-size);line-height:var(--crt-body-1-line-height);font-weight:var(--crt-body-1-font-weight);letter-spacing:var(--crt-body-1-letter-spacing);text-transform:var(--crt-body-1-text-transform);-webkit-font-smoothing:antialiased;width:calc(100% - 32px);overflow:hidden;height:2.8em;margin-top:6px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;text-overflow:ellipsis;cursor:pointer}.icoming-item-tile-owner[_ngcontent-%COMP%]{font-family:var(--crt-caption-font-family);font-size:var(--crt-caption-font-size);line-height:var(--crt-caption-line-height);font-weight:var(--crt-caption-font-weight);letter-spacing:var(--crt-caption-letter-spacing);text-transform:var(--crt-caption-text-transform);-webkit-font-smoothing:antialiased;width:100%;display:inline-flex;overflow:hidden;margin-inline-end:3em}.icoming-item-tile-owner-photo[_ngcontent-%COMP%]{width:16px;display:flex;height:16px;margin-inline-end:8px}.icoming-item-tile-owner-photo[_ngcontent-%COMP%]   .placeholder-abbreviation.no-photo[_ngcontent-%COMP%]{min-width:unset;min-height:unset;line-height:16px;height:16px;width:16px;font-size:8px}.icoming-item-tile-owner-photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:unset}.icoming-item-tile-owner-link[_ngcontent-%COMP%]{max-width:calc(100% - 24px)}.icoming-item-tile-actions[_ngcontent-%COMP%]{display:none}"]})}};I=(0,o.__decorate)([(0,a.CrtViewElement)({type:"crt.IncomingItem",reuseStrategy:a.ViewElementReuseStrategy.Reuse})],I);function W(c,t){c&1&&(e.\u0275\u0275elementStart(0,"div",3),e.\u0275\u0275element(1,"crt-label",4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"crt-label",5),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()),c&2&&(e.\u0275\u0275advance(),e.\u0275\u0275property("caption",e.\u0275\u0275pipeBind1(2,2,"IncomingItemList.NoDataLabel")),e.\u0275\u0275advance(2),e.\u0275\u0275property("caption",e.\u0275\u0275pipeBind1(4,4,"IncomingItemList.NoDataDescription")))}function Y(c,t){if(c&1){const i=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"div",7)(2,"crt-incoming-item",8),e.\u0275\u0275listener("click",function(){const s=e.\u0275\u0275restoreView(i).$implicit,l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.onItemClick(s))})("acceptClick",function(s){e.\u0275\u0275restoreView(i);const l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.onItemAccept(s))}),e.\u0275\u0275elementEnd()()()}if(c&2){const i=t.$implicit,n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("data",i)("outdateDelay",n.outdateDelay)}}function Q(c,t){if(c&1&&e.\u0275\u0275template(0,Y,3,2,"div",6),c&2){const i=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngForOf",i.items)}}let u=class E extends H.CrtBaseComponent{constructor(){super(...arguments),this.tileClick=new e.EventEmitter,this.itemAccept=new e.EventEmitter,this.outdateDelay=0}set items(t){this._items=t}get items(){return this._items}onItemClick(t){this.tileClick.emit(t)}onItemAccept(t){this.itemAccept.emit(t)}static{this.\u0275fac=(()=>{let t;return function(n){return(t||(t=e.\u0275\u0275getInheritedFactory(E)))(n||E)}})()}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:E,selectors:[["crt-incoming-item-list"]],inputs:{outdateDelay:"outdateDelay",items:"items"},outputs:{tileClick:"tileClick",itemAccept:"itemAccept"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:4,vars:2,consts:[["incoming_items",""],[1,"incoming-item-list"],["class","incoming-item-list-no-data",4,"ngIf","ngIfElse"],[1,"incoming-item-list-no-data"],[1,"incoming-item-list-no-data-label",3,"caption"],[1,"incoming-item-list-no-data-description",3,"caption"],[4,"ngFor","ngForOf"],[1,"incoming-item-wrapper"],[3,"click","acceptClick","data","outdateDelay"]],template:function(i,n){if(i&1&&(e.\u0275\u0275elementStart(0,"div",1),e.\u0275\u0275template(1,W,5,6,"div",2)(2,Q,1,1,"ng-template",null,0,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),i&2){const s=e.\u0275\u0275reference(3);e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",(n.items==null?null:n.items.length)===0)("ngIfElse",s)}},dependencies:[g.NgForOf,g.NgIf,r.CrtLabelComponent,I,U.TranslatePipe],styles:[".incoming-item-list[_ngcontent-%COMP%]{width:100%}.incoming-item-list[_ngcontent-%COMP%]   .incoming-item-wrapper[_ngcontent-%COMP%]{padding:5px}.incoming-item-list-no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;height:100%}.incoming-item-list-no-data-label[_ngcontent-%COMP%]{margin-top:35px}.incoming-item-list-no-data-description[_ngcontent-%COMP%]{margin-top:16px}"]})}};(0,o.__decorate)([(0,a.CrtOutput)(),(0,o.__metadata)("design:type",Object)],u.prototype,"tileClick",void 0),(0,o.__decorate)([(0,a.CrtOutput)(),(0,o.__metadata)("design:type",Object)],u.prototype,"itemAccept",void 0),(0,o.__decorate)([(0,a.CrtInput)(),(0,o.__metadata)("design:type",Object)],u.prototype,"outdateDelay",void 0),(0,o.__decorate)([(0,a.CrtInput)({reuseStrategy:{resetValue:!0}}),(0,o.__metadata)("design:type",Array),(0,o.__metadata)("design:paramtypes",[Array])],u.prototype,"items",null),u=(0,o.__decorate)([(0,a.CrtViewElement)({type:"crt.IncomingItems",reuseStrategy:a.ViewElementReuseStrategy.Reuse})],u);var F=m(10710),p=m(62278);let f=class{constructor(t){this._omnichannelChatService=t,this._chatSchemaName="OmniChat"}getChats(t){return(0,p.lastValueFrom)(this._omnichannelChatService.getOperatorChats().pipe((0,p.filter)(i=>i.success),(0,p.map)(i=>i.result),(0,p.map)(i=>i.filter(n=>t?n.operator.value:!n.operator.value).map(n=>({schemaName:this._chatSchemaName,id:n.id,contact:n.contact?{value:n.contact.id,displayValue:n.contact.name,primaryImageValue:n.contact.photoId}:null,accepted:t,itemTitle:n.chatPreview,createdOn:n.lastMessageTime,additionalParams:{chatQueueId:n.chatQueueId,status:n.status,channel:n.channel,lastMessageTime:n.lastMessageTime,unprocessedMsgCount:n.unprocessedMsgCount,operator:n.operator,closeDate:n.closeDate,completionDate:n.completionDate,lastMessageDirection:n.lastMessageDirection,channelId:n.channelId}})))))}};f=(0,o.__decorate)([(0,a.CrtConverter)(),(0,o.__metadata)("design:paramtypes",[F.OmnichannelChatService])],f);let y=class extends f{convert(){return this.getChats(!0)}};y=(0,o.__decorate)([(0,a.CrtConverter)({type:"crt.LoadInProgressChats"})],y);let O=class extends f{convert(){return this.getChats(!1)}};O=(0,o.__decorate)([(0,a.CrtConverter)({type:"crt.LoadNotAcceptedChats"})],O);let M=class{convert(t){return t.flat().filter(i=>!!i)}};M=(0,o.__decorate)([(0,a.CrtConverter)({type:"crt.MergeIncomingItems"})],M);let T=class{convert(t,i,n){return(0,h.A)(function*(){return!t||t.length===0||!n?[]:yield Promise.all(t.map(function(){var l=(0,h.A)(function*(d){return{schemaName:(yield d.getPrimaryDataSchema()).name,id:yield d[n.id],itemTitle:yield d[n.itemTitle],createdOn:yield d[n.createdOn],contact:yield d[n.contact],accepted:!0}});return function(d){return l.apply(this,arguments)}}()))})()}};T=(0,o.__decorate)([(0,a.CrtConverter)({type:"crt.ViewModelCollectionToIncomingItemsArray"})],T);const X="OmniChat";let k=class extends a.BaseRequest{};k=(0,o.__decorate)([(0,a.CrtRequest)({type:"crt.AcceptChatRequest"})],k);let j=class extends a.BaseRequestHandler{constructor(t,i){super(),this._omnichannelChatService=t,this._maskService=i}handle(t){var i=this;return(0,h.A)(function*(){if(t.incomingItem){const n=t.incomingItem.schemaName,s=t.incomingItem.id;if(n===X){const l=`ACCEPT_CHAT_${s}`;yield i._maskService.showMask(l,t.$context),yield(0,p.lastValueFrom)(i._omnichannelChatService.acceptChat(s)),yield i._maskService.hideMask(l,t.$context)}}yield i.next?.handle(t)})()}};j=(0,o.__decorate)([(0,a.CrtRequestHandler)({requestType:"crt.AcceptChatRequest",type:"crt.AcceptChatHandler"}),(0,o.__param)(1,(0,a.CrtInject)(b.DEVKIT_MASK_SERVICE)),(0,o.__metadata)("design:paramtypes",[F.OmnichannelChatService,a.MaskService])],j);var z=m(10850);let N=class extends a.BaseRequest{};N=(0,o.__decorate)([(0,a.CrtRequest)({type:"crt.SubscribeToChatUpdateRequest"})],N);let w=class extends a.BaseRequestHandler{constructor(t){super(),this._messageChannelService=t}_subscribeViewModelEvents(t){const i=t.$context;let n=null;const s=new p.Subscription;s.add(i.events$.pipe((0,p.filter)(({type:l})=>l===z.ViewModelEventType.FinishLoadModelAttributes)).subscribe({next:l=>{n=this._messageChannelService.messageEvent$.pipe((0,p.filter)(d=>["AcceptChat","NewIncomingChat","NewTransferredChat","CompleteChat"].includes(d?.header?.sender))).subscribe(()=>{this.handlerChain.process({type:"crt.ReloadChats",$context:i,scopes:t.scopes}).then()})},complete:()=>{n.unsubscribe(),s.unsubscribe()}}))}handle(t){var i=this;return(0,h.A)(function*(){yield i.next?.handle(t),i._subscribeViewModelEvents(t)})()}};w=(0,o.__decorate)([(0,a.CrtRequestHandler)({requestType:"crt.SubscribeToChatUpdateRequest",type:"crt.SubscribeToChatUpdateHandler"}),(0,o.__metadata)("design:paramtypes",[b.MessageChannelService])],w);let L=class extends a.BaseRequest{};L=(0,o.__decorate)([(0,a.CrtRequest)({type:"crt.SubscribeToCtiEventsRequest"})],L);let x=class extends a.BaseRequestHandler{constructor(t){super(),this._customEventService=t}_subscribeViewModelEvents(t){const i=t.$context;let n=null;const s=new p.Subscription;s.add(i.events$.pipe((0,p.filter)(({type:l})=>l===z.ViewModelEventType.FinishLoadModelAttributes)).subscribe({next:l=>{n=this._customEventService.subscribe("CtiModelEvents").subscribe(d=>{const ee=d[0],_=d[1];i[t.callsAttributeName].then(C=>{switch(ee){case"callSaved":_.databaseUId&&_.state&&!C.find(D=>D.id===_.databaseUId)&&(C=[...C,{schemaName:"Call",id:_.databaseUId,accepted:!0,itemTitle:_.callerId??_.calledId,createdOn:new Date,contact:null,additionalParams:{ctiPanelCallId:_.id}}],i[t.callsAttributeName]=C);break;case"callFinished":C=C.filter(D=>D.id!==_.databaseUId),i[t.callsAttributeName]=C;break}})})},complete:()=>{n.unsubscribe(),s.unsubscribe()}}))}handle(t){var i=this;return(0,h.A)(function*(){yield i.next?.handle(t),i._subscribeViewModelEvents(t)})()}};x=(0,o.__decorate)([(0,a.CrtRequestHandler)({requestType:"crt.SubscribeToCtiEventsRequest",type:"crt.SubscribeToCtiEventsHandler"}),(0,o.__metadata)("design:paramtypes",[P.CustomEventService])],x);class v{_getViewConfigs(t){return b.MetadataSchemaUtils.getViewConfigInfoByProperty("type","crt.IncomingItems",t.viewConfig).map(i=>i?.viewConfig).filter(Boolean)}_createItemsAttribute(t,i){if(!(0,R.isEmpty)(t.items)||!t.dataAttributes||(0,R.isEmpty)(t.dataAttributes))return;const n=`IncomingItems_${t.name}`,s=i.viewModelConfig.attributes;s[n]={from:t.dataAttributes,converter:"crt.MergeIncomingItems"},t.items=`$${n}`}crtOnMetaDataInit(t){const i=t,n=this._getViewConfigs(i);for(const s of n)this._createItemsAttribute(s,i);return Promise.resolve(t)}static{this.\u0275fac=function(i){return new(i||v)}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac})}}let S=class B{static{this.\u0275fac=function(i){return new(i||B)}}static{this.\u0275mod=e.\u0275\u0275defineNgModule({type:B})}static{this.\u0275inj=e.\u0275\u0275defineInjector({providers:[{provide:b.CRT_METADATA_PREPROCESSOR,useClass:v,multi:!0}],imports:[P.CrtLibTranslateModule.forRoot({i18n:$}),g.CommonModule,r.CrtLinkModule,r.CrtImageInputModule,r.CrtChipModule,r.CrtEntityIconModule,r.CrtTimerModule,r.CrtLabelModule,r.CrtButtonModule]})}};S=(0,o.__decorate)([(0,a.CrtModule)({viewElements:[u,I],converters:[y,O,M,T],requestHandlers:[j,w,x]})],S),function(){(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(S,{declarations:[u,I],imports:[P.CrtLibTranslateModule,g.CommonModule,r.CrtLinkModule,r.CrtImageInputModule,r.CrtChipModule,r.CrtEntityIconModule,r.CrtTimerModule,r.CrtLabelModule,r.CrtButtonModule],exports:[u]})}()}}]);
