(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[36946,73308,50927,28546,6165,62832,40451,18070,95689,94260,71879,41421,63802,86183,8564,30945,53326,75707,98088,20469,42850,70422,48041,15184,92803,80898,58517,25660,3279,91374,68993,83231,5612,38469,60850,14565],{14565:(k,p,o)=>{o.r(p),o.d(p,{ACTIVE_COMMUNICATIONS_ATTRIBUTE_NAME:()=>x,CALL_INDICATOR_IMAGE:()=>q,CHATS_TAB_NAME:()=>te,COMMUNICATIONS_PANEL_HAS_NEW_MESSAGES_ATTRIBUTE_NAME:()=>j,COMMUNICATIONS_PANEL_ITEMS_ATTRIBUTE_NAME:()=>w,COMMUNICATIONS_PANEL_MODEL_ATTRIBUTE_NAME:()=>F,COMMUNICATION_PANEL_NAME:()=>g,COMMUNICATION_PANEL_SELECTED_ITEM_ATTRIBUTE_NAME:()=>$,CONSULTATION_INDICATOR_IMAGE:()=>ee,CONSULTATION_TAB_NAME:()=>z,CTI_TAB_NAME:()=>W,CURRENT_CALL_CHANGED_ATTRIBUTE_NAME:()=>J,CURRENT_CALL_CHANGED_LISTENER_ATTRIBUTE_NAME:()=>Y,CURRENT_COMMUNICATIONS_INFO_ATTRIBUTE_NAME:()=>V,CURRENT_CONSULTATION_CHANGED_ATTRIBUTE_NAME:()=>Z,CURRENT_CONSULTATION_CHANGED_LISTENER_ATTRIBUTE_NAME:()=>X,DISABLE_RIGHT_PANEL_PREPROCESSING_FEATURE_NAME:()=>ie,LEGACY_SIDE_PANEL_ITEMS:()=>se,LEGACY_SIDE_PANEL_NAME:()=>oe,LEGACY_SIDE_PANEL_SELECTED_ITEM:()=>re,NOTIFICATIONS_PANEL_HAS_NEW_NOTIFICATIONS_ATTRIBUTE_NAME:()=>y,NOTIFICATIONS_PANEL_ITEMS_ATTRIBUTE_NAME:()=>m,NOTIFICATIONS_PANEL_MODEL_ATTRIBUTE_NAME:()=>H,NOTIFICATIONS_PANEL_NAME:()=>T,NOTIFICATIONS_PANEL_SELECTED_ITEM_ATTRIBUTE_NAME:()=>S,PREDEFINED_SIDEBARS:()=>Te,REFRESH_ACTIVE_COMMUNICATIONS_INFO_ATTRIBUTE_NAME:()=>Q,REFRESH_ACTIVE_COMMUNICATIONS_INFO_LISTENER_ATTRIBUTE_NAME:()=>K,RIGHT_PANEL_CONTACT_CHAT_ATTRIBUTE_NAME:()=>I,RIGHT_PANEL_CONTACT_CHAT_SUBSCRIPTION_ATTRIBUTE_NAME:()=>A,RIGHT_PANEL_LISTENER_SUBSCRIPTION_ATTRIBUTE_NAME:()=>u,RIGHT_PANEL_RESET_COUNTER_EVENT_NAME:()=>N,RIGHT_PANEL_RESET_COUNTER_LISTENER_ATTRIBUTE_NAME:()=>M,RIGHT_PANEL_SELECTED_TAB_ATTRIBUTE_NAME:()=>O,RIGHT_PANEL_SELECTED_TAB_SUBSCRIPTION_ATTRIBUTE_NAME:()=>C,RIGHT_PANEL_SET_SELECTED_TAB_EVENT_NAME:()=>L,RIGHT_PANEL_TAB_IS_INITIALIZED_ATTRIBUTE_NAME:()=>c,SIDEBAR_EXTENSIONS_FEATURE_NAME:()=>ne,SIDEBAR_OPENED_STATE_ATTRIBUTE_NAME:()=>de,SIDEBAR_OPENED_STATE_SUBSCRIPTION_ATTRIBUTE_NAME:()=>_e,SIDE_PANEL_CONTAINER_NAME:()=>ae,SidebarApiModule:()=>h,SidebarService:()=>l,SidebarStateService:()=>R,SidebarsConfigProvider:()=>f,findLeafSidebarInfo:()=>P,findNestedSidebarInGroup:()=>G,findRootSidebar:()=>v});const O="RightPanelSelectedTab",L="RightPanelSetSelectedTabEvent",C="RightPanelSelectedTabSubscription",u="RightPanelListenerSubscription",M="RightPanelResetCounterListener",N="RightPanelResetCounter",A="RightPanelContactChatSubscription",I="RightPanelContactChat",c="RightPanelTabIsInitialized",T="NotificationsPanel",S="NotificationsPanelItemsTabPanel_SelectedItem",m="NotificationsPanelItemsTabPanel_Items",H="NotificationsPanelModel",y="NotificationsPanelHasNewNotifications",g="CommunicationPanel",$="CommunicationsPanelItemsTabPanel_SelectedItem",F="CommunicationsPanelModel",w="CommunicationsPanelItemsTabPanel_Items",j="CommunicationsPanelHasNewMessages",V="CurrentCommunicationsInfo",x="ActiveCommunicationsInfo",W="CtiTab",Y="CurrentCallChangedListener",J="CurrentCallChanged",z="OBSWTab",X="CurrentConsultationChangedListener",Z="CurrentConsultationChanged",K="RefreshActiveCommunicationsInfoListener",Q="RefreshActiveCommunicationsInfo",q="right-panel-call-timer",ee="right-panel-consultation-timer",te="ChatsTab",ie="DisableRightPanelsPreprocessing",ne="SidebarExtensions",ae="SidebarContainerWrapper",oe="LegacySidePanel",se="LegacySidePanelItemsTabPanel_Items",re="LegacySidePanelItemsTabPanel_SelectedItem",de="SidebarOpenedState",_e="SidebarOpenedState_Subscription",Te=["FeedsTab","CtiTab","EmailsTab","ChatsTab","OBSWTab","ReminderTab","EsnNotificationsTab","VisaNotificationsTab","AnniversaryNotificationsTab","SystemNotificationsTab","BusinessProcessTab"];var B=o(40297),D=o(96590);const Se={"en-US":JSON.parse('{"Sidebar":{"PredefinedSidebarGroups":{"CommunicationPanel":"Communication panel","NotificationsPanel":"Notifications panel"}}}'),"ru-RU":JSON.parse('{"Sidebar":{"PredefinedSidebarGroups":{"CommunicationPanel":"\u041A\u043E\u043C\u043C\u0443\u043D\u0438\u043A\u0430\u0446\u0438\u043E\u043D\u043D\u0430\u044F \u043F\u0430\u043D\u0435\u043B\u044C","NotificationsPanel":"\u041F\u0430\u043D\u0435\u043B\u044C \u0443\u0432\u0435\u0434\u043E\u043C\u043B\u0435\u043D\u0438\u0439"}}}')};var d=o(59131);class h{static{this.\u0275fac=function(t){return new(t||h)}}static{this.\u0275mod=d.\u0275\u0275defineNgModule({type:h})}static{this.\u0275inj=d.\u0275\u0275defineInjector({imports:[B.CommonModule,D.CrtLibTranslateModule.forRoot({i18n:Se})]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&d.\u0275\u0275setNgModuleScope(h,{imports:[B.CommonModule,D.CrtLibTranslateModule]})})();var Ee=o(79772),s=o(62278),ce=o(63721);class l{constructor(e){this._httpClient=e,this.serviceEndpoint="/ServiceModel/SidebarService.svc/",this.getItemsMethodName="GetItems"}getItems(){const e=`${this.serviceEndpoint}${this.getItemsMethodName}`;return this._httpClient.post(e,null)}static{this.\u0275fac=function(t){return new(t||l)(d.\u0275\u0275inject(ce.HttpClient))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:l,factory:l.\u0275fac,providedIn:"root"})}}class f{constructor(e,t){this._sidebarService=e,this._translateService=t,this._additionalProperties={CtiTab:{containerClasses:["ts-cti-container"]},ChatsTab:{containerId:"OmniChatModule_WrapContainer"},FeedsTab:{containerClasses:["ts-feed-container"]}}}_translateInstant(e){return this._translateService.instant(`Sidebar.${e}`)}_createLeafSidebarDefinitionBase(e){return{code:e.code,title:e.title,icon:e.icon,schemaName:e.schemaName,index:e.index,autoHideNotificationMark:e.autoHideNotificationMark}}_createNestedSidebarDefinition(e){return{...this._createLeafSidebarDefinitionBase(e),...this._additionalProperties[e.code]}}_createStandaloneSidebarDefinition(e){return{...this._createLeafSidebarDefinitionBase(e),type:"standalone"}}_sortSidebarsByIndexAndCode(e,t){return e.index-t.index||e.code.localeCompare(t.code)}_fillCustomSidebarToSidebarGroupDefinition(e,t){const n=e.filter(i=>i.groupCode===t.code).map(i=>this._createNestedSidebarDefinition(i));return t.nestedSidebars=[...t.nestedSidebars,...n].sort((i,a)=>this._sortSidebarsByIndexAndCode(i,a)),t}_mapResponseItemsToDefinitions(e){const t=e.filter(n=>n.groupCode===null).map(n=>this._createStandaloneSidebarDefinition(n));return[this._fillCustomSidebarToSidebarGroupDefinition(e,{type:"group",code:g,outerContainerClasses:["communication-panel-item-container"],nestedSidebarsContainerClasses:["communications-panel-items-tab-panel"],nestedSidebars:[],title:this._translateInstant("PredefinedSidebarGroups.CommunicationPanel"),icon:"tools-icon",index:9e3}),this._fillCustomSidebarToSidebarGroupDefinition(e,{type:"group",code:T,outerContainerClasses:["ts-notifications-container","communication-panel-item-container"],nestedSidebarsContainerClasses:["notifications-panel-items-tab-panel"],nestedSidebars:[],title:this._translateInstant("PredefinedSidebarGroups.NotificationsPanel"),icon:"notifications-icon",index:1e4}),...t]}getSidebarsConfig(){return this._cachedSidebarsConfig$=this._cachedSidebarsConfig$??this._sidebarService.getItems().pipe((0,s.catchError)(()=>(0,s.of)({success:!1,items:[]})),(0,s.map)(e=>({rootSidebars:this._mapResponseItemsToDefinitions(e.items).filter(a=>a.type==="standalone"||a.type==="group"&&a.nestedSidebars.length).sort((a,r)=>this._sortSidebarsByIndexAndCode(a,r))})),(0,s.shareReplay)({bufferSize:1,refCount:!1})),this._cachedSidebarsConfig$}static{this.\u0275fac=function(t){return new(t||f)(d.\u0275\u0275inject(l),d.\u0275\u0275inject(Ee.TranslateService))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:f,factory:f.\u0275fac,providedIn:"root"})}}var _=o(73308);function v(b,e){return e.rootSidebars.find(t=>t.code===b)}function G(b,e){return e.nestedSidebars.find(t=>t.code===b)}function P(b,e){const t=e.rootSidebars.find(i=>i.code?.toLowerCase()===b.toLowerCase()&&i.type!=="group");if(t)return{leafSidebar:t,group:null};const n=e.rootSidebars.filter(i=>i.type==="group").flatMap(i=>i.nestedSidebars.map(a=>({group:i,nestedSidebar:a}))).find(i=>i.nestedSidebar.code?.toLowerCase()===b.toLowerCase());return n?{leafSidebar:n.nestedSidebar,group:n.group}:void 0}class R{constructor(e){this._sidebarsConfigProvider=e,this._notificationMarks={rootSidebars$:new s.BehaviorSubject({}),nestedSidebars$:new s.BehaviorSubject({}),nestedSidebarsSnapshot:{}},this._opened={rootSidebar$:new s.BehaviorSubject(null),nestedSidebars$:new s.BehaviorSubject({}),leafSidebar$:new s.BehaviorSubject(null),snapshot$:new s.BehaviorSubject({leafSidebar:null,nestedSidebars:{}})},this.notificationMarks={rootSidebars$:this._notificationMarks.rootSidebars$.asObservable(),nestedSidebars$:this._notificationMarks.nestedSidebars$.asObservable()},this.opened={rootSidebar$:this._opened.rootSidebar$.asObservable(),nestedSidebars$:this._opened.nestedSidebars$.asObservable(),leafSidebar$:this._opened.leafSidebar$.asObservable(),snapshot$:this._opened.snapshot$.asObservable()}}_getSidebarsConfig(){return(0,s.firstValueFrom)(this._sidebarsConfigProvider.getSidebarsConfig())}_updateNestedNotificationMarksSnapshot(e,t,n){const i=e.code,a=t.code;let r=this._notificationMarks.nestedSidebarsSnapshot[a];r||(r={},this._notificationMarks.nestedSidebarsSnapshot[a]=r),r[i]=n}_shouldSkipNotificationMark(e,t){const{markState:n,leafSidebarInfo:i}=e;return i.leafSidebar.code===t&&i.leafSidebar.autoHideNotificationMark&&n.visible}_autoHideNotificationMark(e){var t=this;return(0,_.A)(function*(){e.autoHideNotificationMark&&(yield t.setLeafNotificationMarks({[e.code]:{visible:!1}}))})()}_isNotificationMarkStateChanged(e,t){return(e?.visible??!1)!==t.visible}_emitNestedSidebarsNotificationMarks(e){const t=this._notificationMarks.nestedSidebars$.getValue();let n=!1;for(const i of e){const a=i.leafSidebarInfo.leafSidebar;this._updateNestedNotificationMarksSnapshot(a,i.leafSidebarInfo.group,i.markState),n||=this._isNotificationMarkStateChanged(t[a.code],i.markState),t[a.code]=i.markState}n&&this._notificationMarks.nestedSidebars$.next(t)}_setSidebarGroupsNotificationMarks(e){let t=!1;for(const[n,i]of Object.entries(this._notificationMarks.nestedSidebarsSnapshot)){const r={visible:Object.values(i).some(U=>U.visible)};t||=this._isNotificationMarkStateChanged(e[n],r),e[n]=r}return t}_setStandaloneSidebarsNotificationMarks(e,t){let n=!1;for(const i of e){const a=i.leafSidebarInfo.leafSidebar;n||=this._isNotificationMarkStateChanged(t[a.code],i.markState),t[a.code]=i.markState}return n}_emitRootSidebarsNotificationMarks(e){const t=this._notificationMarks.rootSidebars$.getValue(),n=this._setSidebarGroupsNotificationMarks(t),i=this._setStandaloneSidebarsNotificationMarks(e,t);(n||i)&&this._notificationMarks.rootSidebars$.next(t)}_emitIfChanged(e,t){return e.getValue()===t?!1:(e.next(t),!0)}_getLeafSidebarOpenedState(e){return e.nestedSidebar??e.rootSidebar}_emitOpenedSidebar(e){this._emitIfChanged(this._opened.rootSidebar$,e.rootSidebar);const t=this._getLeafSidebarOpenedState(e);if(this._opened.leafSidebar$.next(t),e.nestedSidebar){const n=this._opened.nestedSidebars$.getValue(),i=e.rootSidebar;n[i]!==e.nestedSidebar&&this._opened.nestedSidebars$.next({...n,[i]:e.nestedSidebar})}this._opened.snapshot$.next({leafSidebar:t,nestedSidebars:this._opened.nestedSidebars$.getValue()})}_openSidebarInGroup(e,t){var n=this;return(0,_.A)(function*(){n._emitOpenedSidebar({rootSidebar:e.code,nestedSidebar:t.code}),yield n._autoHideNotificationMark(t)})()}_openSidebarGroup(e){var t=this;return(0,_.A)(function*(){const n=e.code,i=t._opened.nestedSidebars$.getValue()[n];let a;if(i&&(a=G(i,e),a||console.warn(`It is not possible to open nested sidebar with code "${i}" because it does not belong to the specified group with code "${n}"`)),a||(a=e.nestedSidebars[0]),!a){console.warn(`It is not possible to open sidebar group with code "${n}" because it does not contain any nested sidebars`);return}yield t._openSidebarInGroup(e,a)})()}_openStandaloneSidebar(e){var t=this;return(0,_.A)(function*(){t._emitOpenedSidebar({rootSidebar:e.code,nestedSidebar:null}),yield t._autoHideNotificationMark(e)})()}_openLeafSidebarInternal(e){var t=this;return(0,_.A)(function*(){if(t._opened.leafSidebar$.getValue()===e)return!1;const n=yield t._getSidebarsConfig(),i=P(e,n);return i?(i.group?yield t._openSidebarInGroup(i.group,i.leafSidebar):yield t._openStandaloneSidebar(i.leafSidebar),!0):(console.warn(`Leaf sidebar with code "${e}" does not exist and can not be opened`),!1)})()}setLeafNotificationMarks(e){var t=this;return(0,_.A)(function*(){const n=yield t._getSidebarsConfig(),i=t._opened.leafSidebar$.getValue(),a=Object.entries(e).map(([E,Ne])=>({markState:Ne,leafSidebarInfo:P(E,n)})).filter(E=>E.leafSidebarInfo&&!t._shouldSkipNotificationMark(E,i)),r=a.filter(E=>E.leafSidebarInfo.group!==null),U=a.filter(E=>E.leafSidebarInfo.group===null);t._emitNestedSidebarsNotificationMarks(r),t._emitRootSidebarsNotificationMarks(U)})()}openLeafSidebar(e){var t=this;return(0,_.A)(function*(){yield t._openLeafSidebarInternal(e)})()}openRootSidebar(e){var t=this;return(0,_.A)(function*(){if(t._opened.rootSidebar$.getValue()===e)return;const n=yield t._getSidebarsConfig(),i=v(e,n);if(!i){console.warn(`Root sidebar with code "${e}" does not exist and can not be opened`);return}i.type==="group"?yield t._openSidebarGroup(i):yield t._openStandaloneSidebar(i)})()}loadOpenedSidebarSnapshot(e){var t=this;return(0,_.A)(function*(){t._opened.nestedSidebars$.next(e.nestedSidebars);const n=e.leafSidebar;n&&(yield t._openLeafSidebarInternal(n))||t._opened.snapshot$.next(e)})()}closeSidebar(){this._emitOpenedSidebar({rootSidebar:null,nestedSidebar:null})}static{this.\u0275fac=function(t){return new(t||R)(d.\u0275\u0275inject(f))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac,providedIn:"root"})}}},73308:(k,p,o)=>{o.d(p,{A:()=>L});function O(C,u,M,N,A,I,c){try{var T=C[I](c),S=T.value}catch(m){M(m);return}T.done?u(S):Promise.resolve(S).then(N,A)}function L(C){return function(){var u=this,M=arguments;return new Promise(function(N,A){var I=C.apply(u,M);function c(S){O(I,N,A,c,T,"next",S)}function T(S){O(I,N,A,c,T,"throw",S)}c(void 0)})}}}}]);
